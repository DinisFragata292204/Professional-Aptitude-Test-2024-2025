(()=>{"use strict";var e={698:(e,t,a)=>{e.exports=a.p+"static/media/school.936f394320309b8486a7.png"},747:(e,t,a)=>{e.exports=a.p+"static/media/bg4.8de26c65a39fe7688333.jpg"},781:(e,t,a)=>{e.exports=a.p+"static/media/refresh.a5c125336d01fec4f31f.png"},952:(e,t,a)=>{e.exports=a.p+"static/media/bg3.e8b3f1b8837436968922.jpg"},1363:(e,t,a)=>{var o=a(8483),r=(a(8203),a(4870),a(7810)),l=a(5741),n=a(2928),s=a(9681),i=a(8758),d=a(5193);const c={baseUrl:"http://172.16.12.215/reactNative-Backend"};var u=a(6690),f=a(1687),m=a(5442),g=a(4222),h=a(8038),p=a(5056),x=a(7190),y=a(3239),b=a(2501),j=a(8816),C=a(5588),v=a(5036),w=a(9237),S=a(9737),T=a(736),k=a(9794),F=a(8415),D=a(3413),B=a(1169),I=a(4922);const P=m.default.create({modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"flex-end"},modalContent:{width:"60%",height:"100%",padding:20,justifyContent:"flex-start",borderTopLeftRadius:20,borderBottomLeftRadius:20,alignSelf:"flex-end"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:15},modalOption:{paddingVertical:10},modalOptionText:{fontSize:18},separator:{height:1,backgroundColor:"#ccc",marginVertical:5},logoutButton:{marginTop:"auto",paddingVertical:15,alignItems:"center",backgroundColor:"red",borderRadius:10},logoutButtonText:{color:"white",fontSize:18,fontWeight:"bold"}}),A=({visible:e,dynamicHeaderBackground:t,dynamicTextColor:a,onClose:o,navigation:s,email:i})=>{const[d,f]=(0,r.useState)(!1),[m,g]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{try{let e=null;e=localStorage.getItem("userRole"),g(e)}catch{g(null)}})()}),[]);return(0,I.jsx)(D.default,{visible:e,animationType:"slide",transparent:!0,onRequestClose:o,children:(0,I.jsx)(b.default,{style:P.modalOverlay,activeOpacity:1,onPressOut:o,children:(0,I.jsxs)(n.default,{style:[P.modalContent,{backgroundColor:t}],children:[(0,I.jsx)(u.default,{style:[P.modalTitle,{color:a}],children:"Configura\xe7\xf5es do Utilizador"}),(0,I.jsx)(b.default,{style:P.modalOption,onPress:()=>{o(),s.navigate("PersonalDataScreen",{email:i})},disabled:d,children:(0,I.jsx)(u.default,{style:[P.modalOptionText,{color:a}],children:"Dados Pessoais"})}),(0,I.jsx)(n.default,{style:P.separator}),(0,I.jsx)(b.default,{style:P.modalOption,onPress:()=>{o(),s.navigate("PasswordSecurityScreen",{email:i})},disabled:d,children:(0,I.jsx)(u.default,{style:[P.modalOptionText,{color:a}],children:"Palavra-passe e Seguran\xe7a"})}),(0,I.jsx)(n.default,{style:P.separator}),(0,I.jsx)(b.default,{style:P.modalOption,onPress:()=>{o(),s.navigate("TemaScreen",{email:i})},disabled:d,children:(0,I.jsx)(u.default,{style:[P.modalOptionText,{color:a}],children:"Personalizar"})}),(0,I.jsx)(n.default,{style:P.separator}),"admin"===m?(0,I.jsx)(b.default,{style:P.modalOption,onPress:()=>{o(),s.navigate("suggestionsScreen",{email:i})},disabled:d,children:(0,I.jsx)(u.default,{style:[P.modalOptionText,{color:a}],children:"Sugest\xf5es"})}):(0,I.jsx)(b.default,{style:P.modalOption,onPress:()=>{o(),s.navigate("sugestAnythingScreen",{email:i})},disabled:d,children:(0,I.jsx)(u.default,{style:[P.modalOptionText,{color:a}],children:"Sugerir melhorias"})}),(0,I.jsx)(n.default,{style:P.separator}),d?(0,I.jsx)(l.default,{size:"large",color:"#47AD4D",style:{marginTop:20}}):(0,I.jsx)(b.default,{style:P.logoutButton,onPress:async()=>{f(!0);let e=null;e=localStorage.getItem("userToken");try{await B.default.post(`${c.baseUrl}/calendarioFiles/logout.php`,{token:e},{headers:{"Content-Type":"application/json"}})}catch{}try{localStorage.removeItem("userToken"),localStorage.removeItem("email"),localStorage.removeItem("userRole"),localStorage.removeItem("userTheme"),localStorage.removeItem("backgroundUrl")}catch{}f(!1),o(),s.replace("Login")},children:(0,I.jsx)(u.default,{style:P.logoutButtonText,children:"Terminar Sess\xe3o"})})]})})})};var z=a(6986);const R=m.default.create({scrollViewDisciplinas:{maxHeight:120,marginBottom:10},scrollViewTurmas:{maxHeight:100,marginVertical:5},bgImage:{flex:1,alignItems:"center",justifyContent:"flex-start"},indicadorContainer:{alignItems:"center",justifyContent:"center",marginVertical:10},darkOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.3)"},headerFixed:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:p.default.currentHeight||20,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10},botaoMenu:{flex:1},menuIcon:{width:30,height:30,marginLeft:3,marginTop:-5},plusButton:{flexDirection:"row",alignItems:"center",marginVertical:8},newDisciplinaContainer:{flexDirection:"row",alignItems:"center",marginBottom:10},newDisciplinaInput:{flex:1,marginRight:10,backgroundColor:"#fff"},newDisciplinaButton:{backgroundColor:"#47AD4D"},botaoConta:{flex:1,alignItems:"flex-end"},userIcon:{width:30,height:30,marginTop:-5},fixedBox:{marginTop:80,borderRadius:10,padding:15,maxHeight:"80%",alignSelf:"center"},scrollContainer:{paddingBottom:20},webContainer:{flexDirection:"row",justifyContent:"space-between"},mobileContainer:{paddingBottom:20},leftColumn:{flex:1,paddingRight:15},rightColumn:{flex:1,paddingLeft:15},rotulo:{fontSize:16,fontWeight:"bold",marginBottom:10},grupoRadio:{flexDirection:"row",alignItems:"center",marginBottom:5},campoInput:{marginBottom:15},botaoCriar:{marginTop:10,backgroundColor:"#47AD4D",alignSelf:"center",width:"90%"},loadingContainer:{alignItems:"center",justifyContent:"center"},loadingText:{fontSize:18,marginTop:10},grelhaTurmas:{flexDirection:"row",flexWrap:"wrap",marginTop:5},botaoTurma:{borderWidth:1,borderColor:"#ccc",borderRadius:4,padding:8,width:50,alignItems:"center",marginVertical:2,marginRight:5},botaoTurmaSelecionada:{backgroundColor:"green",borderColor:"green"},textoTurma:{},textoTurmaSelecionada:{color:"#fff"},containerTurmas:{marginVertical:10},rotuloTurmas:{fontWeight:"bold",marginBottom:4},textoTurmas:{},turmasSelecionadas:{marginTop:10,padding:10,borderWidth:1,borderColor:"#ccc",borderRadius:4,backgroundColor:"#f9f9f9"},scrollViewFixed:{maxHeight:120,marginBottom:10},toastContainer:{position:"absolute",top:10,alignSelf:"center",paddingHorizontal:20,paddingVertical:10,borderRadius:8,zIndex:20},toastText:{color:"#fff",fontSize:16},toastSuccess:{backgroundColor:"green"},toastError:{backgroundColor:"red"},webErrorOverlay:{position:"absolute",top:"1%",left:"10%",right:"10%",padding:15,backgroundColor:"red",borderRadius:8,alignItems:"center",justifyContent:"center",zIndex:20},webErrorText:{color:"#fff",fontSize:16,textAlign:"center"},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)"},sideMenu:{position:"absolute",top:10,left:0,bottom:0,width:260,paddingHorizontal:20,paddingVertical:30,shadowColor:"#000",shadowOffset:{width:3,height:0},shadowOpacity:.3,shadowRadius:4,elevation:6},menuItem:{paddingVertical:15,borderBottomWidth:1,borderBottomColor:"#ccc",marginBottom:10},menuText:{fontSize:18,fontWeight:"500"}}),E=({navigation:e,route:t})=>{const o=(0,j.useTheme)(),s=`${c.baseUrl}/adminFiles/`,i=`${c.baseUrl}/adminFiles/getDisciplinas.php`,d=`${c.baseUrl}/adminFiles/getTurmas.php`,m=`${c.baseUrl}/adminFiles/createTurma.php`,[D,B]=(0,r.useState)([]),[P,z]=(0,r.useState)([]),[E,O]=(0,r.useState)({}),[V,_]=(0,r.useState)(!1),[W,H]=(0,r.useState)(""),[$,L]=(0,r.useState)(""),[N,M]=(0,r.useState)(!1),[U,q]=(0,r.useState)(""),[G,J]=(0,r.useState)("aluno"),[Y,Z]=(0,r.useState)(!1),[Q,K]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[te,ae]=(0,r.useState)(null),[oe,re]=(0,r.useState)(o.dark?"dark":"light"),[le,ne]=(0,r.useState)(!0),[se,ie]=(0,r.useState)(""),[de,ce]=(0,r.useState)(""),[ue,fe]=(0,r.useState)(""),[me,ge]=(0,r.useState)([]),[he,pe]=(0,r.useState)(""),[xe,ye]=(0,r.useState)({}),[be,je]=(0,r.useState)(!1),[Ce,ve]=(0,r.useState)(""),[we,Se]=(0,r.useState)(!1),[Te,ke]=(0,r.useState)({visible:!1,message:"",type:""}),[Fe,De]=(0,r.useState)(!1),[Be,Ie]=(0,r.useState)(""),Pe="dark"===oe?"#101218":"#FFFFFF",Ae="dark"===oe?"#FFFFFF":"#000",ze="dark"===oe?"#3F4454":"#fff";(0,r.useEffect)((()=>{t.params?.email&&Ie(t.params.email)}),[t.params?.email]),(0,r.useEffect)((()=>{"aluno"!==G&&"professor"!==G||fetch(d).then((async e=>{const t=await e.text();return console.log("RESPUESTA BRUTA DO SERVIDOR:",t),JSON.parse(t)})).then((e=>{if(e.success){B(e.turmas);const t=Array.from(new Set(e.turmas.map((e=>e.ano)))).sort(((e,t)=>Number(e)-Number(t))).map((e=>e.toString()));z(t);const a={};e.turmas.forEach((e=>{const t=e.ano.toString();a[t]=a[t]||[],a[t].push(e)})),O(a)}else Ve(e.message,"error")})).catch((()=>Ve("N\xe3o foi poss\xedvel carregar turmas","error")))}),[G]);const Re=async()=>{if(W&&$.trim())if(D.some((e=>e.ano.toString()===W&&e.turma.toUpperCase()===$.toUpperCase())))Ve("Essa turma j\xe1 existe","error");else{M(!0);try{const e=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ano:W,turma:$})}),t=await e.json();if(t.success){Ve("Turma criada!","success");const e=t.turma;B((t=>[...t,e])),z((t=>t.includes(e.ano.toString())?t:[...t,e.ano.toString()].sort())),O((t=>{const a=e.ano.toString(),o=t[a]?[...t[a],e]:[e];return Object.assign({},t,{[a]:o})})),_(!1),H(""),L("")}else Ve(t.message||"Erro ao criar turma","error")}catch{Ve("Falha ao comunicar com o servidor","error")}finally{M(!1)}}else Ve("Preenche ano e letra da turma","error")},Ee=!W||!$.trim()||D.some((e=>e.ano.toString()===W&&e.turma.toUpperCase()===$.toUpperCase())),Oe=()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae}],children:"Ano Escolar:"}),0===P.length?(0,I.jsx)(l.default,{size:"small"}):(0,I.jsx)(C.default.Group,{onValueChange:ie,value:se,children:P.map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e,color:"#47AD4D"}),(0,I.jsxs)(u.default,{style:{color:Ae},children:[e,"\xba Ano"]})]},e)))}),""!==se&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae}],children:"Turma:"}),(0,I.jsx)(C.default.Group,{onValueChange:ce,value:de,children:(E[se]||[]).map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e.id.toString(),color:"#47AD4D"}),(0,I.jsxs)(u.default,{style:{color:Ae},children:["Turma ",e.turma]})]},e.id)))})]}),(0,I.jsxs)(b.default,{onPress:()=>_(!V),style:R.plusButton,children:[(0,I.jsx)(F.default,{name:"add-circle-outline",size:24,color:Ae}),(0,I.jsx)(u.default,{style:{color:Ae,marginLeft:5},children:"Nova Turma"})]}),(0,I.jsx)(v.default,{children:(0,I.jsxs)(w.default,{visible:V,onDismiss:()=>{_(!1),H(""),L("")},style:{marginHorizontal:20,backgroundColor:"#fff"},theme:{colors:{surface:"#fff"}},children:[(0,I.jsx)(w.default.Title,{children:"Criar Nova Turma"}),(0,I.jsxs)(w.default.Content,{children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,marginBottom:0}],children:"Selecione o Ano:"}),(0,I.jsx)(C.default.Group,{onValueChange:H,value:W,children:["10","11","12"].map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e,color:"#47AD4D"}),(0,I.jsxs)(u.default,{style:{color:Ae},children:[e,"\xba Ano"]})]},e)))}),(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,marginTop:10}],children:"Letra da Turma:"}),(0,I.jsx)(S.default,{mode:"outlined",placeholder:"Ex: A",value:$,onChangeText:e=>L(e.replace(/[^A-Za-z]/g,"").toUpperCase()),maxLength:1,style:[R.newDisciplinaInput,{backgroundColor:"#fff"}],theme:{colors:{text:Ae,primary:Ae,background:"#fff"}}})]}),(0,I.jsxs)(w.default.Actions,{children:[(0,I.jsx)(T.default,{onPress:()=>{_(!1),H(""),L("")},labelStyle:{color:"red"},children:"Cancelar"}),(0,I.jsx)(T.default,{onPress:Re,loading:N,disabled:Ee,style:{opacity:Ee?.5:1},labelStyle:{color:Ee?"#999":"#47AD4D"},children:"Salvar"})]})]})})]}),Ve=(e,t)=>{"success"!==t?(ke({visible:!0,message:e,type:t}),setTimeout((()=>ke({visible:!1,message:"",type:""})),2e3)):window.alert(e)};(0,r.useEffect)((()=>{(async()=>{try{let e=null,t=null;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),ae(e),re("dark"===t?"dark":"light")}catch(e){console.error("Erro ao carregar configura\xe7\xf5es:",e)}finally{ne(!1)}})()}),[]),(0,r.useEffect)((()=>{"professor"===G&&_e()}),[t.params?.email,G]);const _e=async()=>{const e=new AbortController,t=setTimeout((()=>e.abort()),8e3);try{const a=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json"},signal:e.signal});if(clearTimeout(t),!a.ok)throw new Error(`Erro HTTP: ${a.status}`);const o=await a.json();o.success?ge(o.disciplinas):Ve(o.message||"Erro ao carregar disciplinas.","error")}catch(a){console.error("[ERROR] Erro ao buscar disciplinas:",a),"AbortError"===a.name?Ve("Tempo de resposta excedido. Verifique sua conex\xe3o.","error"):Ve("N\xe3o foi poss\xedvel carregar as disciplinas.","error")}},We=async()=>{try{if(!U||!G)return void Ve("Pedimos que preencha todos os campos obrigat\xf3rios.","error");if("aluno"===G&&(!se||!de))return void Ve("Para poder criar um aluno pedimos que preencha o ano e turma do aluno.","error");if("professor"===G&&(!ue||!he||0===Object.keys(xe).length))return void Ve("Pedimos que selecione uma disciplina que o professor ir\xe1 lecionar, e as turmas que ele leciona.","error");Z(!0);const e={admin:"CreateAdmin.php",professor:"CreateProfessor.php",aluno:"CreateAluno.php",auxiliar:"CreateAuxiliar.php"}[G],t=`${U}@etps.com.pt`;if(U.includes("@"))return void Ve("N\xe3o inclua o \u201c@\u201d \u2013 s\xf3 escreva a parte antes do dom\xednio.","error");let a={};a="professor"===G?{email:t,cargoUtilizador:G,disciplina:ue,ano:he,turma:xe[he]||[]}:"aluno"===G?{email:t,cargoUtilizador:G,ano:se,turma:de}:{email:t,cargoUtilizador:G};const o=await fetch(s+e,{method:"POST",headers:{"Content-Type":"application/json",Origin:"http://localhost:19006"},body:JSON.stringify(a)});if(!o.ok){const e=await o.text();throw console.error("ERRO HTTP",o.status,e),new Error(`HTTP ${o.status}`)}const r=await o.json();r.success?Ve("Utilizador criado com sucesso!","success"):Ve(r.message||"Ocorreu um erro ao criar o utilizador.","error")}catch(e){console.error("[ERROR]",e),Ve("Falha na comunica\xe7\xe3o com o servidor.","error")}finally{Z(!1)}},He=async()=>{if(Ce.trim()){Se(!0);try{const e=await fetch(`${c.baseUrl}/adminFiles/CreateDisciplina.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nomeDisciplina:Ce,professorId:0})}),t=await e.json();if(t.success){Ve("Disciplina criada com sucesso!","success");const e={id:t.disciplinaId,disciplina:Ce};ge((t=>[...t,e])),fe(e.id.toString()),ve(""),je(!1)}else Ve(t.message||"Erro ao criar disciplina.","error")}catch(e){console.error("Erro ao criar disciplina:",e),Ve("Erro na comunica\xe7\xe3o com o servidor (criar disciplina)","error")}finally{Se(!1)}}else Ve("Informe o nome da nova disciplina","error")},$e=Ce.trim().length>0,Le=!W||!$.trim()||D.some((e=>e.ano.toString()===W&&e.turma.toUpperCase()===$.toUpperCase())),Ne=()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae}],children:"Selecione a Disciplina:"}),(0,I.jsxs)(b.default,{onPress:()=>je(!be),style:R.plusButton,children:[(0,I.jsx)(F.default,{name:"add-circle-outline",size:28,color:Ae}),(0,I.jsx)(u.default,{style:{color:Ae,marginLeft:5},children:"Nova Disciplina"})]}),be&&(0,I.jsxs)(n.default,{style:R.newDisciplinaContainer,children:[(0,I.jsx)(S.default,{mode:"outlined",placeholder:"Nome da nova disciplina",value:Ce,onChangeText:ve,style:R.newDisciplinaInput,theme:{colors:{primary:Ae,text:Ae,background:ze}}}),(0,I.jsx)(T.default,{onPress:He,mode:"contained",loading:we,disabled:!$e,style:[R.newDisciplinaButton,{opacity:$e?1:.5}],labelStyle:{color:$e?"#FFFFFF":"#999"},children:"Salvar"})]}),0===me.length?(0,I.jsxs)(n.default,{style:R.indicadorContainer,children:[(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"}),(0,I.jsx)(T.default,{onPress:_e,mode:"outlined",style:{marginTop:10},labelStyle:{color:"#47AD4D"},children:"Tentar Novamente"})]}):(0,I.jsx)(f.default,{style:R.scrollViewDisciplinas,contentContainerStyle:{paddingVertical:5},nestedScrollEnabled:!0,scrollEnabled:!0,keyboardShouldPersistTaps:"handled",children:(0,I.jsx)(C.default.Group,{onValueChange:fe,value:ue,children:me.map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e.id.toString(),color:"#47AD4D"}),(0,I.jsx)(u.default,{style:{color:Ae},children:e.disciplina})]},e.id)))})}),(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,marginTop:10}],children:"Ano em que o professor leciona:"}),(0,I.jsx)(C.default.Group,{onValueChange:pe,value:he,children:P.map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e,color:"#47AD4D"}),(0,I.jsxs)(u.default,{style:{color:Ae},children:[e,"\xba Ano"]})]},e)))}),(0,I.jsxs)(b.default,{onPress:()=>_(!0),style:R.plusButton,children:[(0,I.jsx)(F.default,{name:"add-circle-outline",size:24,color:Ae}),(0,I.jsx)(u.default,{style:{color:Ae,marginLeft:5},children:"Nova Turma"})]}),(0,I.jsx)(v.default,{children:(0,I.jsxs)(w.default,{visible:V,onDismiss:()=>{_(!1),H(""),L("")},style:{marginHorizontal:20,backgroundColor:"#fff"},theme:{colors:{surface:"#fff"}},children:[(0,I.jsx)(w.default.Title,{children:"Criar Nova Turma"}),(0,I.jsxs)(w.default.Content,{children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,marginBottom:0}],children:"Selecione o Ano:"}),(0,I.jsx)(C.default.Group,{onValueChange:H,value:W,children:P.map((e=>(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:e,color:"#47AD4D"}),(0,I.jsxs)(u.default,{style:{color:Ae},children:[e,"\xba Ano"]})]},e)))}),(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,marginTop:10}],children:"Letra da Turma:"}),(0,I.jsx)(S.default,{mode:"outlined",placeholder:"Ex: A",value:$,onChangeText:e=>L(e.replace(/[^A-Za-z]/g,"").toUpperCase()),maxLength:1,style:[R.newDisciplinaInput,{backgroundColor:"#fff"}],theme:{colors:{text:Ae,primary:Ae,background:"#fff"}}})]}),(0,I.jsxs)(w.default.Actions,{children:[(0,I.jsx)(T.default,{onPress:()=>{_(!1),H(""),L("")},labelStyle:{color:"red"},children:"Cancelar"}),(0,I.jsx)(T.default,{onPress:Re,loading:N,disabled:Le,style:{opacity:Le?.5:1},labelStyle:{color:Le?"#999":"#47AD4D"},children:"Salvar"})]})]})}),""!==he&&(0,I.jsxs)(n.default,{style:R.containerTurmas,children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae}],children:"Selecionar Turmas:"}),(0,I.jsx)(f.default,{style:R.scrollViewTurmas,contentContainerStyle:{paddingVertical:5},nestedScrollEnabled:!0,scrollEnabled:!0,children:(0,I.jsx)(n.default,{style:R.grelhaTurmas,children:(E[he]||[]).map((e=>{const t=(xe[he]||[]).includes(e.turma);return(0,I.jsx)(x.default,{style:[R.botaoTurma,t&&R.botaoTurmaSelecionada],onPress:()=>{return t=e.turma,void ye((e=>{const a=he,o=e[a]||[],r=o.includes(t)?o.filter((e=>e!==t)):[...o,t];return Object.assign({},e,{[a]:r})}));var t},children:(0,I.jsx)(u.default,{style:t?R.textoTurmaSelecionada:[R.textoTurma,{color:Ae}],children:e.turma})},e.id)}))})}),(0,I.jsxs)(n.default,{style:R.turmasSelecionadas,children:[(0,I.jsx)(u.default,{style:[R.rotuloTurmas,{color:Ae}],children:"Turmas Selecionadas:"}),Object.entries(xe).map((([e,t])=>(0,I.jsxs)(u.default,{style:[R.textoTurmas,{color:Ae}],children:[e,"\xba: ",Array.isArray(t)?t.join(", "):""]},e))),0===Object.keys(xe).length&&(0,I.jsx)(u.default,{style:[R.textoTurmas,{color:Ae}],children:"Nenhuma turma selecionada"})]})]})]}),Me=()=>(0,I.jsxs)(n.default,{style:R.webContainer,children:[(0,I.jsxs)(n.default,{style:R.leftColumn,children:[(0,I.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[(0,I.jsx)(u.default,{style:[R.rotulo,{color:Ae,margin:0}],children:"Selecione o Cargo:"}),(0,I.jsx)(b.default,{onPress:()=>De(!0),style:{padding:4},children:(0,I.jsx)(g.default,{source:a(2074),style:{width:20,height:20,tintColor:Ae}})})]}),(0,I.jsxs)(C.default.Group,{onValueChange:J,value:G,children:[(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:"aluno",color:"#47AD4D"}),(0,I.jsx)(u.default,{style:{color:Ae},children:"Aluno"})]}),(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:"professor",color:"#47AD4D"}),(0,I.jsx)(u.default,{style:{color:Ae},children:"Professor"})]}),(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:"admin",color:"#47AD4D"}),(0,I.jsx)(u.default,{style:{color:Ae},children:"Administrador"})]}),(0,I.jsxs)(n.default,{style:R.grupoRadio,children:[(0,I.jsx)(C.default,{value:"auxiliar",color:"#47AD4D"}),(0,I.jsx)(u.default,{style:{color:Ae},children:"Auxiliar"})]})]}),(0,I.jsx)(S.default,{label:(0,I.jsx)(u.default,{style:{color:"dark"===oe?"#FFF":"#000"},children:"Nome de utilizador"}),mode:"outlined",value:U,onChangeText:q,keyboardType:"email-address",style:[R.campoInput,{backgroundColor:ze}],right:(0,I.jsx)(S.default.Affix,{text:"@etps.com.pt"}),theme:{colors:{text:"dark"===oe?"#FFF":"#000",primary:"dark"===oe?"#FFF":"#000",placeholder:"dark"===oe?"rgba(255,255,255,0.6)":"rgba(0,0,0,0.6)",background:ze,onSurfaceVariant:"dark"===oe?"#FFF":"#000"}}})]}),(0,I.jsxs)(n.default,{style:R.rightColumn,children:["aluno"===G&&Oe(),"professor"===G&&Ne(),("admin"===G||"auxiliar"===G)&&(0,I.jsx)(u.default,{style:{color:Ae,marginTop:20},children:"Nenhum campo adicional necess\xe1rio."})]})]});return(0,I.jsxs)(h.default,{source:te?{uri:te}:a(8922),style:R.bgImage,children:["dark"===oe&&(0,I.jsx)(n.default,{style:R.darkOverlay}),(0,I.jsx)(p.default,{backgroundColor:"transparent",translucent:!0,barStyle:"dark"===oe?"light-content":"dark-content"}),Te.visible&&("success"!==Te.type?(0,I.jsx)(n.default,{style:R.webErrorOverlay,children:(0,I.jsx)(u.default,{style:R.webErrorText,children:Te.message})}):(0,I.jsx)(n.default,{style:[R.toastContainer,"success"===Te.type?R.toastSuccess:R.toastError],children:(0,I.jsx)(u.default,{style:R.toastText,children:Te.message})})),(0,I.jsxs)(n.default,{style:[R.headerFixed,{backgroundColor:"dark"===oe?"#101218":"#FFFFFF"}],children:[(0,I.jsx)(b.default,{onPress:()=>K(!0),style:R.botaoMenu,children:(0,I.jsx)(g.default,{source:a(6181),style:[R.menuIcon,{tintColor:"dark"===oe?"#FFFFFF":"#000"}]})}),(0,I.jsx)(b.default,{onPress:()=>ee(!0),style:R.botaoConta,children:(0,I.jsx)(g.default,{source:a(9119),style:[R.userIcon,{tintColor:"dark"===oe?"#FFFFFF":"#000"}]})})]}),(0,I.jsx)(n.default,{style:[R.fixedBox,{width:"80%",backgroundColor:Pe}],children:le?(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"}):(0,I.jsxs)(I.Fragment,{children:[Me(),(0,I.jsx)(T.default,{mode:"contained",onPress:We,style:R.botaoCriar,labelStyle:{color:"#fff"},loading:Y,children:"Criar Utilizador"})]})}),Q&&(0,I.jsx)(y.default,{onPress:()=>K(!1),children:(0,I.jsx)(n.default,{style:R.overlay,children:(0,I.jsx)(y.default,{children:(0,I.jsxs)(n.default,{style:[R.sideMenu,{backgroundColor:"dark"===oe?"#101218":"#FFFFFF"}],children:[(0,I.jsx)(b.default,{onPress:()=>{K(!1),e.navigate("PutCalendar",{email:U})},style:R.menuItem,children:(0,I.jsx)(u.default,{style:[R.menuText,{color:"dark"===oe?"#FFFFFF":"#000000"}],children:"Carregar um Calend\xe1rio"})}),(0,I.jsx)(b.default,{onPress:()=>{K(!1),e.navigate("confirmacoesScreen",{email:U})},style:R.menuItem,children:(0,I.jsx)(u.default,{style:[R.menuText,{color:"dark"===oe?"#FFFFFF":"#000000"}],children:"Alunos Pendentes"})})]})})})}),(0,I.jsx)(v.default,{children:(0,I.jsxs)(w.default,{visible:Fe,onDismiss:()=>De(!1),style:[{backgroundColor:"#fff"},{width:400,alignSelf:"center"}],theme:{colors:{surface:"#fff"}},children:[(0,I.jsx)(w.default.Title,{children:"O que podes fazer aqui?"}),(0,I.jsx)(w.default.Content,{children:(0,I.jsxs)(f.default,{style:{maxHeight:200},children:[(0,I.jsx)(k.default,{children:"\u2022 \xc9 poss\xedvel criar uma conta para um utilizador com cargo \u201cAluno\u201d, \u201cProfessor\u201d, \u201cAdministrador\u201d ou \u201cAuxiliar\u201d."}),(0,I.jsx)(k.default,{children:"\u2022 Se for para criar um \u201cAluno\u201d, escolher ano (10\xba,11\xba,12\xba) e a turma."}),(0,I.jsx)(k.default,{children:"\u2022 Se for para criar um \u201cProfessor\u201d, selecionar disciplina, ano e uma ou mais turmas."}),(0,I.jsx)(k.default,{children:"\u2022 Os administradores e auxiliares n\xe3o t\xeam campos adicionais, bastando assim adicionar o email."}),(0,I.jsx)(k.default,{children:"\u2022 \xc9 poss\xedvel criar um nova disciplina, bastando apenas informar o nome."})]})}),(0,I.jsx)(w.default.Actions,{children:(0,I.jsx)(T.default,{labelStyle:{color:"#47AD4D"},onPress:()=>De(!1),children:"OK"})})]})}),(0,I.jsx)(A,{visible:X,dynamicHeaderBackground:"dark"===oe?"#101218":"#FFFFFF",dynamicTextColor:"dark"===oe?"#FFFFFF":"#000",onClose:()=>ee(!1),navigation:e,email:Be})]})};var O=a(25),V=a(8208),_=a(212),W=a(3148),H=a(9112);const $=m.default.create({bgImage:{flex:1},safe:{flex:1,backgroundColor:"transparent"},header:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},icon:{width:35,height:35,marginLeft:3,marginTop:-15},card:{backgroundColor:"rgba(255,255,255,0.9)",borderRadius:6,padding:12,marginBottom:16},msgTitle:{fontWeight:"bold",marginBottom:4},msgDate:{fontSize:12,marginBottom:8,color:"#666"},msgBody:{marginBottom:12},responseInput:{minHeight:60,marginBottom:8},saveButton:{margin:16}}),L=()=>{(0,j.useTheme)();const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o}=t.params,[i,d]=(0,r.useState)(null),[u,f]=(0,r.useState)("light"),[m,p]=(0,r.useState)([]),[x,y]=(0,r.useState)(!0),[C,v]=(0,r.useState)({}),[w,k]=(0,r.useState)(!1),[F,D]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),d(e),f("dark"===t?"dark":"light")}catch{}})()}),[]);const P=async()=>{y(!0);try{const e=await B.default.get(`${c.baseUrl}/calendarioFiles/suggest/fetch_unanswered_suggestions.php`,{params:{email:o}});e.data.success?p(e.data.data):O.default.alert("Erro",e.data.message||"Falha ao carregar sugest\xf5es")}catch(e){console.error(e),O.default.alert("Erro","N\xe3o foi poss\xedvel comunicar com o servidor.")}finally{y(!1)}};(0,r.useEffect)((()=>{P()}),[]);return(0,I.jsx)(h.default,{source:i?{uri:i}:a(8922),style:$.bgImage,resizeMode:"cover",children:(0,I.jsxs)(_.default,{style:$.safe,children:[(0,I.jsxs)(n.default,{style:[$.header,{paddingTop:40}],children:[(0,I.jsx)(b.default,{onPress:()=>{window.confirm("Tem a certeza que deseja sair?")&&e.navigate("Aluno")},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:[$.icon,{tintColor:"dark"===u?"#FFF":"#000"}]})}),(0,I.jsx)(b.default,{onPress:()=>D(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:[$.icon,{tintColor:"dark"===u?"#FFF":"#000"}]})})]}),x?(0,I.jsx)(l.default,{style:{marginTop:50}}):(0,I.jsx)(V.default,{data:m,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,I.jsxs)(n.default,{style:$.card,children:[(0,I.jsxs)(W.default,{style:$.msgTitle,children:["Sugest\xe3o de ",e.email]}),(0,I.jsx)(W.default,{style:$.msgDate,children:e.date_sent}),(0,I.jsx)(W.default,{style:$.msgBody,children:e.message}),(0,I.jsx)(S.default,{mode:"outlined",label:"Responder",placeholder:"Escreve aqui a tua resposta...",value:C[e.id]||"",onChangeText:t=>v((a=>Object.assign({},a,{[e.id]:t}))),multiline:!0,style:$.responseInput}),(0,I.jsx)(H.default,{})]}),contentContainerStyle:{padding:16,paddingTop:100},ListFooterComponent:w?(0,I.jsx)(l.default,{style:{margin:20}}):(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{const e=Object.entries(C).filter((([,e])=>""!==e.trim())).map((([e,t])=>({id:e,response:t})));if(0!==e.length){k(!0);try{const t=await B.default.post(`${c.baseUrl}/calendarioFiles/suggest/submit_responses.php`,{responder:o,responses:e});t.data.success?(O.default.alert("Sucesso","Respostas guardadas com sucesso."),v({}),P()):O.default.alert("Erro",t.data.message||"Falha ao guardar respostas")}catch(t){console.error(t),O.default.alert("Erro","N\xe3o foi poss\xedvel comunicar com o servidor.")}finally{k(!1)}}else O.default.alert("Aten\xe7\xe3o","Nenhuma resposta para guardar.")},style:$.saveButton,children:"Guardar Respostas"})}),(0,I.jsx)(A,{visible:F,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>D(!1),navigation:e,email:o})]})})};var N=a(4601),M=a(5664),U=a(9849),q=a(6636);const G={light:{title:"#000000",box:"#FFFFFF",icon:"#000000",text:"#333333",background:"#F2F2F2",modalOverlay:"rgba(0,0,0,0.1)"},dark:{title:"#FFFFFF",box:"#222222",icon:"#FFFFFF",text:"#EEEEEE",background:"#000000",modalOverlay:"rgba(255,255,255,0.1)"}};function J(e){return G[e].icon}function Y(e){return G[e].background}function Z(e){return G[e].modalOverlay}const Q=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}],K={inputIOS:{fontSize:16,paddingVertical:10,paddingHorizontal:12,color:"black",paddingRight:30},inputAndroid:{fontSize:16,paddingHorizontal:10,paddingVertical:8,color:"black",paddingRight:30}},X=m.default.create({configModalContainer:{padding:20,minHeight:"100%"},configHeader:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",paddingTop:p.default.currentHeight||20,paddingHorizontal:15,paddingBottom:10,backgroundColor:"white",elevation:4,position:"absolute",top:0,zIndex:10},warningText:{marginVertical:10},fieldContainer:{backgroundColor:"#F9F9F9",borderRadius:8,padding:12,marginVertical:6,elevation:2},fieldLabel:{fontSize:14,fontWeight:"bold",marginBottom:4,color:"#333"},fieldValue:{fontSize:16,color:"#555"},editableBox:{backgroundColor:"#EFEFEF",borderRadius:8,padding:12,marginVertical:6,elevation:1},selectedColorDisplay:{flexDirection:"row",alignItems:"center"},colorCircle:{width:24,height:24,borderRadius:12},notificationRow:{flexDirection:"row",alignItems:"center",marginVertical:5},spinnerContainer:{flexDirection:"row",alignItems:"center",marginHorizontal:5},spinnerInput:{width:40,backgroundColor:"#F0F0F0",textAlign:"center",marginRight:5},spinnerButtons:{flexDirection:"column"},stepButton:{paddingHorizontal:5},stepButtonText:{fontSize:12},addTimeButton:{marginVertical:10},saveButton:{marginVertical:10,borderRadius:8},colorModalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},colorModalContainer:{width:"80%",backgroundColor:"#FFF",padding:20,borderRadius:10},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#ccc"},colorName:{fontSize:16,marginLeft:10},modalCloseButton:{marginTop:10,backgroundColor:"#47AD4D"},background:{flex:1},overlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.5)"}),safeContainer:{flex:1},loaderContainer:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#000",textAlign:"center"},header:{height:70,flexDirection:"row",alignItems:"center",paddingHorizontal:15,elevation:4},menuIcon:{marginRight:10,marginTop:35},todoIcon:{marginRight:0,marginTop:35},accountIcon:{marginRight:0,marginTop:35},headerButtons:{flexDirection:"row",marginLeft:"auto"},container:{flex:1,marginTop:6},calendarBox:{backgroundColor:"#FFF",borderRadius:12,padding:10,margin:10,elevation:3},badge:{position:"absolute",marginTop:60,top:0,right:0,width:20,height:20,backgroundColor:"red",borderRadius:10,justifyContent:"center",alignItems:"center"},badgeText:{color:"white",fontSize:12,fontWeight:"bold"},eventRectangle:{paddingHorizontal:4,paddingVertical:2,borderRadius:3,marginVertical:1,opacity:.9},eventRectangleText:{fontSize:10,color:"#FFF",fontWeight:"bold"},dayModalContainer:{flex:1},dayModalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:15,borderBottomWidth:1,borderColor:"#ccc"},dayModalTitle:{fontSize:20,fontWeight:"bold"},fullScreenModal:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.6)",justifyContent:"center",alignItems:"center"},modalContent:{width:"95%",height:"90%",borderRadius:15,padding:20},calendarContainer:{marginTop:20,height:250},bigCalendarContainer:{height:450},selectedDatesScroll:{marginTop:20},selectedDatesContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center",paddingHorizontal:10},selectedDateItem:{backgroundColor:"#47AD4D",padding:8,margin:5,borderRadius:5},selectedDateText:{color:"#FFF",fontSize:16},configHeaderTitle:{fontSize:20,fontWeight:"bold"},label:{fontSize:16,marginTop:10},input:{marginBottom:10,backgroundColor:"#F0F0F0"},menuOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"flex-start"},menuContent:{width:"65%",height:"100%",padding:20,borderTopRightRadius:20,borderBottomRightRadius:20,justifyContent:"flex-start"},menuTitle:{fontSize:22,fontWeight:"bold",marginBottom:30},menuLink:{paddingVertical:15,borderBottomWidth:1,borderBottomColor:"#ddd"},menuText:{fontSize:18},backButton:{marginTop:35}}),ee=({navigation:e})=>{const t=(0,s.useRoute)(),o=`${c.baseUrl}/calendarioFiles/aluno/fetch_events.php`,l=`${c.baseUrl}/calendarioFiles/aluno/fetch_tasks.php`,i=`${c.baseUrl}/calendarioFiles/aluno/update_events_config.php`,d=`${c.baseUrl}/calendarioFiles/aluno/update_tasks_config.php`,{height:u}=M.default.get("window"),[m,x]=(0,r.useState)({email:"",aluno_id:null}),[y,j]=(0,r.useState)([]),[C,v]=(0,r.useState)([]),[w,k]=(0,r.useState)(!1),[F,P]=(0,r.useState)(!1),[z,R]=(0,r.useState)(!1),[E,V]=(0,r.useState)(null),[H,$]=(0,r.useState)(null),[L,ee]=(0,r.useState)(null),[te,ae]=(0,r.useState)([]),[oe,re]=(0,r.useState)("#47AD4D"),[le,ne]=(0,r.useState)(!1),[se,ie]=(0,r.useState)(!1);(0,r.useEffect)((()=>{t.params?.email&&x((e=>Object.assign({},e,{email:t.params.email})));const e=t.params?.email;e&&(ge(),me())}),[t.params?.email]);const de=t.params?.email,ce=t.params?.theme||"light",ue=t.params?.backgroundUrl||"",fe=`${c.baseUrl}/${ue}`,me=(0,r.useCallback)((()=>{de&&B.default.post(o,{email:de}).then((e=>{if(Array.isArray(e.data)){const t=e.data.map((e=>{const[t,a]=e.start_datetime.split(" "),[o,r]=e.end_datetime.split(" "),[l,n,s]=t.split("-"),[i,d]=a.split(":"),[c,u]=r.split(":"),f=new Date(parseInt(l),parseInt(n)-1,parseInt(s),parseInt(i),parseInt(d)),m=new Date(parseInt(l),parseInt(n)-1,parseInt(s),parseInt(c),parseInt(u));return{title:e.title||"Evento",start:f,end:m,color:e.cores&&e.cores.trim()?e.cores:"#47AD4D",id:e.id,descricao:e.descricao||""}}));j(t)}else console.error("Formato inesperado dos eventos:",e.data)})).catch((()=>{console.error("Erro ao procurar eventos na base de dados.")}))}),[de]),ge=()=>{de&&B.default.post(l,{email:de},{headers:{"Content-Type":"application/json"}}).then((e=>{e.data.success&&Array.isArray(e.data.tasks)?v(e.data.tasks):v([])})).catch((e=>{console.error("Erro ao procurar as tarefas:",e)}))},he=e=>{e.isTask?$(e.taskDetails):ee(e)},pe=C.map((e=>{const t=new Date(e.data_da_tarefa),a=new Date(t.getTime()-18e5),o=t;return{title:e.titulo||"Tarefa",start:a,end:o,color:e.cor&&e.cor.trim()?e.cor:"#47AD4D",isTask:!0,taskDetails:e}})),xe=[...y,...pe],ye=xe.filter((e=>!!E&&e.start.toDateString()===E.toDateString())),be=e=>`${e.getDate().toString().padStart(2,"0")} de ${["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][e.getMonth()]} de ${e.getFullYear()} \xe0s ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`,je=()=>{L&&O.default.alert("Confirma\xe7\xe3o","Ao guardar estas configura\xe7\xf5es v\xe3o mudar apenas para si!",[{text:"Cancelar",style:"cancel"},{text:"Guardar",onPress:()=>{const e=te.map((e=>{let t=e.timeValue;return"hours"===e.unit&&(t=60*e.timeValue),"days"===e.unit&&(t=1440*e.timeValue),"weeks"===e.unit&&(t=10080*e.timeValue),t})),t={event_id:L.id,email:de,cor:oe,notificacao_tipo:"notificacao",notification_times:e};B.default.post(i,t).then((e=>{e.data.success?(O.default.alert("Sucesso",e.data.message),me(),ee(null)):O.default.alert("Erro",e.data.message)})).catch((e=>{console.error("Erro ao atualizar configura\xe7\xe3o do evento:",e),O.default.alert("Erro","Erro ao atualizar configura\xe7\xe3o do evento.")}))}}])},Ce=()=>{H&&O.default.alert("Confirma\xe7\xe3o","Ao guardar estas configura\xe7\xf5es v\xe3o mudar apenas para si!",[{text:"Cancelar",style:"cancel"},{text:"Guardar",onPress:()=>{const e=te.map((e=>{let t=e.timeValue;return"hours"===e.unit&&(t=60*e.timeValue),"days"===e.unit&&(t=1440*e.timeValue),"weeks"===e.unit&&(t=10080*e.timeValue),t})),t={tarefa_id:H.tarefa_id,email:de,cor:oe,notificacao_tipo:"notificacao",notification_times:e};B.default.post(d,t).then((e=>{e.data.success?(O.default.alert("Sucesso",e.data.message),ge(),$(null)):O.default.alert("Erro",e.data.message||"Ocorreu um erro. Tente novamente mais tarde.")})).catch((e=>{console.error("Erro ao atualizar configura\xe7\xe3o da tarefa:",e),O.default.alert("Erro","Erro ao atualizar configura\xe7\xe3o da tarefa.")}))}}])},ve=e=>{ae((t=>{const a=[...t];return a[e].timeValue<60&&(a[e].timeValue+=1),a}))},we=e=>{ae((t=>{const a=[...t];return a[e].timeValue>1&&(a[e].timeValue-=1),a}))},Se=()=>{ae((e=>[...e,{alertType:"notification",timeValue:15,unit:"minutes"}]))},Te=e=>"minutes"===e?"minutos":"hours"===e?"horas":"days"===e?"dias":"weeks"===e?"semanas":"",ke=()=>function(e){return G[e].text}(ce);return(0,I.jsxs)(h.default,{source:fe?{uri:fe}:a(8922),style:X.background,children:["dark"===ce&&(0,I.jsx)(n.default,{style:X.overlay}),(0,I.jsx)(p.default,{backgroundColor:"transparent",translucent:!0,barStyle:"dark"===ce?"light-content":"dark-content"}),(0,I.jsxs)(_.default,{style:X.safeContainer,children:[(0,I.jsxs)(n.default,{style:[X.header,{backgroundColor:Y(ce)}],children:[(0,I.jsx)(b.default,{onPress:()=>k(!0),style:X.menuIcon,children:(0,I.jsx)(g.default,{source:a(6181),style:[{width:35,height:35,marginLeft:3,marginTop:-15},{tintColor:J(ce)}]})}),(0,I.jsxs)(n.default,{style:X.headerButtons,children:[(0,I.jsxs)(n.default,{style:{position:"relative"},children:[(0,I.jsx)(b.default,{onPress:()=>e.navigate("PersonalizarTarefa",{email:m.email,theme:ce,backgroundUrl:fe}),style:X.todoIcon,children:(0,I.jsx)(g.default,{source:a(5673),style:[{width:30,height:30,marginRight:20,marginTop:-3},{tintColor:J(ce)}]})}),C.length+y.length>0&&!1]}),(0,I.jsx)(b.default,{onPress:()=>P(!0),style:X.accountIcon,children:(0,I.jsx)(g.default,{source:a(9119),style:[{width:30,height:30,marginTop:-5},{tintColor:J(ce)}]})})]})]}),(0,I.jsx)(f.default,{style:X.container,refreshControl:(0,I.jsx)(N.default,{refreshing:se,onRefresh:()=>{ie(!0),me(),ge(),setTimeout((()=>ie(!1)),1e3)}}),children:(0,I.jsx)(n.default,{style:X.calendarBox,children:(0,I.jsx)(q.Calendar,{events:xe,height:.84*u,mode:"month",swipeEnabled:!0,weekStartsOn:1,showTime:!1,onPressCell:e=>{V(e),R(!0)},onPressEvent:he,calendarContainerStyle:{backgroundColor:Y(ce),height:350},renderEvent:e=>(0,I.jsx)(n.default,{style:[X.eventRectangle,{backgroundColor:e.color}],children:(0,I.jsx)(W.default,{style:X.eventRectangleText,numberOfLines:1,children:e.title})})})})}),(0,I.jsx)(D.default,{visible:z,animationType:"slide",transparent:!1,onRequestClose:()=>R(!1),children:(0,I.jsxs)(_.default,{style:[X.dayModalContainer,{backgroundColor:Y(ce)}],children:[(0,I.jsxs)(n.default,{style:X.dayModalHeader,children:[(0,I.jsx)(W.default,{style:[X.dayModalTitle,{color:Z(ce)}],children:E?E.toDateString():""}),(0,I.jsx)(b.default,{onPress:()=>R(!1),style:{padding:8},children:(0,I.jsx)(g.default,{source:a(5132),style:[{width:20,height:20},{tintColor:Z(ce)}]})})]}),(0,I.jsx)(f.default,{contentContainerStyle:{flexGrow:1},children:(0,I.jsx)(q.Calendar,{date:E,events:ye,height:600,mode:"day",swipeEnabled:!0,showTime:!0,eventCellStyle:e=>e.color?{backgroundColor:e.color}:{},onPressEvent:he,calendarContainerStyle:{backgroundColor:Y(ce)}})})]})}),H||L?(0,I.jsxs)(D.default,{visible:!0,animationType:"slide",children:[(0,I.jsxs)(n.default,{style:[X.configHeader,{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}],children:[(0,I.jsx)(b.default,{onPress:()=>{ee(null),$(null),ne(!1)},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,tintColor:J(ce)}})}),(0,I.jsx)(b.default,{onPress:()=>P(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:{width:35,height:35,tintColor:J(ce)}})})]}),(0,I.jsxs)(f.default,{contentContainerStyle:[X.configModalContainer,{backgroundColor:Y(ce),paddingTop:80,paddingHorizontal:20,paddingBottom:20}],children:[(0,I.jsxs)(W.default,{style:[X.warningText,{textAlign:"center",fontSize:16,fontWeight:"bold",marginBottom:20,color:Z(ce)}],children:["As configura\xe7\xf5es abaixo s\xe3o apenas para si e n\xe3o afetam o ",H?"tarefa":"evento"," original."]}),H?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:H.titulo||`Tarefa ${H.tarefa_id}`})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Criado por:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:H.professor_email})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Data da Tarefa:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:H.data_da_tarefa})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:H.descricao||"N\xe3o h\xe1 descri\xe7\xe3o."})]}),(0,I.jsxs)(n.default,{style:X.editableBox,children:[(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Cor:"}),(0,I.jsxs)(b.default,{activeOpacity:.7,style:[X.selectedColorDisplay,{paddingVertical:10}],onPress:()=>ne(!0),children:[(0,I.jsx)(n.default,{style:[X.colorCircle,{backgroundColor:oe,marginRight:10}]}),(0,I.jsx)(W.default,{style:{fontSize:16,color:Z(ce)},children:"Alterar Cor"})]})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Notifica\xe7\xf5es:2"}),te.map(((e,t)=>(0,I.jsxs)(n.default,{style:[X.notificationRow],children:[(0,I.jsx)(n.default,{style:{flex:1,minWidth:100,marginRight:8},children:(0,I.jsx)(U.default,{onValueChange:e=>{e&&ae((a=>{const o=[...a];return o[t].alertType=e,o}))},items:[{label:"Email",value:"email"},{label:"Notifica\xe7\xe3o",value:"notification"}],placeholder:{},value:e.alertType,useNativeAndroidPickerStyle:!1,style:K})}),(0,I.jsx)(S.default,{style:{width:60,height:"auto",textAlign:"center",paddingVertical:8,fontSize:16,color:Z(ce),backgroundColor:Y(ce),borderRightWidth:1,borderColor:"#ccc"},keyboardType:"numeric",value:null!==e.timeValue?String(e.timeValue):"",onChangeText:e=>{if(""===e)ae((e=>{const a=[...e];return a[t].timeValue=null,a}));else{const a=parseInt(e,10);!isNaN(a)&&a>=1&&a<=60&&ae((e=>{const o=[...e];return o[t].timeValue=a,o}))}},onBlur:()=>{ae((e=>{const a=[...e];return null===a[t].timeValue&&(a[t].timeValue=1),a}))}}),(0,I.jsxs)(n.default,{style:{flexDirection:"column"},children:[(0,I.jsx)(b.default,{onPress:()=>ve(t),style:X.stepButton,children:(0,I.jsx)(W.default,{style:X.stepButtonText,children:"\u25b2"})}),(0,I.jsx)(b.default,{onPress:()=>we(t),style:X.stepButton,children:(0,I.jsx)(W.default,{style:X.stepButtonText,children:"\u25bc"})})]}),(0,I.jsx)(n.default,{style:{flex:1,minWidth:100,marginRight:8},children:(0,I.jsx)(U.default,{onValueChange:e=>{e&&ae((a=>{const o=[...a];return o[t].unit=e,o}))},items:[{label:Te("minutes"),value:"minutes"},{label:Te("hours"),value:"hours"},{label:Te("days"),value:"days"},{label:Te("weeks"),value:"weeks"}],placeholder:{},value:e.unit,useNativeAndroidPickerStyle:!1,style:K})}),(0,I.jsx)(b.default,{onPress:()=>ae((e=>e.filter(((e,a)=>a!==t)))),style:{padding:8},children:(0,I.jsx)(g.default,{source:a(5132),style:{width:20,height:20}})})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:Se,style:[X.addTimeButton,{borderColor:"#47AD4D"}],labelStyle:{color:"#47AD4D",fontWeight:"bold"},children:"+ Adicionar notifica\xe7\xe3o"})]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:Ce,style:[X.saveButton,{backgroundColor:"#47AD4D",marginTop:20}],labelStyle:{color:"#FFF",fontWeight:"bold"},children:"Salvar Configura\xe7\xf5es"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:L.title})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Criado por:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:"-"})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Data de In\xedcio:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:be(L.start)})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Data de Fim:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:be(L.end)})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:X.fieldValue,children:L.descricao||"N\xe3o h\xe1 descri\xe7\xe3o."})]}),(0,I.jsxs)(n.default,{style:X.editableBox,children:[(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Cor:"}),(0,I.jsxs)(b.default,{activeOpacity:.7,style:[X.selectedColorDisplay,{paddingVertical:10}],onPress:()=>ne(!0),children:[(0,I.jsx)(n.default,{style:[X.colorCircle,{backgroundColor:oe,marginRight:10}]}),(0,I.jsx)(W.default,{style:{fontSize:16,color:Z(ce)},children:"Alterar Cor"})]})]}),(0,I.jsxs)(n.default,{style:X.fieldContainer,children:[(0,I.jsx)(W.default,{style:X.fieldLabel,children:"Notifica\xe7\xf5es:1"}),te.map(((e,t)=>(0,I.jsxs)(n.default,{style:[X.notificationRow,!1],children:[(0,I.jsx)(n.default,{style:{flex:1,minWidth:100,marginRight:8},children:(0,I.jsx)(U.default,{onValueChange:e=>{e&&ae((a=>{const o=[...a];return o[t].alertType=e,o}))},items:[{label:"Email",value:"email"},{label:"Notifica\xe7\xe3o",value:"notification"}],placeholder:{},value:e.alertType,useNativeAndroidPickerStyle:!1,style:K})}),(0,I.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:"#ccc",borderRadius:4,overflow:"hidden",marginVertical:8},children:[(0,I.jsx)(S.default,{style:{width:60,textAlign:"center",paddingVertical:8,fontSize:16,color:Z(ce),backgroundColor:Z(ce),borderRightWidth:1,borderColor:"#ccc"},keyboardType:"numeric",value:null!==e.timeValue?String(e.timeValue):"",onChangeText:e=>{if(""===e)ae((e=>{const a=[...e];return a[t].timeValue=null,a}));else{const a=parseInt(e,10);!isNaN(a)&&a>=1&&a<=60&&ae((e=>{const o=[...e];return o[t].timeValue=a,o}))}},onBlur:()=>{ae((e=>{const a=[...e];return null===a[t].timeValue&&(a[t].timeValue=1),a}))}}),(0,I.jsxs)(n.default,{style:{flexDirection:"column"},children:[(0,I.jsx)(b.default,{onPress:()=>ve(t),style:X.stepButton,children:(0,I.jsx)(W.default,{style:X.stepButtonText,children:"\u25b2"})}),(0,I.jsx)(b.default,{onPress:()=>we(t),style:X.stepButton,children:(0,I.jsx)(W.default,{style:X.stepButtonText,children:"\u25bc"})})]})]}),(0,I.jsx)(n.default,{style:{flex:1,minWidth:100,marginRight:8},children:(0,I.jsx)(U.default,{onValueChange:e=>{e&&ae((a=>{const o=[...a];return o[t].unit=e,o}))},items:[{label:Te("minutes"),value:"minutes"},{label:Te("hours"),value:"hours"},{label:Te("days"),value:"days"},{label:Te("weeks"),value:"weeks"}],placeholder:{},value:e.unit,useNativeAndroidPickerStyle:!1,style:K})}),(0,I.jsx)(b.default,{onPress:()=>ae((e=>e.filter(((e,a)=>a!==t)))),style:{padding:8},children:(0,I.jsx)(g.default,{source:a(5132),style:{width:20,height:20}})})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:Se,style:[X.addTimeButton,{borderColor:"#47AD4D"}],labelStyle:{color:"#47AD4D",fontWeight:"bold"},children:"+ Adicionar notifica\xe7\xe3o"})]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:je,style:[X.saveButton,{backgroundColor:"#47AD4D",marginTop:20}],labelStyle:{color:"#FFF",fontWeight:"bold"},children:"Salvar Configura\xe7\xf5es"})]})]})]}):null,(0,I.jsx)(D.default,{visible:w,animationType:"slide",transparent:!0,onRequestClose:()=>k(!1),children:(0,I.jsx)(b.default,{style:X.menuOverlay,activeOpacity:1,onPressOut:()=>k(!1),children:(0,I.jsxs)(n.default,{style:[X.menuContent,{backgroundColor:Y(ce)}],children:[(0,I.jsx)(W.default,{style:[X.menuTitle,{color:ke()}],children:"Menu"}),(0,I.jsxs)(b.default,{onPress:()=>{k(!1),e.navigate("disciplinasAluno",{email:m.email})},style:[X.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[X.menuText,{color:ke()}],children:"Disciplinas"})]}),(0,I.jsxs)(b.default,{onPress:()=>{k(!1),e.navigate("entradasEsaidas",{email:m.email})},style:[X.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[X.menuText,{color:ke()}],children:"Entradas e sa\xeddas"})]}),(0,I.jsxs)(b.default,{onPress:()=>{k(!1),e.navigate("NotasScreen",{email:m.email})},style:[X.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[X.menuText,{color:ke()}],children:"Notas"})]}),(0,I.jsxs)(b.default,{onPress:()=>{k(!1),e.navigate("HorariosScreen",{email:m.email})},style:[X.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[X.menuText,{color:ke()}],children:"Hor\xe1rios"})]}),(0,I.jsxs)(b.default,{onPress:()=>{k(!1),e.navigate("AlmocosScreen",{email:m.email})},style:[X.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[X.menuText,{color:ke()}],children:"Almo\xe7os"})]}),(0,I.jsx)(b.default,{onPress:async()=>{k(!1),e.navigate("QRCodeScannerScreen",{email:de})},style:[X.menuLink,{flexDirection:"row",alignItems:"center",marginTop:"auto"}],children:!1})]})})}),(0,I.jsx)(D.default,{visible:le,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:X.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:X.colorModalContainer,children:[(0,I.jsx)(W.default,{style:[X.modalTitle,{color:ke()}],children:"Selecionar Cor"}),!Q.find((e=>e.value===oe))&&(0,I.jsxs)(b.default,{style:X.colorOptionRow,onPress:()=>{re(oe),ne(!1)},children:[(0,I.jsx)(n.default,{style:[X.colorCircle,{backgroundColor:oe}]}),(0,I.jsx)(W.default,{style:[X.colorName,{color:ke()}],children:"Cor Atual"})]}),Q.map((e=>(0,I.jsxs)(b.default,{style:X.colorOptionRow,onPress:()=>{re(e.value),ne(!1)},children:[(0,I.jsx)(n.default,{style:[X.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{style:[X.colorName,{color:ke()}],children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>ne(!1),style:X.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(A,{visible:F,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>P(!1),navigation:e,email:m.email})]})]})};var te=a(1756),ae=a(1914);const oe=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}],re=m.default.create({modalBg:{flex:1},mobileModalBox:{flex:1,marginTop:90,backgroundColor:"white",borderTopLeftRadius:16,borderTopRightRadius:16,marginBottom:190,padding:20},webModalBox:{marginTop:120,width:"90%",maxWidth:700,maxHeight:"85%",backgroundColor:"white",borderRadius:16,padding:40,alignSelf:"center"},configModalContainer:{padding:30,paddingBottom:50},editButton:{alignSelf:"flex-end",marginTop:10,borderColor:"#47AD4D",borderWidth:1},buttonsRow:{flexDirection:"row",justifyContent:"space-between",marginVertical:16},saveButtonSmall:{flex:1,marginRight:8,backgroundColor:"#47AD4D"},deleteButtonSmall:{flex:1,marginLeft:8,backgroundColor:"#FF5733"},label:{marginBottom:8,fontSize:18},input:{marginBottom:20,height:50},summaryContainer:{backgroundColor:"#F9F9F9",borderRadius:8,padding:16,marginBottom:24},summaryRow:{flexDirection:"row",alignItems:"center",marginBottom:12},summaryLabel:{flex:1,fontWeight:"600",fontSize:16,color:"##000"},summaryValue:{flex:2,fontSize:16,color:"#000",textAlign:"right"},dayHeader:{fontSize:16,fontWeight:"600",marginBottom:8,color:"#333"},eventItem:{padding:10,borderRadius:6,marginBottom:6},eventTitle:{fontWeight:"bold",color:"#fff"},eventTime:{color:"#fff",fontSize:12},noEventsText:{fontStyle:"italic",color:"#666"},closeButton:{position:"absolute",top:20,right:10,padding:10,zIndex:10},closeIcon:{width:24,height:24},colorModalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},webInput:{marginBottom:12,padding:8,borderWidth:1,borderRadius:4},colorModalContainer:{width:"80%",backgroundColor:"#FFF",padding:20,borderRadius:10},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#ccc"},colorCircle:{width:24,height:24,borderRadius:12,marginRight:10},colorName:{fontSize:16,marginLeft:10},modalCloseButton:{marginTop:10,backgroundColor:"#47AD4D"},fab:{position:"absolute",bottom:-60,left:"52.5%",transform:[{translateX:-50}],borderRadius:20,backgroundColor:"#47AD4D",width:30,height:30,justifyContent:"center",alignItems:"center"},selectedDatesScroll:{maxHeight:550,marginTop:10},selectedDateItem:{width:"48%",marginBottom:5,alignItems:"center"},selectedDatesContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginTop:150,paddingHorizontal:10},selectedDateText:{fontSize:14,color:"black",width:"48%",textAlign:"center",padding:5,backgroundColor:"rgba(255, 255, 255, 0.2)",borderRadius:5,marginBottom:5},fullScreenModal:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.6)",justifyContent:"center",alignItems:"center"},modalContent:{width:"95%",height:"90%",borderRadius:15,padding:20},backButton:{position:"absolute",top:30,left:20,zIndex:10},loaderContainer:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},loadingText:{marginTop:16,fontSize:16,color:"#000",textAlign:"center"},background:{flex:1},overlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.5)"}),safeContainer:{flex:1},header:{width:"100%",flexDirection:"row",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,backgroundColor:"white",position:"absolute",top:0,zIndex:10},menuIcon:{marginRight:10,marginTop:35},plusButtonContainer:{position:"absolute",bottom:20,alignSelf:"center",width:45,height:45,borderRadius:25,justifyContent:"center",alignItems:"center",elevation:5,shadowColor:"#000",shadowOpacity:.3,shadowRadius:3,shadowOffset:{width:0,height:2}},plusIcon:{width:25,height:25},todoIcon:{marginRight:0,marginTop:35},headerButtons:{flexDirection:"row",marginLeft:"auto"},accontIcon:{marginRight:0,marginTop:35},container:{flex:1,marginTop:50},calendarBox:{backgroundColor:"#FFF",borderRadius:12,padding:10,margin:10,elevation:3},menuOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"flex-start"},menuContent:{width:"65%",height:"100%",padding:20,borderTopRightRadius:20,borderBottomRightRadius:20,justifyContent:"flex-start"},menuTitle:{fontSize:22,fontWeight:"bold",marginBottom:30},menuLink:{paddingVertical:15,borderBottomWidth:1,borderBottomColor:"#ddd"},menuText:{fontSize:18},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center",padding:20},loaderOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255,255,255,0.7)",justifyContent:"center",alignItems:"center"},dayModalContainer:{flex:1,backgroundColor:"#fff"},dayModalHeader:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:15,borderBottomWidth:1,borderColor:"#ccc",height:55},dayModalTitle:{fontSize:20,fontWeight:"bold"},badge:{marginTop:60,position:"absolute",top:0,right:0,width:20,height:20,backgroundColor:"red",borderRadius:10,justifyContent:"center",alignItems:"center"},badgeOnListCheck:{position:"absolute",bottom:-11,right:-12,backgroundColor:"red",width:18,height:18,borderRadius:9,justifyContent:"center",alignItems:"center"},badgeText:{color:"#fff",fontSize:10,fontWeight:"bold"},configHeader:{flexDirection:"row",alignItems:"center",marginBottom:20},configHeaderTitle:{fontSize:20,fontWeight:"bold",marginLeft:10},backIcon:{width:35,height:35,tintColor:"#000"},userIcon:{width:35,height:35,tintColor:"#000"},nonEditableInput:{backgroundColor:"#ddd"},warningText:{fontSize:14,marginBottom:10},selectedColorDisplay:{flexDirection:"row",alignItems:"center",marginTop:5,marginBottom:15},saveButton:{marginVertical:10},inputContainer:{backgroundColor:"#F0F0F0",borderWidth:1,borderColor:"#ccc",paddingVertical:6,paddingHorizontal:10,borderRadius:5,marginBottom:15,minHeight:40},colorSelector:{flexDirection:"row",alignItems:"center",backgroundColor:"#F0F0F0",padding:10,borderRadius:5,marginBottom:15},saveButtonText:{color:"white",fontWeight:"bold",textAlign:"center",padding:13,borderRadius:5,backgroundColor:"#47AD4D"},deleteButton:{backgroundColor:"red",padding:10,borderRadius:5,alignItems:"center",marginTop:10},deleteButtonText:{color:"white",fontWeight:"bold"},confirmationOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},confirmationContainer:{width:"80%",backgroundColor:"#FFF",padding:20,borderRadius:10,alignItems:"center"},confirmationText:{fontSize:18,marginBottom:20,textAlign:"center"},confirmationButtons:{flexDirection:"row",justifyContent:"space-between",width:"100%"},cancelButton:{backgroundColor:"#ccc",marginRight:10},confirmButton:{backgroundColor:"#47AD4D"},previewOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},previewContainer:{width:"80%",backgroundColor:"#fff",padding:20,borderRadius:8,alignItems:"center"},previewImage:{width:200,height:200,marginBottom:15},previewText:{marginBottom:15,fontSize:16},previewButtons:{flexDirection:"row",justifyContent:"space-between",width:"100%"}}),le=({navigation:e})=>{const t=(0,j.useTheme)(),o=(0,s.useRoute)(),{height:i}=M.default.get("window"),d=`${c.baseUrl}/calendarioFiles/professor/eventos/fetch_events.php`,u=`${c.baseUrl}/calendarioFiles/professor/tarefas/fetch_tasks.php`,m=`${c.baseUrl}/calendarioFiles/professor/tarefas/delete_task.php`,x=`${c.baseUrl}/calendarioFiles/professor/eventos/delete_event.php`,y=`${c.baseUrl}/calendarioFiles/professor/tarefas/update_task.php`,C=`${c.baseUrl}/calendarioFiles/professor/eventos/update_event.php`,v=`${c.baseUrl}/calendarioFiles/professor/fetch_turmas.php`,[w,k]=(0,r.useState)({email:"",aluno_id:null}),[F,P]=(0,r.useState)("light"),[z,R]=(0,r.useState)(null),[E,V]=(0,r.useState)(t.dark?"dark":"light"),[H,$]=(0,r.useState)(!0),[L,U]=(0,r.useState)([]),[G,J]=(0,r.useState)([]),[Y,Z]=(0,r.useState)(!1),[Q,K]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(null),[ae,le]=(0,r.useState)(!1),[ne,se]=(0,r.useState)(!1),[ie,de]=(0,r.useState)(!1),[ce,ue]=(0,r.useState)(null),[fe,me]=(0,r.useState)(!1),[ge,he]=(0,r.useState)(!1),[pe,xe]=(0,r.useState)(""),[ye,be]=(0,r.useState)(""),[je,Ce]=(0,r.useState)(new Date),[ve,we]=(0,r.useState)(new Date),[Se,Te]=(0,r.useState)(new Date),[ke,Fe]=(0,r.useState)("#47AD4D"),[De,Be]=(0,r.useState)(!1),[Ie,Pe]=(0,r.useState)(!1),[Ae,ze]=(0,r.useState)("date"),[Re,Ee]=(0,r.useState)(null),[Oe,Ve]=(0,r.useState)([]),[_e,We]=(0,r.useState)(null),[He,$e]=(0,r.useState)(null),[Le,Ne]=((0,r.useRef)(null),(0,r.useState)(!1)),[Me,Ue]=(0,r.useState)(null);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),R(e),V("dark"===t?"dark":"light")}catch{}finally{$(!1)}}()}),[]),(0,r.useEffect)((()=>{ce&&(xe(ce.title),be(ce.descricao||""),"task"===ce.type&&ce.data_da_tarefa&&Ce(new Date(ce.data_da_tarefa.replace(" ","T"))),"event"===ce.type&&(we(new Date(ce.start)),Te(new Date(ce.end))),ce.color&&Fe(ce.color),ce.turma_id&&We(ce.turma_id))}),[ce]),(0,r.useEffect)((()=>{o.params?.email&&(k((e=>Object.assign({},e,{email:o.params.email}))),Ye(o.params.email),Je(o.params.email))}),[o.params?.email]),(0,r.useEffect)((()=>{P(E)}),[E]);const qe=(0,r.useCallback)((()=>{B.default.post(v,{email:w.email}).then((e=>{e.data.success&&Ve(e.data.turmas)})).catch((e=>console.log("",e)))}),[v,w.email]);(0,r.useEffect)((()=>{qe()}),[qe]);const Ge=()=>{"task"===ce?.type?ce&&ce.id&&B.default.post(m,{tarefa_id:ce.id,email:w.email}).then((e=>{e.data.success?(U((e=>e.filter((e=>e.id!==ce.id)))),J((e=>e.filter((e=>e.id!==ce.id)))),me(!1),ue(null),O.default.alert("Tarefa apagada com sucesso.")):O.default.alert("Erro",e.data.message)})).catch((e=>{O.default.alert("Erro ao apagar a tarefa.")})):"event"===ce?.type&&ce&&ce.id&&B.default.post(x,{event_id:ce.id,email:w.email}).then((e=>{e.data.success?(U((e=>e.filter((e=>e.id!==ce.id)))),me(!1),ue(null),O.default.alert("Evento apagado com sucesso.")):O.default.alert("Erro",e.data.message)})).catch((e=>{O.default.alert("Erro ao apagar o evento.")}))},Je=(0,r.useCallback)((e=>{e&&B.default.post(d,{email:e}).then((e=>{if(Array.isArray(e.data)){const t=e.data.map((e=>{const t=new Date(e.start_datetime.replace(" ","T")),a=new Date(e.end_datetime.replace(" ","T"));return{id:e.id||`${e.start_datetime}-${e.title}`,title:e.title,start:t,end:a,color:e.color||"#47AD4D",type:"event",descricao:e.descricao,turma_id:e.turma_id}}));U(t)}})).catch((()=>{}))}),[]),Ye=e=>{e&&B.default.post(u,{email:e}).then((e=>{e.data.success&&Array.isArray(e.data.tasks)?J(e.data.tasks):J([])})).catch((e=>{}))},Ze=e=>{ue(e),he(!1),me(!0)},Qe=[...L,...G.map((e=>{const t=new Date(e.data_da_tarefa.replace(" ","T"));let a,o;return t.getMinutes()<30?(a=t,o=new Date(t.getTime()+18e5)):(a=new Date(t.getTime()-18e5),o=t),{id:e.id.toString(),title:e.titulo,start:a,end:o,color:e.cores,type:"task",descricao:e.descricao,data_da_tarefa:e.data_da_tarefa,turma_id:e.turma_id}}))],Ke=(Qe.filter((e=>!!X&&e.start.toDateString()===X.toDateString())),()=>{if(!ce)return;const e=new FormData;"task"===ce.type?(e.append("tarefa_id",ce.id),e.append("email",w.email),e.append("titulo",pe),e.append("color",ke),e.append("descricao",ye),e.append("data_da_tarefa",Xe(je)),e.append("turma_id",String(_e))):(e.append("event_id",ce.id),e.append("email",w.email),e.append("title",pe),e.append("descricao",ye),e.append("start_datetime",Xe(ve)),e.append("end_datetime",Xe(Se)),e.append("turma_id",String(_e)),He&&e.append("file",{uri:He.uri,name:He.name,type:He.type||"application/octet-stream"}));const t="task"===ce.type?y:C;B.default.post(t,e,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{e.data.success?(O.default.alert("task"===ce.type?"Tarefa atualizada.":"Evento atualizado.","Agora os alunos as altera\xe7\xf5es feitas agora por si. "),he(!1),de(!1),"task"===ce.type?(Ye(w.email),Je(w.email)):Je(w.email),me(!1)):O.default.alert("Erro",e.data.message)})).catch((()=>{O.default.alert("problemas","Ocorreu um erro enquanto o tentavamso conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}))}),Xe=e=>{const t=e=>e<10?"0"+e:e;return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+" "+t(e.getHours())+":"+t(e.getMinutes())},et="dark"===E?"#e0dede":"#000";if(H)return(0,I.jsxs)(h.default,{source:z?{uri:z}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===E&&(0,I.jsx)(n.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1}}),(0,I.jsxs)(n.default,{style:{alignItems:"center"},children:[(0,I.jsx)(l.default,{size:"large",color:et}),(0,I.jsx)(W.default,{style:{fontSize:18,marginTop:10,color:et},children:"A Carregar os registros..."})]})]});const tt="dark"===F?"#222":t.colors.surface;return(0,I.jsxs)(h.default,{source:z?{uri:z}:a(8922),style:re.background,children:["dark"===F&&(0,I.jsx)(n.default,{style:re.overlay}),(0,I.jsx)(p.default,{backgroundColor:"transparent",translucent:!0,barStyle:"dark"===F?"light-content":"dark-content"}),(0,I.jsxs)(_.default,{style:re.safeContainer,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>Z(!0),children:(0,I.jsx)(g.default,{source:a(6181),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===E?"#FFFFFF":"#000"}})}),(0,I.jsxs)(n.default,{style:{flexDirection:"row",alignItems:"center"},children:[(0,I.jsx)(b.default,{onPress:()=>e.navigate("PersonalizarTarefaProf",{email:w.email}),style:{marginRight:20},children:(0,I.jsx)(g.default,{source:a(5673),style:{width:30,height:30,tintColor:"dark"===E?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>K(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===E?"#FFFFFF":"#000"}})})]})]}),(0,I.jsxs)(f.default,{style:re.container,contentContainerStyle:{paddingBottom:100},refreshControl:(0,I.jsx)(N.default,{refreshing:ae,onRefresh:()=>{le(!0),w.email&&(Je(w.email),Ye(w.email)),setTimeout((()=>le(!1)),1e3)}}),children:[(0,I.jsx)(n.default,{style:re.calendarBox,children:(0,I.jsx)(q.Calendar,{events:Qe,height:.8*i,mode:"month",swipeEnabled:!0,weekStartsOn:1,showTime:!1,onPressCell:e=>{ee(e)},onPressEvent:Ze,eventCellStyle:e=>e.color?{backgroundColor:e.color}:{}})}),X&&(0,I.jsxs)(n.default,{style:{padding:10},children:[(0,I.jsxs)(W.default,{style:re.dayHeader,children:["Eventos e tarefas de ",X.toLocaleDateString()]}),(0,I.jsxs)(f.default,{style:{maxHeight:200},children:[Qe.filter((e=>e.start.toDateString()===X.toDateString())).sort(((e,t)=>e.start.getTime()-t.start.getTime())).map((e=>(0,I.jsxs)(b.default,{style:[re.eventItem,{backgroundColor:e.color}],onPress:()=>Ze(e),children:[(0,I.jsx)(W.default,{style:re.eventTitle,children:e.title}),(0,I.jsxs)(W.default,{style:re.eventTime,children:[e.start.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," \u2013 ",e.end.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]},e.id))),0===Qe.filter((e=>e.start.toDateString()===X.toDateString())).length&&(0,I.jsx)(W.default,{style:re.noEventsText,children:"Nenhum evento ou tarefa neste dia."})]})]}),(0,I.jsx)(b.default,{onPress:()=>e.navigate("AddEventsScreenWeb",{email:w.email}),style:[re.plusButtonContainer,{backgroundColor:"dark"===E?"#FFF":"#000"}],children:(0,I.jsx)(g.default,{source:a(2026),style:[re.plusIcon,{tintColor:"dark"===E?"#000":"#FFF"}]})})]}),(()=>{if(!ce)return null;const e=re.modalBg,t=re.webModalBox;return(0,I.jsx)(D.default,{visible:fe,animationType:"slide",transparent:!0,children:(0,I.jsxs)(h.default,{source:z?{uri:z}:a(8922),style:e,children:[(0,I.jsxs)(n.default,{style:re.header,children:[(0,I.jsx)(b.default,{onPress:()=>{ue(null),me(!1),he(!1)},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:[re.backIcon,{tintColor:et}]})}),(0,I.jsx)(b.default,{onPress:()=>K(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:[re.userIcon,{tintColor:et}]})})]}),(0,I.jsx)(n.default,{style:t,children:(0,I.jsxs)(f.default,{contentContainerStyle:re.configModalContainer,children:[(0,I.jsx)(W.default,{style:re.warningText,children:"task"===ce.type?ge?"Editar tarefa":"Visualiza\xe7\xe3o da tarefa":ge?"Editar evento":"Visualiza\xe7\xe3o do evento"}),ge?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"T\xedtulo"}),(0,I.jsx)(S.default,{mode:"outlined",value:pe,onChangeText:xe,style:re.input}),"task"===ce.type?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Data"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"date",value:je.toISOString().slice(0,10),onChange:e=>{const[t,a,o]=e.target.value.split("-"),r=new Date(je);r.setFullYear(+t,+a-1,+o),Ce(r)}})}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Hora"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"time",value:Xe(je).slice(11),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(je);o.setHours(+t,+a),Ce(o)}})})]}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Descri\xe7\xe3o"}),(0,I.jsx)(S.default,{mode:"outlined",value:ye,onChangeText:be,multiline:!0,style:[re.input,{minHeight:60}]})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Data In\xedcio"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"date",value:ve.toISOString().slice(0,10),onChange:e=>{const[t,a,o]=e.target.value.split("-"),r=new Date(ve);r.setFullYear(+t,+a-1,+o),we(r)}})}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Hora In\xedcio"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"time",value:Xe(ve).slice(11),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(ve);o.setHours(+t,+a),we(o)}})}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Data Fim"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"date",value:Se.toISOString().slice(0,10),onChange:e=>{const[t,a,o]=e.target.value.split("-"),r=new Date(Se);r.setFullYear(+t,+a-1,+o),Te(r)}})}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Hora Fim"}),(0,I.jsx)(W.default,{style:re.webInput,children:(0,I.jsx)("input",{type:"time",value:Xe(Se).slice(11),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(Se);o.setHours(+t,+a),Te(o)}})})]}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Descri\xe7\xe3o"}),(0,I.jsx)(S.default,{mode:"outlined",value:ye,onChangeText:be,style:re.input})]}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Turma / Ano"}),(0,I.jsx)(n.default,{style:[re.inputContainer],children:(0,I.jsx)(te.Picker,{selectedValue:_e,onValueChange:e=>We(e),children:Oe.map((e=>(0,I.jsx)(te.Picker.Item,{label:`Turma ${e.turma} (Ano ${e.ano})`,value:e.id},e.id)))})}),(0,I.jsx)(W.default,{style:[re.label,{color:et}],children:"Cor"}),(0,I.jsxs)(b.default,{onPress:()=>Be(!0),style:re.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[re.colorCircle,{backgroundColor:ke}]}),(0,I.jsx)(W.default,{style:{color:et},children:"Clique para alterar cor"})]}),(0,I.jsxs)(n.default,{style:re.buttonsRow,children:[(0,I.jsx)(T.default,{mode:"contained",onPress:Ke,style:re.saveButtonSmall,children:"Salvar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:Ge,style:re.deleteButtonSmall,children:"Apagar"})]}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>he(!1),labelStyle:{color:"#47AD4D"},children:"Cancelar"})]}):(0,I.jsxs)(n.default,{style:re.summaryContainer,children:[(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:ce.title})]}),"task"===ce.type?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:ce.descricao||"\u2014"})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Data/Hora:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:ce.data_da_tarefa})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Turma/Ano:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:Oe.find((e=>e.id===ce.turma_id))?`Turma ${Oe.find((e=>e.id===ce.turma_id)).turma} (Ano ${Oe.find((e=>e.id===ce.turma_id)).ano})`:"\u2014"})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Cor:"}),(0,I.jsx)(n.default,{style:[re.colorCircle,{backgroundColor:ce.color||"#000"}]})]})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"In\xedcio:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:new Date(ce.start).toLocaleString()})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Fim:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:new Date(ce.end).toLocaleString()})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:ce.descricao||"\u2014"})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Turma/Ano:"}),(0,I.jsx)(W.default,{style:re.summaryValue,children:Oe.find((e=>e.id===ce.turma_id))?`Turma ${Oe.find((e=>e.id===ce.turma_id)).turma} (Ano ${Oe.find((e=>e.id===ce.turma_id)).ano})`:"\u2014"})]}),(0,I.jsxs)(n.default,{style:re.summaryRow,children:[(0,I.jsx)(W.default,{style:re.summaryLabel,children:"Cor:"}),(0,I.jsx)(n.default,{style:[re.colorCircle,{backgroundColor:ce.color||"#000"}]})]})]}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>he(!0),style:re.editButton,labelStyle:{color:"#47AD4D"},children:"Editar"})]})]})}),!1]})})})(),(0,I.jsx)(D.default,{visible:Y,animationType:"slide",transparent:!0,onRequestClose:()=>Z(!1),children:(0,I.jsx)(b.default,{style:re.menuOverlay,activeOpacity:1,onPressOut:()=>Z(!1),children:(0,I.jsxs)(n.default,{style:[re.menuContent,{backgroundColor:tt}],children:[(0,I.jsx)(W.default,{style:[re.menuTitle,{color:et}],children:"Menu"}),(0,I.jsxs)(b.default,{onPress:()=>e.navigate("alunosDoProfScreen",{email:w.email}),style:[re.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[re.menuText,{color:et}],children:"Alunos que dou aulas"})]}),(0,I.jsxs)(b.default,{onPress:()=>e.navigate("AdicionarNotas",{email:w.email}),style:[re.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[re.menuText,{color:et}],children:"Atribuir notas"})]}),(0,I.jsxs)(b.default,{onPress:()=>e.navigate("almocoProfScreen",{email:w.email}),style:[re.menuLink,{flexDirection:"row",alignItems:"center"}],children:[!1,(0,I.jsx)(W.default,{style:[re.menuText,{color:et}],children:"Marcar almo\xe7o"})]}),!1]})})}),(0,I.jsx)(A,{visible:Q,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>K(!1),navigation:e,email:w.email}),(0,I.jsx)(D.default,{visible:De,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:re.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:re.colorModalContainer,children:[(0,I.jsx)(W.default,{style:[re.modalTitle,{color:et}],children:"Selecionar Cor"}),!oe.find((e=>e.value===ke))&&(0,I.jsxs)(b.default,{style:re.colorOptionRow,onPress:()=>{Fe(ke),Be(!1)},children:[(0,I.jsx)(n.default,{style:[re.colorCircle,{backgroundColor:ke}]}),(0,I.jsx)(W.default,{style:[re.colorName,{color:et}],children:"Cor Atual"})]}),oe.map((e=>(0,I.jsxs)(b.default,{style:re.colorOptionRow,onPress:()=>{Fe(e.value),Be(!1)},children:[(0,I.jsx)(n.default,{style:[re.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{style:[re.colorName,{color:et}],children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>Be(!1),style:re.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:Le,transparent:!0,animationType:"slide",children:(0,I.jsx)(n.default,{style:re.previewOverlay,children:(0,I.jsxs)(n.default,{style:re.previewContainer,children:[Me?.uri.match(/\.(jpg|jpeg|png|gif)$/i)?(0,I.jsx)(g.default,{source:{uri:Me.uri},style:re.previewImage,resizeMode:"contain"}):(0,I.jsx)(W.default,{style:re.previewText,children:Me?.name}),(0,I.jsxs)(n.default,{style:re.previewButtons,children:[(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>{$e(null),Ue(null),Ne(!1)},children:"Cancelar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{Ne(!1)},children:"Escolher"})]})]})})})]})]})};var ne=a(838),se=a(4454);const ie=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,justifyContent:"center",alignItems:"center",width:"100%",padding:16},box:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,alignItems:"center"},headerRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%",marginBottom:16},title:{fontWeight:"bold",color:"#000"},infoIcon:{width:20,height:20,resizeMode:"contain"},input:{width:"100%"},loginButton:{width:"100%",marginTop:10,backgroundColor:"#47AD4D"},signInButton:{width:"100%",marginTop:8,borderColor:"#47AD4D"},link:{textAlign:"center",marginTop:8},loaderContainer:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",alignItems:"center"},iconStyle:{width:24,height:24,resizeMode:"contain"},webDialog:{marginHorizontal:20},webScroll:{maxHeight:200}}),de=()=>{const e=(0,s.useNavigation)(),t=`${c.baseUrl}/loginFiles/checkEmail.php`,o=`${c.baseUrl}/loginFiles/sendVerificationCode.php`,[i,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(""),[x]=(0,r.useState)("web"),[y,j]=(0,r.useState)(!1),[C,F]=(0,r.useState)(""),[D,P]=(0,r.useState)(""),[A,z]=(0,r.useState)(!0),[R,E]=(0,r.useState)(!1),O=()=>j(!y),V=e=>{F(e),P(""),alert(e)},_=a(8922),H=a(2074);return(0,r.useEffect)((()=>{const e=setTimeout((()=>{z(!1)}),1500);return()=>clearTimeout(e)}),[]),A?(0,I.jsx)(h.default,{source:_,style:ie.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:_,style:ie.background,children:[(0,I.jsx)(p.default,{barStyle:"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsx)(ne.default,{behavior:"padding",style:ie.container,children:(0,I.jsxs)(n.default,{style:[ie.box,{backgroundColor:"#FFFFFF"}],children:[(0,I.jsxs)(n.default,{style:ie.headerRow,children:[(0,I.jsx)(W.default,{variant:"headlineMedium",style:ie.title,children:"Iniciar sess\xe3o"}),(0,I.jsx)(b.default,{onPress:()=>E(!0),children:(0,I.jsx)(g.default,{source:H,style:ie.infoIcon})})]}),(0,I.jsx)(S.default,{label:"Email",value:i,onChangeText:d,keyboardType:"email-address",mode:"outlined",style:ie.input,placeholderTextColor:"rgba(0,0,0,0.6)",theme:{colors:{primary:"#47AD4D",background:"#fff",text:"#000"}}}),(0,I.jsx)(S.default,{label:"Palavra-passe",value:u,onChangeText:m,secureTextEntry:!y,mode:"outlined",style:[ie.input,{marginTop:10}],placeholderTextColor:"rgba(0,0,0,0.6)",theme:{colors:{primary:"#47AD4D",background:"#fff",text:"#000"}},right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(b.default,{onPress:O,children:(0,I.jsx)(g.default,{source:a(y?6751:7051),style:ie.iconStyle})})})}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(F(""),P(""),i)if(i.endsWith("@etps.com.pt")){z(!0);try{if(u){const a=(await B.default.post(t,{email:i,password:u,deviceType:x},{headers:{"Content-Type":"application/json"}})).data;if(a.success)switch(localStorage.setItem("userToken",a.token),localStorage.setItem("email",a.email),localStorage.setItem("userRole",a.cargoUtilizador),a.cargoUtilizador){case"aluno":e.navigate("Aluno",{email:a.email});break;case"professor":e.navigate("Professor",{email:a.email});break;case"admin":e.navigate("Administrador",{email:a.email});break;case"auxiliar":e.navigate("auxiliarScreen",{email:a.email})}else"pendente"===a.estado?V("Esta conta est\xe1 pendente, para a ativar insira o c\xf3digo que enviamos para o seu email."):V(a.message||"Verifique se a palavra-passe est\xe1 correta ou tente criar uma conta.")}else{const t=(await B.default.post(o,{email:i},{headers:{"Content-Type":"application/json"}})).data;t.success?e.navigate("VerificationScreen",{email:i}):V(t.message||"N\xe3o conseguimos enviar o c\xf3digo de verifica\xe7\xe3o. O que pode indicar que j\xe1 tenha uma palavra-passe.")}}catch{V("Houve um problema da nossa parte, pedimos que tente novamente mais tarde.")}finally{z(!1)}}else V("Pedimos que insira o seu email da escola.");else V("Por favor, pedimos que preencha pelo menos o seu email.")},style:ie.loginButton,labelStyle:{color:"#fff"},children:"Iniciar sess\xe3o"}),C?(0,I.jsx)(se.default,{type:"error",visible:!0,style:{color:"#B00020"},children:C}):null,D?(0,I.jsx)(se.default,{type:"info",visible:!0,style:{color:"#B00020"},children:D}):null,(0,I.jsx)(T.default,{mode:"text",onPress:()=>e.navigate("ForgetPasswordScreen"),labelStyle:{color:"#47AD4D"},style:ie.link,children:"Esqueci-me da palavra-passe"}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>e.navigate("SignIn"),style:ie.signInButton,labelStyle:{color:"#47AD4D"},children:"Criar uma conta"})]})}),(0,I.jsx)(v.default,{children:(0,I.jsxs)(w.default,{visible:R,onDismiss:()=>E(!1),style:[{backgroundColor:"#fff"},ie.webDialog],children:[(0,I.jsx)(w.default.Title,{children:"O que podes fazer aqui?"}),(0,I.jsx)(w.default.Content,{children:(0,I.jsxs)(f.default,{style:ie.webScroll,children:[(0,I.jsx)(k.default,{children:"Aqui podes:"}),(0,I.jsx)(k.default,{children:"\u2022 Iniciar sess\xe3o utilizando o teu email da escola (@etps.com.pt) e a palavra\u2011passe que est\xe1 associada."}),(0,I.jsx)(k.default,{children:"\u2022 Recuperar a palavra\u2011passe em \u201cEsqueci\u2011me da palavra\u2011passe\u201d."}),(0,I.jsx)(k.default,{children:"\u2022 Criar uma nova conta em \u201cCriar uma conta\u201d."})]})}),(0,I.jsx)(w.default.Actions,{children:(0,I.jsx)(T.default,{onPress:()=>E(!1),labelStyle:{color:"#47AD4D"},children:"OK"})})]})})]})};const ce=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,justifyContent:"center",alignItems:"center",width:"100%",padding:16},box:{backgroundColor:"white",borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},title:{marginBottom:16,fontWeight:"bold",textAlign:"center",color:"#333"},input:{width:"100%",marginBottom:16,backgroundColor:"white"},saveButton:{width:"100%",marginTop:10,backgroundColor:"#47AD4D"},toastContainer:{position:"absolute",top:16,left:16,right:16,alignItems:"center",zIndex:10},toastBox:{backgroundColor:"#47AD4D",borderRadius:24,paddingVertical:12,paddingHorizontal:24,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:4},toastText:{color:"#FFF",fontSize:14,textAlign:"center"}}),ue=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o,initialMessage:i=""}=t.params,d=`${c.baseUrl}/signInFiles/saveUserPassword.php`,[u,f]=(0,r.useState)(""),[m,p]=(0,r.useState)(""),[x,y]=(0,r.useState)(null),[b,j]=(0,r.useState)(null),[C,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),[F,D]=(0,r.useState)(!1);(0,r.useEffect)((()=>{i&&(j(i),setTimeout((()=>j(null)),2e3))}),[i]);return C?(0,I.jsx)(h.default,{source:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsx)(h.default,{source:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsxs)(ne.default,{behavior:"padding",style:ce.container,children:[b&&(0,I.jsx)(n.default,{style:ce.toastContainer,children:(0,I.jsx)(n.default,{style:ce.toastBox,children:(0,I.jsx)(W.default,{style:ce.toastText,children:b})})}),(0,I.jsxs)(n.default,{style:ce.box,children:[(0,I.jsx)(W.default,{variant:"headlineMedium",style:ce.title,children:"Pedimos que defina uma Palavra-passe"}),x&&(0,I.jsx)(se.default,{type:"error",children:x}),(0,I.jsx)(S.default,{label:"Palavra-passe",secureTextEntry:!w,style:ce.input,value:u,onChangeText:f,mode:"outlined",outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D",right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(g.default,{source:a(w?6751:7051),style:{width:24,height:24}}),onPress:()=>k(!w)})}),(0,I.jsx)(S.default,{label:"Confirmar a palavra-passe",secureTextEntry:!F,style:ce.input,value:m,onChangeText:p,mode:"outlined",outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D",right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(g.default,{source:a(F?6751:7051),style:{width:24,height:24}}),onPress:()=>D(!F)})}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(u&&m)if(u===m)if(u.length<6)y("A Palavra-passe deve ter pelo menos 6 caracteres.");else{v(!0),y(null),j(null);try{const t=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:u})}),a=await t.json();if(a.success){const t=a.message||"A palavra\u2011passe foi associada \xe0 sua conta com sucesso!";window.alert(t),e.navigate("SelectTurma",{email:o,initialMessage:t})}else y(a.message||"Ocorreu um erro enquanto tentavamos guardar a palavra-passe. Pedimos que tente novamente mais tarde."),window.alert(a.message||"Erro ao guardar a palavra-passe.")}catch(x){y("N\xe3o foi poss\xedvel conectar-se ao servidor. Tente novamente mais tarde."),window.alert("N\xe3o foi poss\xedvel conectar-se ao servidor.")}finally{v(!1)}}else y("As Palavra-passe n\xe3o coincidem.");else y("Por favor, pedimos que preencha todos os campos.")},style:ce.saveButton,children:"Guardar Palavra-passe"})]})]})})};const fe=m.default.create({bg:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,width:"100%",padding:16,justifyContent:"center",alignItems:"center"},box:{position:"relative",borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},infoIcon:{position:"absolute",top:-10,right:-175,width:24,height:24},title:{marginBottom:16,fontWeight:"bold",color:"#333"},input:{backgroundColor:"#fff",width:"100%",marginBottom:10},registrarButton:{width:"100%",marginBottom:8,backgroundColor:"#47AD4D"},link:{textAlign:"center",marginTop:8},successText:{color:"green"},errorText:{color:"red"},webDialog:{left:"35%",width:"80%",maxWidth:400},webScroll:{maxHeight:200}}),me=()=>{const e=(0,s.useNavigation)(),t=`${c.baseUrl}/signInFiles/sendEmail.php`,[o,i]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[y,j]=(0,r.useState)(!1),[C,F]=(0,r.useState)(!1);return y?(0,I.jsx)(h.default,{source:a(8922),style:fe.bg,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:a(8922),style:fe.bg,children:[(0,I.jsx)(p.default,{barStyle:"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsx)(ne.default,{behavior:"padding",style:fe.container,children:(0,I.jsxs)(n.default,{style:fe.box,children:[(0,I.jsx)(b.default,{onPress:()=>F(!0),children:(0,I.jsx)(g.default,{source:a(2074),style:fe.infoIcon})}),(0,I.jsx)(W.default,{variant:"headlineMedium",style:fe.title,children:"Criar uma conta"}),d?(0,I.jsx)(se.default,{type:"error",visible:!0,style:fe.errorText,children:d}):null,m?(0,I.jsx)(se.default,{type:"info",visible:!0,style:fe.successText,children:m}):null,(0,I.jsx)(S.default,{label:"Email",value:o,onChangeText:i,keyboardType:"email-address",mode:"outlined",style:fe.input,outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D"}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(u(""),x(""),o)if(o.includes("@etps.com.pt"))if(o.length<6)u("Para a sua seguran\xe7a pedimos, insira um email com mais de 6 caracteres.");else{j(!0);try{const a=(await B.default.post(t,{email:o},{headers:{"Content-Type":"application/json"}})).data;if(a.success){const t="Enviamos um c\xf3digo de 6 digitos para o seu email, por isso, para ativar a conta insira-o no campo abaixo!";x(t),setTimeout((()=>x("")),5e3),e.navigate("VerifyCode",{email:o,initialMessage:t})}else u(a.message||"Ocorreu um erro da nossa parte, pedimos que tente criar uma conta novamente mais tarde."),"O email j\xe1 existe."===a.message&&(u("O seu email j\xe1 existe na nossa base de dados! Por isso pedimos que inicie sess\xe3o."),u("O seu email j\xe1 existe na nossa base de dados! Por isso pedimos que inicie sess\xe3o."),setTimeout((()=>u("")),5e3),e.navigate("Login"))}catch{u("Ocorreu um problem nos nossos servidores enquanto tentavamos criar uma conta para si. Pedimos que tente novamente mais tarde.")}finally{j(!1)}}else u("Pedimos insira o seu email da escola.");else u("Pedimos que coloque o seu email no campo.")},style:fe.registrarButton,labelStyle:{color:"#fff"},children:"Enviar email"}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>e.navigate("Login"),style:fe.link,labelStyle:{color:"#47AD4D"},children:"J\xe1 tem conta? Iniciar sess\xe3o"})]})}),(0,I.jsx)(v.default,{children:(0,I.jsxs)(w.default,{visible:C,onDismiss:()=>F(!1),style:fe.webDialog,children:[(0,I.jsx)(w.default.Title,{children:"O que pode fazer aqui?"}),(0,I.jsx)(w.default.Content,{children:(0,I.jsxs)(f.default,{style:fe.webScroll,children:[(0,I.jsx)(k.default,{children:"Aqui pode:"}),(0,I.jsx)(k.default,{children:"\u2022 Criar uma conta de aluno que ficar\xe1 pendente de aprova\xe7\xe3o de um administrador."}),(0,I.jsx)(k.default,{children:"\u2022 Ter uma conta com o seu email da escola, colocando a sua palavra-passe e colocando a sua turma, tendo em conta que ficar\xe1 autom\xe1ticamente como 10\xba e a turma que escolher."})]})}),(0,I.jsx)(w.default.Actions,{children:(0,I.jsx)(T.default,{onPress:()=>F(!1),children:"OK"})})]})})]})};const ge=m.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",width:"100%",padding:16},box:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},title:{marginBottom:16,fontWeight:"bold",color:"#333"},input:{width:"100%",marginBottom:16,backgroundColor:"white"},verifyButton:{width:"100%",marginBottom:16,backgroundColor:"#47AD4D"},link:{textAlign:"center",marginTop:8},errorText:{color:"red"},toastContainer:{position:"absolute",top:16,left:16,right:16,alignItems:"center",zIndex:10},toastBox:{backgroundColor:"#47AD4D",borderRadius:24,paddingVertical:12,paddingHorizontal:24,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:4},toastText:{color:"#FFF",fontSize:14,textAlign:"center"}}),he=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o,initialMessage:i=""}=t.params,d=`${c.baseUrl}/signInFiles/validateCode.php`,u=`${c.baseUrl}/signInFiles/sendEmail.php`,[f,m]=(0,r.useState)({email:"",code:""}),[g,p]=(0,r.useState)(""),[x,y]=(0,r.useState)(""),[b,j]=(0,r.useState)(!1),[C,v]=(0,r.useState)(0);(0,r.useEffect)((()=>{i&&(y(i),setTimeout((()=>y("")),2e3))}),[i]),(0,r.useEffect)((()=>{let e;return C>0&&(e=setInterval((()=>{v((t=>t<=1?(clearInterval(e),0):t-1))}),1e3)),()=>clearInterval(e)}),[C]);return b?(0,I.jsx)(h.default,{source:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsx)(h.default,{source:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsxs)(ne.default,{behavior:"padding",style:ge.container,children:[""!==x&&(0,I.jsx)(n.default,{style:ge.toastContainer,children:(0,I.jsx)(n.default,{style:ge.toastBox,children:(0,I.jsx)(W.default,{style:ge.toastText,children:x})})}),(0,I.jsxs)(n.default,{style:ge.box,children:[(0,I.jsx)(W.default,{variant:"headlineMedium",style:ge.title,children:"Insira o c\xf3digo"}),g?(0,I.jsx)(n.default,{style:{alignItems:"center"},children:(0,I.jsx)(se.default,{type:"error",visible:!!g,style:ge.errorText,children:g})}):null,(0,I.jsx)(S.default,{label:"C\xf3digo",value:f.code,onChangeText:e=>{return t="code",a=e,void m(Object.assign({},f,{[t]:a}));var t,a},mode:"outlined",style:ge.input,keyboardType:"number-pad",outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D"}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(f.code){j(!0);try{const t=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,code:f.code})}),a=await t.json();if(a.success){const t="O c\xf3digo que inseriu foi verificado com sucesso, pedimos que coloque uma palavra\u2011passe!";e.navigate("PutPassword",{email:o,initialMessage:t})}else p(a.message||"Ocorreu um erro da nossa parte ao tentar validar o c\xf3digo que voc\xea introduziu, pedimos que tente novamente mais tarde.")}catch{p("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{j(!1)}}else p("Pedimos-lhe que insira o c\xf3digo que foi mandado para o seu email.")},style:ge.verifyButton,labelStyle:{color:"#fff"},children:"Verificar C\xf3digo"}),(0,I.jsx)(T.default,{mode:"text",onPress:async()=>{if(!(C>0)){v(60),j(!0);try{const e=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f.email})}),t=await e.json();if(t.success){const e=t.message||`C\xf3digo enviado novamente para ${f.email} com sucesso.`;y(e),setTimeout((()=>{y("")}),5e3)}else p(t.message||"Ocorreu um erro da nossa parte ao tentar enviar o c\xf3digo para o seu email. Pedimos que tente novamente mais tarde.")}catch(e){p("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{j(!1)}}},disabled:C>0,style:ge.link,labelStyle:{color:"#47AD4D"},children:C>0?`Reenviar o c\xf3digo (${C} segundos)`:"Reenviar o c\xf3digo"})]})]})})};a(5173),a(4443);const pe=m.default.create({background:{flex:1,width:"100%",height:"100%",justifyContent:"center",alignItems:"center"},overlay:{flex:1,width:"100%",backgroundColor:"rgba(0, 0, 0, 0.3)",justifyContent:"center",alignItems:"center"}});function xe({source:e,children:t}){return(0,I.jsx)(h.default,{source:e,style:pe.background,children:(0,I.jsx)(n.default,{style:pe.overlay,children:t})})}var ye=a(5448);const be=m.default.create({container:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:10},label:{fontSize:16}}),je=({onToggle:e,currentTheme:t})=>{const a="light"===t?"#000":"#FFF",o="light"===t?{false:"#000",true:"#000"}:{false:"#FFF",true:"#FFF"};return(0,I.jsxs)(n.default,{style:be.container,children:[(0,I.jsx)(u.default,{style:[be.label,{color:a}],children:"Mudar entre modo escuro e claro"}),(0,I.jsx)(ye.default,{value:"dark"===t,onValueChange:e,thumbColor:"#CCC",trackColor:o})]})};a(8282),a(7725);m.default.create({overlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modal:{backgroundColor:"#fff",width:"90%",borderRadius:10,padding:20,alignItems:"center"},title:{fontSize:22,fontWeight:"bold",marginBottom:10},subtitle:{fontSize:16,marginVertical:10},thumbnailsContainer:{justifyContent:"center",alignItems:"center"},thumbnailWrapper:{marginHorizontal:5,borderRadius:5,borderWidth:2,borderColor:"transparent"},selectedWrapper:{borderColor:"#007bff"},thumbnail:{width:60,height:100,resizeMode:"cover"},previewContainer:{alignItems:"center",marginVertical:10},previewText:{fontSize:16,fontWeight:"bold",marginBottom:5},previewImage:{width:200,height:350,resizeMode:"cover",borderRadius:10},buttonRow:{flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:20}}),a(8922),a(8821),a(952),a(747),a(2702);const Ce=async(e,t)=>{localStorage.setItem(e,t)},ve=[{path:"bg1.jpg",source:a(8922)},{path:"bg2.jpg",source:a(8821)},{path:"bg3.jpg",source:a(952)},{path:"bg4.jpg",source:a(747)},{path:"bg5.jpg",source:a(2702)}],we=m.default.create({darkOverlay:Object.assign({},m.default.absoluteFillObject),backButton:{position:"absolute",top:50,left:20,zIndex:10,padding:8,borderRadius:20},container:{flex:1,justifyContent:"center",alignItems:"center",paddingHorizontal:16},box:{padding:20,borderRadius:15,width:"90%",maxWidth:400,alignItems:"center",justifyContent:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:16,textAlign:"center"},button:{paddingVertical:12,paddingHorizontal:20,borderRadius:8,marginVertical:10,alignItems:"center",justifyContent:"center",width:"100%"},buttonText:{fontSize:16,fontWeight:"bold"},loadingWrapper:{flex:1,justifyContent:"center",alignItems:"center"},loadingContainer:{padding:20,borderRadius:10,alignItems:"center",justifyContent:"center"},loadingDark:{backgroundColor:"rgba(0, 0, 0, 0.5)"},loadingLight:{backgroundColor:"rgba(255, 255, 255, 0.5)"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.6)",justifyContent:"center",alignItems:"center"},modalContent:{width:"90%",maxWidth:500,backgroundColor:"#fff",borderRadius:10,padding:20,alignItems:"center"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:16},defaultImagesContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center",marginBottom:16},defaultImage:{width:80,height:80,margin:5,borderRadius:10},closeButton:{marginTop:10},previewImage:{width:300,height:200,resizeMode:"cover",borderRadius:10,marginBottom:16},previewButtonsContainer:{flexDirection:"row",justifyContent:"space-between",width:"100%"},cancelButton:{flex:1,paddingVertical:10,borderRadius:8,alignItems:"center",marginLeft:5,backgroundColor:"#ff0000"},cancelButtonText:{color:"#fff",fontSize:16,fontWeight:"bold"}}),Se=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o}=t.params,[i,d]=(0,r.useState)("light"),[f,m]=(0,r.useState)(null),[h,p]=(0,r.useState)(!0),[x,y]=(0,r.useState)(!1),[j,C]=(0,r.useState)(null),v=(0,r.useRef)(null),[w,S]=(0,r.useState)(!1),T=`${c.baseUrl}/backgroundFiles/changeBackground.php`,k=`${c.baseUrl}/backgroundFiles/getThemeAndBackground.php`;(0,r.useEffect)((()=>{(async()=>{try{const e=await fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),t=await e.json();if(t.success){const e="dark"===t.tema_user?"dark":"light";d(e),m(t.background_user),await Ce("userTheme",e),await Ce("backgroundUrl",t.background_user)}else console.log("Erro ao buscar personaliza\xe7\xe3o:",t.message)}catch(e){console.log("Erro ao buscar personaliza\xe7\xe3o:",e)}finally{p(!1)}})()}),[]);const F=async(e,t)=>{try{let a=t||"";0;const r=await fetch(T,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,background_user:a,tema_user:e})}),l=await r.json();console.log("Resposta de atualiza\xe7\xe3o:",l),l.success&&(d("dark"===l.tema_user?"dark":"light"),m(l.background_user),await Ce("userTheme",l.tema_user),await Ce("backgroundUrl",l.background_user))}catch(a){console.error("Erro ao atualizar personaliza\xe7\xe3o:",a)}},B=e=>{if(e.target.files&&e.target.files[0]){const t=e.target.files[0],a=new FileReader;a.onloadend=()=>{"string"===typeof a.result&&C(a.result)},a.readAsDataURL(t)}},P=()=>{v.current&&v.current.click()},z=async()=>{if(j){0,(async e=>{m(e),await Ce("backgroundUrl",e),F(i,e)})(j),y(!1),C(null)}},R=()=>{C(null)};if(h){let e;if(f)if(f.startsWith("data:")||f.startsWith("http"))e={uri:f};else{const t=ve.find((e=>`assets/images/${e.path}`===f));e=t?t.source:{uri:`${c.baseUrl}/${f}`}}else e=a(8922);return(0,I.jsx)(xe,{source:e,children:(0,I.jsx)(n.default,{style:we.loadingWrapper,children:(0,I.jsx)(n.default,{style:[we.loadingContainer,"dark"===i?we.loadingDark:we.loadingLight],children:(0,I.jsx)(l.default,{size:"large",color:"dark"===i?"#fff":"#000"})})})})}const E=(()=>{if(!f)return a(8922);if(f.startsWith("data:")||f.startsWith("http"))return{uri:f};const e={"assets/images/bg1.jpg":a(8922),"assets/images/bg2.jpg":a(8821),"assets/images/bg3.jpg":a(952),"assets/images/bg4.jpg":a(747),"assets/images/bg5.jpg":a(2702)};return e[f]?e[f]:{uri:`${c.baseUrl}/${f}`}})(),O="dark"===i?"rgba(0, 0, 0, 0.5)":"transparent",V="dark"===i?"rgba(0, 0, 0, 0.5)":"#f0f0f0",_="dark"===i?"#fff":"#000",W=[we.button,{backgroundColor:"dark"===i?"#333":"#ccc"}],H=[we.buttonText,{color:"dark"===i?"#fff":"#000"}];return(0,I.jsxs)(xe,{source:E,children:["dark"===i&&(0,I.jsx)(n.default,{style:[we.darkOverlay,{backgroundColor:O}],pointerEvents:"none"}),(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"dark"===i?"rgba(0, 0, 0, 0.5)":"rgba(255, 255, 255, 0.5)"},children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===i?"#fff":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>S(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===i?"#fff":"#000"}})})]}),(0,I.jsx)(n.default,{style:we.container,children:(0,I.jsxs)(n.default,{style:[we.box,{backgroundColor:V}],children:[(0,I.jsx)(u.default,{style:[we.title,{color:_}],children:"Personalize"}),(0,I.jsx)(je,{onToggle:()=>{(async e=>{d(e),await Ce("userTheme",e),F(e,f)})("dark"===i?"light":"dark")},currentTheme:i}),(0,I.jsx)(b.default,{style:W,onPress:()=>{y(!0),C(null)},children:(0,I.jsx)(u.default,{style:H,children:"Mudar Background"})})]})}),(0,I.jsx)(D.default,{visible:x,transparent:!0,animationType:"fade",onRequestClose:()=>{y(!1),C(null)},children:(0,I.jsx)(n.default,{style:we.modalOverlay,children:(0,I.jsx)(n.default,{style:we.modalContent,children:j?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[we.modalTitle,{color:_}],children:"Preview do Background"}),j.startsWith("assets/")?(0,I.jsx)(g.default,{source:ve.find((e=>`assets/images/${e.path}`===j))?.source,style:we.previewImage}):(0,I.jsx)(g.default,{source:{uri:j},style:we.previewImage}),(0,I.jsxs)(n.default,{style:we.previewButtonsContainer,children:[(0,I.jsx)(b.default,{style:W,onPress:z,children:(0,I.jsx)(u.default,{style:H,children:"Salvar"})}),(0,I.jsx)(b.default,{style:we.cancelButton,onPress:R,children:(0,I.jsx)(u.default,{style:we.cancelButtonText,children:"Cancelar"})})]})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[we.modalTitle,{color:_}],children:"Escolha um background"}),(0,I.jsx)(n.default,{style:we.defaultImagesContainer,children:ve.map(((e,t)=>(0,I.jsx)(b.default,{onPress:()=>C(`assets/images/${e.path}`),children:(0,I.jsx)(g.default,{source:e.source,style:we.defaultImage})},t)))}),(0,I.jsx)(b.default,{style:W,onPress:P,children:(0,I.jsx)(u.default,{style:H,children:"Selecionar do Computador"})}),(0,I.jsx)("input",{type:"file",accept:"image/*",ref:v,onChange:B,style:{display:"none"}}),(0,I.jsx)(b.default,{style:we.closeButton,onPress:()=>y(!1),children:(0,I.jsx)(u.default,{style:{color:_},children:"Fechar"})})]})})})}),(0,I.jsx)(A,{visible:w,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>S(!1),navigation:e,email:o})]})};var Te=a(1981),ke=a(3079),Fe=a(6325);const De=m.default.create({flexCenter:{flex:1,justifyContent:"center",alignItems:"center"},darkOverlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0, 0, 0, 0.5)"}),headerContainer:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},icon:{marginLeft:3,marginTop:3},box:{backgroundColor:"#FFF",margin:20,borderRadius:15,padding:20,width:"90%",maxWidth:400},subheader:{fontWeight:"bold"}}),Be=()=>{const e=(0,j.useTheme)(),t=(0,s.useNavigation)(),o=(0,s.useRoute)(),{email:i}=o.params,d=`${c.baseUrl}/calendarioFiles/personalData/fetch_user_data.php`,[u,f]=(0,r.useState)(null),[m,p]=(0,r.useState)(!0),[x,y]=(0,r.useState)(null),[C,v]=(0,r.useState)(e.dark?"dark":"light"),[w,S]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{const e=await B.default.get(d,{params:{email:i}});e.data?.success?f(e.data.user):console.log("Erro ao procurar dados do utilizador:",e.data)}catch(e){console.error("Erro na requisi\xe7\xe3o:",e)}finally{p(!1)}})()}),[i]),(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),y(e),v("dark"===t?"dark":"light")}catch(e){console.log("Erro ao carregar configura\xe7\xf5es.",e)}})()}),[]);return m?(0,I.jsxs)(h.default,{source:x?{uri:x}:a(8922),style:De.flexCenter,children:["dark"===C&&(0,I.jsx)(n.default,{style:De.darkOverlay}),(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})]}):(0,I.jsxs)(h.default,{source:x?{uri:x}:a(8922),style:De.flexCenter,children:["dark"===C&&(0,I.jsx)(n.default,{style:De.darkOverlay,pointerEvents:"none"}),(0,I.jsxs)(n.default,{style:De.headerContainer,children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:[De.icon,{tintColor:"dark"===C?"#FFF":"#000",width:35,height:35}]})}),(0,I.jsx)(b.default,{onPress:()=>S(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:[De.icon,{tintColor:"dark"===C?"#FFF":"#000",width:30,height:30}]})})]}),(0,I.jsx)(n.default,{style:De.box,children:(0,I.jsxs)(Te.default,{children:[(0,I.jsx)(ke.default,{title:"Email",description:u.email||"-",left:void 0}),(0,I.jsx)(ke.default,{title:"Cargo",description:u.cargoUtilizador?u.cargoUtilizador.charAt(0).toUpperCase()+u.cargoUtilizador.slice(1):"-",left:void 0}),(0,I.jsx)(ke.default,{title:"Data de Cria\xe7\xe3o",description:u.data_criacao||"-",left:void 0}),"aluno"===u.cargoUtilizador.toLowerCase()&&u.alunoData&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ke.default,{title:"Turma",description:u.alunoData.turma,left:void 0}),(0,I.jsx)(ke.default,{title:"Ano",description:String(u.alunoData.ano),left:void 0})]}),"professor"===u.cargoUtilizador.toLowerCase()&&u.professorData&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(ke.default,{title:"Disciplina",description:u.professorData.disciplina||"-",left:void 0}),(0,I.jsx)(Fe.default,{style:De.subheader,children:"Turmas"}),u.professorData.turmas.map(((e,t)=>(0,I.jsx)(ke.default,{title:`Turma: ${e.turma}`,description:`Ano: ${e.ano}`,left:void 0},t)))]})]})}),(0,I.jsx)(A,{visible:w,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>S(!1),navigation:t,email:i})]})};var Ie=a(6513),Pe=a(1762);const Ae=m.default.create({background:{flex:1},fullScreenContainer:{flex:1,backgroundColor:"transparent"},header:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},icon:{width:35,height:35,marginLeft:3,marginTop:-15},container:{flex:1,paddingHorizontal:16,paddingTop:80},inner:{marginBottom:20},label:{marginBottom:8},input:{minHeight:100,marginBottom:16},button:{alignSelf:"flex-start"},loader:{marginVertical:16},list:{flex:1}}),ze=()=>{const e=(0,j.useTheme)(),t=(0,s.useNavigation)(),o=(0,s.useRoute)(),{email:i}=o.params,[d,u]=(0,r.useState)(null),[f,m]=(0,r.useState)("light"),[x,y]=(0,r.useState)(""),[C,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(""),[F,D]=(0,r.useState)(!1),[P,z]=(0,r.useState)([]),[R,E]=(0,r.useState)(!0),[_,$]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),u(e),m("dark"===t?"dark":"light")}catch{}})()}),[]);const L=async()=>{E(!0);try{const e=await B.default.get(`${c.baseUrl}/calendarioFiles/suggest/fetchUserSuggestion.php`,{params:{email:i}});e.data.success?z(e.data.data):O.default.alert("Erro",e.data.message||"Falha ao carregar sugest\xf5es")}catch(e){console.error(e),O.default.alert("Erro","N\xe3o foi poss\xedvel comunicar com o servidor.")}finally{E(!1)}};(0,r.useEffect)((()=>{L()}),[]);return(0,I.jsx)(h.default,{source:d?{uri:d}:a(8922),style:Ae.background,resizeMode:"cover",children:(0,I.jsxs)(n.default,{style:Ae.fullScreenContainer,children:[(0,I.jsxs)(n.default,{style:[Ae.header,{paddingTop:40}],children:[(0,I.jsx)(b.default,{onPress:()=>{window.confirm("Tem a certeza que deseja sair?")&&t.navigate("Aluno")},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:[Ae.icon,{tintColor:"dark"===f?"#FFF":"#000"}]})}),(0,I.jsx)(b.default,{onPress:()=>$(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:[Ae.icon,{tintColor:"dark"===f?"#FFF":"#000"}]})})]}),(0,I.jsxs)(ne.default,{style:Ae.container,behavior:void 0,children:[(0,I.jsx)(p.default,{barStyle:e.dark?"light-content":"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsxs)(n.default,{style:Ae.inner,children:[(0,I.jsxs)(W.default,{style:Ae.label,children:["Envia-nos uma sugest\xe3o de melhoria (email: ",i,")"]}),(0,I.jsx)(S.default,{mode:"outlined",label:"A tua sugest\xe3o",placeholder:"Ex.: Melhorar o layout do calend\xe1rio...",value:x,onChangeText:y,multiline:!0,numberOfLines:4,style:Ae.input}),C?(0,I.jsx)(l.default,{animating:!0,size:"large",style:Ae.loader}):(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(!x.trim())return k("Por favor, escreve alguma sugest\xe3o antes de enviar."),void D(!0);v(!0);try{const e=await B.default.post(`${c.baseUrl}/calendarioFiles/suggest/submit_suggestion.php`,{email:i,suggestion:x});e.data.success?(k("Sugest\xe3o enviada com sucesso!"),y(""),await L()):k(e.data.message||"Falha ao enviar.")}catch{k("Falha ao enviar. Tenta de novo mais tarde.")}finally{v(!1),D(!0)}},style:Ae.button,children:"Enviar Sugest\xe3o"})]}),(0,I.jsx)(Pe.default,{visible:F,onDismiss:()=>D(!1),duration:3e3,children:w}),R?(0,I.jsx)(l.default,{style:{marginTop:20}}):(0,I.jsx)(V.default,{data:P,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,I.jsxs)(n.default,{children:[(0,I.jsx)(ke.default,{title:e.message,description:()=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(W.default,{children:["Enviado: ",e.date_sent]}),e.response?(0,I.jsxs)(W.default,{children:["Resposta (",e.responder," em ",e.date_response,"):"," ",e.response]}):(0,I.jsx)(W.default,{style:{fontStyle:"italic"},children:"Sem resposta ainda"})]}),left:e=>(0,I.jsx)(Ie.default,Object.assign({},e,{icon:"message-text-outline"}))}),(0,I.jsx)(H.default,{})]}),style:Ae.list,contentContainerStyle:{paddingBottom:80}})]}),(0,I.jsx)(A,{visible:_,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>$(!1),navigation:t,email:i})]})})};var Re=a(2782);const Ee=(0,r.memo)((({value:e,onChangeText:t,placeholder:a,secure:o,toggleSecure:r,userTheme:l})=>(0,I.jsxs)(n.default,{style:[Ve.inputContainer,{borderColor:"dark"===l?"#fff":"#000"}],children:[(0,I.jsx)(Re.default,{style:[Ve.textInput,{color:"dark"===l?"#fff":"#000"}],placeholder:a,placeholderTextColor:"dark"===l?"#aaa":"#555",secureTextEntry:o,value:e,onChangeText:t,blurOnSubmit:!1}),(0,I.jsx)(b.default,{onPress:r,children:(0,I.jsx)(F.default,{name:o?"eye-off":"eye",size:20,color:"dark"===l?"#fff":"#000"})})]})));Ee.displayName="PasswordInput";const Oe=(0,r.memo)((({timer:e,userTheme:t})=>(0,I.jsxs)(u.default,{style:[Ve.info,"light"===t?{color:"#000"}:{color:"#fff"}],children:["Insira a nova palavra-passe. Para garantirmos a sua seguran\xe7a, dentro de um 1 minuto a sess\xe3o ser\xe1 encerrada (Ainda t\xeam: ",e," segundos):"]})));Oe.displayName="TimerText";const Ve=m.default.create({darkOverlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0, 0, 0, 0.5)"}),backButton:{position:"absolute",top:50,left:20,zIndex:10,backgroundColor:"rgba(0, 0, 0, 0.2)",padding:8,borderRadius:20},box:{padding:20,borderRadius:15,width:"90%",maxWidth:400,alignItems:"center",justifyContent:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:16,textAlign:"center"},info:{fontSize:16,marginBottom:12,textAlign:"center"},inputContainer:{flexDirection:"row",alignItems:"center",width:"100%",height:45,borderWidth:1,borderRadius:8,paddingHorizontal:12,marginBottom:16},textInput:{flex:1,fontSize:16},button:{paddingVertical:12,paddingHorizontal:20,borderRadius:8,marginVertical:10,alignItems:"center",justifyContent:"center",width:"100%"},buttonText:{fontSize:16,fontWeight:"bold"},loadingWrapper:{flex:1,justifyContent:"center",alignItems:"center"},loadingContainer:{padding:20,borderRadius:10,alignItems:"center",justifyContent:"center"},loadingDark:{backgroundColor:"rgba(0, 0, 0, 0.5)"},loadingLight:{backgroundColor:"rgba(255, 255, 255, 0.5)"}}),_e=()=>{const e=(0,s.useRoute)(),{email:t}=e.params,o=(0,s.useNavigation)(),i=`${c.baseUrl}/calendarioFiles/passwordAndSecurity/verify_password.php`,d=`${c.baseUrl}/calendarioFiles/passwordAndSecurity/update_password.php`,[f,m]=(0,r.useState)(null),[g,p]=(0,r.useState)("light"),[x,y]=(0,r.useState)(!0),[j,C]=(0,r.useState)("verify"),[v,w]=(0,r.useState)(""),[S,T]=(0,r.useState)(""),[k,D]=(0,r.useState)(""),[P,A]=(0,r.useState)(!1),[R,E]=(0,r.useState)(!0),[O,V]=(0,r.useState)(!0),[_,W]=(0,r.useState)(!0),[H,$]=(0,r.useState)(60),L=(0,r.useRef)(null);(0,r.useEffect)((()=>{!async function(){try{const e=await z.getItemAsync("backgroundUrl");m(e);const t=await z.getItemAsync("userTheme");p("dark"===t?"dark":"light")}catch{console.log("Erro ao carregar configura\xe7\xf5es.")}finally{y(!1)}}()}),[]),(0,r.useEffect)((()=>("update"===j&&($(60),L.current=setInterval((()=>{$((e=>e-1))}),1e3)),()=>{L.current&&(clearInterval(L.current),L.current=null)})),[j]),(0,r.useEffect)((()=>{"update"===j&&(10===H&&alert("A sess\xe3o expira em 10 segundos! Por favor, insira a nova palavra-passe ou cancele."),H<=0&&(alert("Sess\xe3o expirada. Por favor, verifique a palavra-passe atual novamente."),C("verify"),w(""),T(""),D("")))}),[H,j]);const N=(0,r.useCallback)((()=>{E((e=>!e))}),[]),M=(0,r.useCallback)((()=>{V((e=>!e))}),[]),U=(0,r.useCallback)((()=>{W((e=>!e))}),[]);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),m(e),p("dark"===t?"dark":"light")}catch(e){console.log("Erro ao carregar configura\xe7\xf5es.",e)}finally{A(!1)}}()}),[]);const q="dark"===g?"#e0dede":"#000";if(P)return(0,I.jsxs)(h.default,{source:f?{uri:f}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===g&&(0,I.jsx)(n.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1}}),(0,I.jsxs)(n.default,{style:{alignItems:"center"},children:[(0,I.jsx)(l.default,{size:"large",color:q}),(0,I.jsx)(u.default,{style:{fontSize:18,marginTop:10,color:q},children:"Carregando registros..."})]})]});const G=[Ve.box,"light"===g?{backgroundColor:"#f0f0f0"}:{backgroundColor:"rgba(0, 0, 0, 0.5)"}],J=[Ve.title,"light"===g?{color:"#000"}:{color:"#fff"}],Y=[Ve.button,{backgroundColor:"dark"===g?"#333":"#ccc"}],Z=[Ve.button,{backgroundColor:"dark"===g?"#630101":"#f29d9d"}],Q="light"===g?"#000":"#fff";return(0,I.jsxs)(h.default,{source:{uri:f||"../../../assets/images/bg1.png"},style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===g&&(0,I.jsx)(n.default,{style:Ve.darkOverlay,pointerEvents:"none"}),(0,I.jsx)(b.default,{style:Ve.backButton,onPress:()=>o.goBack(),children:(0,I.jsx)(F.default,{name:"arrow-back",size:24,color:Q})}),(0,I.jsxs)(n.default,{style:G,children:[(0,I.jsx)(u.default,{style:J,children:"Palavra-passe e Seguran\xe7a"}),"verify"===j&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Ve.info,"light"===g?{color:"#000"}:{color:"#fff"}],children:"Para garantir a sua seguran\xe7a, insira a palavra-passe atual:"}),(0,I.jsx)(Ee,{value:v,onChangeText:w,placeholder:"Palavra-passe atual",secure:R,toggleSecure:N,userTheme:g}),(0,I.jsx)(b.default,{style:Y,onPress:async()=>{if(v){A(!0);try{const e=await B.default.post(i,{email:t,password:v});e.data.success?(w(""),C("update")):alert(e.data.message)}catch(e){alert("Ocorreu um erro ao verificar a palavra-passe."),console.error(e)}finally{A(!1)}}else alert("Por favor, insira a palavra-passe atual!")},children:(0,I.jsx)(u.default,{style:[Ve.buttonText,"light"===g?{color:"#000"}:{color:"#fff"}],children:"Verificar"})})]}),"update"===j&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Oe,{timer:H,userTheme:g}),(0,I.jsx)(Ee,{value:S,onChangeText:T,placeholder:"Nova palavra-passe",secure:O,toggleSecure:M,userTheme:g}),(0,I.jsx)(Ee,{value:k,onChangeText:D,placeholder:"Confirme a nova palavra-passe",secure:_,toggleSecure:U,userTheme:g}),(0,I.jsx)(b.default,{style:Y,onPress:async()=>{if(S&&k)if(S===k){A(!0);try{const e=await B.default.post(d,{email:t,newPassword:S});!0===e.data.success?(alert("A sua palavra-passe foi atualizada com sucesso."),C("verify"),w(""),T(""),D("")):alert(e.data.message)}catch(e){alert("Ocorreu um erro ao atualizar a palavra-passe. Pedimos que tente novamente mais tarde.")}finally{A(!1)}}else alert("A nova palavra-passe e a confirma\xe7\xe3o n\xe3o coincidem.");else alert("Preencha todos os campos!")},children:(0,I.jsx)(u.default,{style:[Ve.buttonText,"light"===g?{color:"#000"}:{color:"#fff"}],children:"Atualizar"})}),(0,I.jsx)(b.default,{style:Z,onPress:()=>{C("verify"),w(""),T(""),D(""),L.current&&(clearInterval(L.current),L.current=null)},children:(0,I.jsx)(u.default,{style:[Ve.buttonText,"light"===g?{color:"#000"}:{color:"#fff"}],children:"Cancelar"})})]})]})]})};var We=a(5636),He=a(5368),$e=a(3878);const Le=M.default.get("window").width,Ne=e=>({backgroundGradientFrom:"#fff",backgroundGradientFromOpacity:0,backgroundGradientTo:"#fff",backgroundGradientToOpacity:.5,color:(t=1)=>1===t?"#47AD4D":e.colors.primary,strokeWidth:2,barPercentage:.5,useShadowColorFromDataset:!1}),Me=(e,t)=>{const a=(e=>{let t=0;for(let a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return t})(e);return`hsl(${Math.abs(a)%360}, ${"dark"===t?90:50}%, ${"dark"===t?50:70}%)`},Ue=e=>e.reduce(((e,t)=>{const a=t.disciplina_nome;return e[a]||(e[a]=[]),e[a].push(t),e}),{}),qe=e=>{const t=e.map((e=>parseFloat(e.nota))),a=t.reduce(((e,t)=>e+t),0);return{avg:t.length?a/t.length:0,min:Math.min(...t),max:Math.max(...t)}},Ge=m.default.create({listItemContainer:{borderWidth:1,borderColor:"#ccc",borderRadius:10,padding:15,marginVertical:8,backgroundColor:"#fff",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},listItemHeader:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},listItemTitle:{fontSize:18,fontWeight:"600"},listItemDate:{fontSize:14},listItemContent:{borderTopWidth:1,borderTopColor:"#eee",paddingTop:8},listItemRow:{flexDirection:"row",marginBottom:4},listItemLabel:{fontWeight:"600",fontSize:16,marginRight:4},listItemValue:{fontSize:16,color:"#333"},tableContainer:{width:"100%",paddingHorizontal:10},tableRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:8,borderBottomWidth:1,borderBottomColor:"#ccc"},tableHeader:{fontSize:16,fontWeight:"bold"},tableCell:{fontSize:16},loaderContainer:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,alignItems:"center",justifyContent:"center",backgroundColor:"#fff"},internalHeader:{top:0,left:0,right:0,marginLeft:-25,width:"103.2%",height:70,flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:15,elevation:4,zIndex:10,paddingTop:0},internalHeaderText:{fontSize:22,fontWeight:"bold"},viewToggleContainer:{flexDirection:"row",justifyContent:"center",marginBottom:15,marginTop:10},viewToggleButton:{paddingVertical:8,paddingHorizontal:15,borderRadius:20,marginHorizontal:5,backgroundColor:"rgba(231,229,229,0.6)"},viewToggleButtonActive:{backgroundColor:"rgba(82,82,82,0.7)"},viewToggleButtonText:{fontWeight:"bold",color:"#000"},chartTypeToggleContainer:{flexDirection:"row",justifyContent:"center",marginBottom:15},chartTypeButton:{paddingVertical:6,paddingHorizontal:10,borderRadius:15,marginHorizontal:5,backgroundColor:"rgba(200,200,200,0.6)"},chartTypeButtonActive:{backgroundColor:"rgba(120,120,120,0.8)"},chartWrapper:{width:.95*Le,marginHorizontal:"auto",padding:10,borderRadius:8,marginVertical:20,alignItems:"center"},chartContent:{alignItems:"flex-end"},barContainer:{width:60,alignItems:"center",marginHorizontal:10},barWrapper:{height:350,justifyContent:"flex-end",alignItems:"center",width:"100%"},bar:{width:"100%",justifyContent:"flex-end",alignItems:"center",borderTopLeftRadius:4,borderTopRightRadius:4},barValue:{fontWeight:"bold",padding:2,fontSize:12},barLabel:{marginTop:5,fontWeight:"bold",textAlign:"center",width:60},statsContainer:{padding:20,alignItems:"center",borderRadius:8,marginVertical:10},statsText:{fontSize:18,marginVertical:4},filterButton:{paddingVertical:12,paddingHorizontal:25,borderRadius:5,elevation:2},filterButtonText:{fontWeight:"bold",fontSize:16},professionalFilterButton:{backgroundColor:"#47AD4D",paddingVertical:10,paddingHorizontal:20,borderRadius:25,elevation:3,marginBottom:15},professionalFilterButtonText:{color:"#FFF",fontWeight:"bold",fontSize:16},statItem:{marginVertical:8,padding:10,borderRadius:8,borderWidth:1,width:"100%"},statTitle:{fontSize:18,fontWeight:"bold",marginBottom:4},statDescription:{fontSize:14,color:"#333"},modalContainer:{flex:1,backgroundColor:"rgba(0,0,0,0.6)",justifyContent:"center",alignItems:"center"},modalContent:{width:"85%",borderRadius:10,padding:20},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:10},modalInput:{borderWidth:1,borderRadius:5,marginBottom:10,paddingHorizontal:10,height:40},modalButtonRow:{flexDirection:"row",justifyContent:"space-between"},modalButton:{flex:1,marginHorizontal:5,padding:10,borderRadius:5,alignItems:"center"},modalButtonText:{color:"#fff",fontWeight:"bold"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.6)",justifyContent:"center",alignItems:"center"},detailModalContent:{width:"80%",borderRadius:10,padding:20},detailText:{fontSize:16,marginBottom:10},detailLabel:{fontWeight:"bold"},closeModalButton:{alignSelf:"center",marginTop:10,paddingVertical:8,paddingHorizontal:20,borderRadius:5},darkOverlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0, 0, 0, 0.5)"}),pdfButton:{marginTop:10,paddingVertical:12,paddingHorizontal:25,borderRadius:5,alignSelf:"center"},pdfButtonText:{color:"#FFF",fontWeight:"bold",fontSize:16},webPieContainer:{flexDirection:"row",alignItems:"center",width:"100%"},filterOptionButton:{marginRight:10,padding:8,borderRadius:5,backgroundColor:"#e3e3e3"},datePickerButton:{borderWidth:1,borderColor:"#ccc",padding:10,borderRadius:5,marginBottom:10}}),Je=({navigation:e})=>{const t=(0,s.useRoute)(),{email:o}=t.params,i=(0,j.useTheme)(),[d,m]=(0,r.useState)(null),[x,y]=(0,r.useState)(i.dark?"dark":"light"),[C,v]=(0,r.useState)(!0),[w,S]=(0,r.useState)([]),[T,k]=(0,r.useState)([]),[F,B]=(0,r.useState)("chart"),[P,z]=(0,r.useState)("bar"),[R,E]=(0,r.useState)(""),[O,W]=(0,r.useState)(null),[H,$]=(0,r.useState)(null),[L,N]=(0,r.useState)(!1),[M,U]=(0,r.useState)(!1),[q,G]=(0,r.useState)(!1),[J,Y]=(0,r.useState)([]),[Z,Q]=(0,r.useState)(!1),[K,X]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(null),[oe,re]=(0,r.useState)(null),[le,ne]=(0,r.useState)(!1),se=(0,r.useRef)(null);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),m(e),y("dark"===t?"dark":"light")}catch(e){}finally{v(!1)}}()}),[]);const ie=`${c.baseUrl}/calendarioFiles/fetch_notes.php`;(0,r.useEffect)((()=>{(async()=>{try{const e=await fetch(ie,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),t=await e.json();let a=[];Array.isArray(t)?a=t:t.notas&&(a=t.notas),S(a),k(a);const r=Array.from(new Set(a.map((e=>e.disciplina_nome))));Y(r)}catch(e){}})()}),[]);const de=async()=>{try{const e=await(0,He.captureRef)(se,{format:"png",quality:1,result:"base64"}),t=qe(w),a=(e=>{const t={};let a="",o=0;return e.forEach((e=>{const r=e.nota;t[r]=(t[r]||0)+1,t[r]>o&&(o=t[r],a=r)})),a})(w),r=(e=>{if(0===e.length)return{positive:null,negative:null};const{avg:t}=qe(e);let a=null,o=null,r=0,l=0;return e.forEach((e=>{const n=parseFloat(e.nota)-t;n>r&&(r=n,a=e),n<l&&(l=n,o=e)})),{positive:a,negative:o}})(w),l=new Date,n=`${("0"+l.getDate()).slice(-2)}-${("0"+(l.getMonth()+1)).slice(-2)}-${l.getFullYear()} ${("0"+l.getHours()).slice(-2)}:${("0"+l.getMinutes()).slice(-2)}`,s=(()=>0===w.length?"":`\n          <table style="width:100%; border-collapse: collapse; font-family: sans-serif; font-size: 10px;">\n            <tr>\n              <th style="border: 1px solid #ccc; padding: 2px;">Disciplina</th>\n              <th style="border: 1px solid #ccc; padding: 2px;">Nota</th>\n            </tr>\n            ${w.map((e=>`\n              <tr>\n                <td style="border: 1px solid #ccc; padding: 2px;">${e.disciplina_nome}</td>\n                <td style="border: 1px solid #ccc; padding: 2px;">${e.nota}</td>\n              </tr>\n            `)).join("")}\n          </table>\n        `)(),i=`\n        <html>\n          <head>\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <style>\n              @page { margin: 0; }\n              body { margin: 0; padding: 0; font-family: sans-serif; background: #FFF; }\n              header { position: fixed; top: 0; left: 0; right: 0; height: 60px; background: #FFF; border-bottom: 1px solid #ccc; display: flex; align-items: center; padding: 0 20px; z-index: 1000; }\n              header img { height: 40px; }\n              header h1 { flex: 1; text-align: center; font-size: 18px; margin: 0; }\n              footer { position: fixed; bottom: 0; left: 0; right: 0; height: 40px; background: #FFF; border-top: 1px solid #ccc; padding-top: 4px; text-align: center; font-size: 12px; color: #000; z-index: 1000; }\n              main { margin-top: 70px; margin-bottom: 50px; padding: 10px; }\n              .chart-img { width: 100%; }\n              .section-title { font-size: 16px; color: #000; margin: 10px 0 5px; }\n              table, th, td { border: 1px solid #ccc; border-collapse: collapse; }\n              th, td { padding: 8px; text-align: left; }\n              .bar-chart { display: flex; flex-wrap: wrap; }\n              .bar-column { width: 8%; min-width: 30px; margin: 4px; text-align: center; }\n              .bar { width: 100%; background-color: rgba(71,173,77,0.8); }\n            </style>\n          </head>\n          <body>\n            <header>\n              <img src="https://etps.pt/images/upload/630cb87edab43698c0a0e5f5678403d4.png" alt="Logo" />\n              <h1>Resumo das Notas do Utilizador</h1>\n            </header>\n            <main>\n              ${"bar"===P?`\n              <div class="section-title">Gr\xe1fico de Barras</div>\n              <div class="bar-chart">\n                ${T.map((e=>`<div class="bar-column">\n                    <div class="bar" style="height: ${parseFloat(e.nota)/20*100}px;"></div>\n                    <div style="font-size:8px;">${e.disciplina_nome}</div>\n                    <div style="font-size:8px;">${e.nota}</div>\n                  </div>`)).join("")}\n              </div>\n              `:`\n              <div class="section-title">Gr\xe1fico de Linha</div>\n              <img class="chart-img" src="data:image/png;base64,${e}" />\n              `}\n              <div class="section-title">Estat\xedsticas Gerais</div>\n              <p>M\xe9dia Geral: ${t.avg.toFixed(2)}</p>\n              <p>Nota M\xe1xima: ${t.max.toFixed(2)}</p>\n              <p>Moda: ${a}</p>\n              <p>\n                ${r.positive?`Nota que mais se destaca positivamente: ${r.positive.nota}`:"N/A"}\n                &nbsp;|&nbsp;\n                ${r.negative?`Nota que mais se destaca negativamente: ${r.negative.nota}`:"N/A"}\n              </p>\n              <div class="section-title">Tabela Resumida \u2013 Disciplina e Nota</div>\n              ${s}\n            </main>\n            <footer>\n              Este documento cont\xe9m dados e an\xe1lises avan\xe7adas sobre as notas do ${o} emitido em ${n}.\n            </footer>\n          </body>\n        </html>\n      `;await $e.printAsync({html:i})}catch(e){}},ce=({notes:e,percentageChange:t})=>{if(e.length<2)return(0,I.jsx)(u.default,{style:{color:"dark"===x?"#FFF":"#000",marginVertical:8},children:"Dados insuficientes para exibir evolu\xe7\xe3o."});const a=e.map(((e,t)=>{const a=new Date(e.data_lancamento).toLocaleDateString();return t%2===1?`${a}\n`:a})),o=e.map((e=>parseFloat(e.nota))),r=t>=0?"#47AD4D":"#dc3545",l=Math.max(.9*Le,80*a.length);return(0,I.jsx)(f.default,{horizontal:!0,contentContainerStyle:{paddingBottom:10},children:(0,I.jsx)(We.LineChart,{data:{labels:a,datasets:[{data:o,color:()=>r}]},width:l,height:220,fromZero:!0,chartConfig:{backgroundGradientFrom:"dark"===x?"#000":"#FFF",backgroundGradientTo:"dark"===x?"#000":"#FFF",color:()=>r,strokeWidth:2,decimalPlaces:2,propsForDots:{r:"4",strokeWidth:"2",stroke:r},propsForBackgroundLines:{stroke:"dark"===x?"#424242":"#e3e3e3"},propsForLabels:{fill:"dark"===x?"#FFF":"#000"}},bezier:!0,style:{marginVertical:8,borderRadius:16},onDataPointClick:t=>{const a=t.index,o=e[a];te(o),X(!0)}})})};if(C)return(0,I.jsx)(h.default,{source:d?{uri:d}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsxs)(n.default,{style:Ge.loaderContainer,children:[(0,I.jsx)(l.default,{size:"large",color:"#6200ea"}),(0,I.jsx)(u.default,{style:{marginTop:16,fontSize:16,textAlign:"center"},children:"Estamos a processar o seu pedido de registo. Pedimos que aguarde..."})]})});const ue="dark"===x?"#000":"#FFF",fe="dark"===x?"#FFF":"#000";return(0,I.jsxs)(h.default,{source:d?{uri:d}:a(8922),style:{flex:1,width:"100%",justifyContent:"center",alignItems:"center"},children:["dark"===x&&(0,I.jsx)(n.default,{style:Ge.darkOverlay,pointerEvents:"none"}),(0,I.jsx)(p.default,{backgroundColor:"transparent",translucent:!0,barStyle:"dark"===x?"light-content":"dark-content"}),(0,I.jsxs)(_.default,{style:{flex:1,width:"97%"},children:[(0,I.jsxs)(n.default,{style:[Ge.internalHeader,{backgroundColor:ue,width:"103.2%"}],children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,tintColor:"dark"===x?"#FFF":void 0,marginTop:30}})}),(0,I.jsx)(b.default,{onPress:()=>ne(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,tintColor:"dark"===x?"#FFF":void 0,marginTop:30}})})]}),(0,I.jsxs)(n.default,{style:Ge.viewToggleContainer,children:[(0,I.jsx)(b.default,{onPress:()=>B("list"),style:[Ge.viewToggleButton,"list"===F&&Ge.viewToggleButtonActive],children:(0,I.jsx)(u.default,{style:Ge.viewToggleButtonText,children:"Lista"})}),(0,I.jsx)(b.default,{onPress:()=>B("chart"),style:[Ge.viewToggleButton,"chart"===F&&Ge.viewToggleButtonActive],children:(0,I.jsx)(u.default,{style:Ge.viewToggleButtonText,children:"Gr\xe1fico"})}),(0,I.jsx)(b.default,{onPress:()=>B("stats"),style:[Ge.viewToggleButton,"stats"===F&&Ge.viewToggleButtonActive],children:(0,I.jsx)(u.default,{style:Ge.viewToggleButtonText,children:"Estat\xedsticas"})})]}),"chart"===F&&(0,I.jsxs)(n.default,{style:Ge.chartTypeToggleContainer,children:[(0,I.jsx)(b.default,{onPress:()=>z("bar"),style:[Ge.chartTypeButton,"bar"===P&&Ge.chartTypeButtonActive],children:(0,I.jsx)(u.default,{style:{color:i.colors.onSurface},children:"Barra"})}),T.length>1&&(0,I.jsx)(b.default,{onPress:()=>z("line"),style:[Ge.chartTypeButton,"line"===P&&Ge.chartTypeButtonActive],children:(0,I.jsx)(u.default,{style:{color:i.colors.onSurface},children:"Linha"})})]}),0===T.length?(0,I.jsx)(u.default,{style:{color:i.colors.onSurface,textAlign:"center"},children:"Sem notas por enquanto."}):"list"===F?(0,I.jsx)(V.default,{data:T,keyExtractor:(e,t)=>e.nota_id?e.nota_id.toString():t.toString(),renderItem:({item:e})=>(0,I.jsxs)(b.default,{style:[Ge.listItemContainer,"dark"===x&&{backgroundColor:"#222",borderColor:"#444"}],onPress:()=>{te(e),X(!0)},children:[(0,I.jsxs)(n.default,{style:Ge.listItemHeader,children:[(0,I.jsx)(u.default,{style:[Ge.listItemTitle,{color:"dark"===x?"#FFF":"#000"}],children:e.disciplina_nome}),(0,I.jsx)(u.default,{style:[Ge.listItemDate,{color:"dark"===x?"#CCC":"#555"}],children:new Date(e.data_lancamento).toLocaleDateString()})]}),(0,I.jsxs)(n.default,{style:Ge.listItemContent,children:[(0,I.jsxs)(n.default,{style:Ge.listItemRow,children:[(0,I.jsx)(u.default,{style:Ge.listItemLabel,children:"Nota:"}),(0,I.jsx)(u.default,{style:Ge.listItemValue,children:e.nota})]}),(0,I.jsxs)(n.default,{style:Ge.listItemRow,children:[(0,I.jsx)(u.default,{style:Ge.listItemLabel,children:"Professor:"}),(0,I.jsx)(u.default,{style:Ge.listItemValue,children:e.professor_email})]})]})]}),ListFooterComponent:(0,I.jsx)(n.default,{style:{marginTop:10},children:(0,I.jsx)(b.default,{style:[Ge.filterButton,{backgroundColor:"#47AD4D"}],onPress:()=>Q(!0),children:(0,I.jsx)(u.default,{style:[Ge.filterButtonText,{color:i.colors.onPrimary}],children:"Filtrar"})})}),contentContainerStyle:{paddingBottom:20}}):"chart"===F?"bar"===P?(0,I.jsxs)(n.default,{children:[(0,I.jsx)(n.default,{style:[Ge.chartWrapper,{backgroundColor:"dark"===x?"rgba(0, 0, 0, 0.5)":"#f0f0f0"}],children:(0,I.jsx)(f.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:Ge.chartContent,children:T.map(((e,t)=>{const a=parseFloat(e.nota)/20*350;return(0,I.jsxs)(b.default,{style:Ge.barContainer,onPress:()=>{te(e),X(!0)},children:[(0,I.jsx)(n.default,{style:Ge.barWrapper,children:(0,I.jsx)(n.default,{style:[Ge.bar,{height:a,backgroundColor:"dark"===x?"#47AD4D":"rgba(71, 173, 77, 0.8)"}],children:(0,I.jsx)(u.default,{style:[Ge.barValue,{color:"dark"===x?"#FFF":"#000"}],children:e.nota})})}),(0,I.jsx)(u.default,{style:[Ge.barLabel,{color:"dark"===x?"#FFF":"#000"}],numberOfLines:1,ellipsizeMode:"tail",children:e.disciplina_nome})]},t.toString())}))})}),(0,I.jsx)(b.default,{onPress:de,style:[Ge.pdfButton,{backgroundColor:"#47AD4D"}],children:(0,I.jsx)(u.default,{style:Ge.pdfButtonText,children:"Gerar PDF"})})]}):"pie"===P?(()=>{const e=T.reduce(((e,t)=>{const a=t.disciplina_nome;return e[a]||(e[a]={name:t.disciplina_nome,population:0,color:Me(t.disciplina_nome,x),legendFontColor:"dark"===x?"#FFF":"#000",legendFontSize:12,notes:[]}),e[a].population+=1,e[a].notes.push(t),e}),{}),t=Object.values(e),a="dark"===x?"rgba(0, 0, 0, 0.5)":"#FFF";return(0,I.jsx)(n.default,{children:(0,I.jsx)(n.default,{style:[Ge.chartWrapper,{backgroundColor:a}],children:(0,I.jsxs)(n.default,{style:Ge.webPieContainer,children:[(0,I.jsx)(We.PieChart,{data:t,width:.5*Le,height:220,chartConfig:Ne(i),accessor:"population",backgroundColor:"transparent",paddingLeft:"15",absolute:!0,hasLegend:!1}),(0,I.jsx)(n.default,{style:{flex:1,marginLeft:10},children:t.length>7?(0,I.jsx)(f.default,{style:{maxHeight:200},children:t.map(((e,t)=>(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000",flex:1}],children:e.name}),(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.population})]},t.toString())))}):t.map(((e,t)=>(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000",flex:1}],children:e.name}),(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.population})]},t.toString())))})]})})})})():(()=>{const e=[...T].sort(((e,t)=>new Date(e.data_lancamento).getTime()-new Date(t.data_lancamento).getTime())),t=e.map(((e,t)=>{const a=new Date(e.data_lancamento).toLocaleDateString();return t%2===1?`${a}`:a})),a=e.map((e=>parseFloat(e.nota))),o="dark"===x,r=o?"#000":"#FFF",l=o?"#47AD4D":"#000",s=o?"#CCC":"#000",i=Math.max(.9*Le,80*e.length);return(0,I.jsxs)(n.default,{children:[(0,I.jsx)(n.default,{style:[Ge.chartWrapper,{backgroundColor:r}],children:(0,I.jsx)(f.default,{horizontal:!0,contentContainerStyle:{paddingBottom:10},children:(0,I.jsx)(We.LineChart,{data:{labels:t,datasets:[{data:a,color:()=>l}]},width:i,height:220,fromZero:!0,chartConfig:{backgroundGradientFrom:r,backgroundGradientTo:r,color:()=>s,strokeWidth:2,decimalPlaces:2,propsForDots:{r:"4",strokeWidth:"2",stroke:l},propsForBackgroundLines:{stroke:o?"#424242":"#e3e3e3"},propsForLabels:{fill:s}},bezier:!0,onDataPointClick:t=>{const a=t.index,o=e[a];te(o),X(!0)},style:{borderRadius:16}})})}),e.length>0&&(e.length>4?(0,I.jsx)(f.default,{style:{maxHeight:200},children:(0,I.jsxs)(n.default,{style:Ge.tableContainer,children:[(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableHeader,{color:"dark"===x?"#FFF":"#000"}],children:"Disciplina"}),(0,I.jsx)(u.default,{style:[Ge.tableHeader,{color:"dark"===x?"#FFF":"#000"}],children:"Nota"})]}),e.map(((e,t)=>(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.disciplina_nome}),(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.nota})]},t.toString())))]})}):(0,I.jsxs)(n.default,{style:Ge.tableContainer,children:[(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableHeader,{color:"dark"===x?"#FFF":"#000"}],children:"Disciplina"}),(0,I.jsx)(u.default,{style:[Ge.tableHeader,{color:"dark"===x?"#FFF":"#000"}],children:"Nota"})]}),e.map(((e,t)=>(0,I.jsxs)(n.default,{style:Ge.tableRow,children:[(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.disciplina_nome}),(0,I.jsx)(u.default,{style:[Ge.tableCell,{color:"dark"===x?"#FFF":"#000"}],children:e.nota})]},t.toString())))]})),(0,I.jsx)(b.default,{onPress:de,style:[Ge.pdfButton,{backgroundColor:"#47AD4D"}],children:(0,I.jsx)(u.default,{style:Ge.pdfButtonText,children:"Gerar PDF"})})]})})():(()=>{const e=((e,t)=>{const a=Ue(e),o=Ue(t),r={};for(const s in o){const e=qe(a[s]||[]),t=qe(o[s]||[]),l=e.avg>0?(t.avg-e.avg)/e.avg*100:0,n=[...o[s]||[]].sort(((e,t)=>new Date(e.data_lancamento).getTime()-new Date(t.data_lancamento).getTime()));r[s]={overallAvg:e.avg,filteredAvg:t.avg,percentageChange:l,highestFiltered:t.max,lowestFiltered:t.min,notesOrdered:n}}let l=null,n=null;for(const s in r){const e=r[s];e.percentageChange>=0?(!l||e.percentageChange>l.percentageChange)&&(l={discipline:s,percentageChange:e.percentageChange}):(!n||e.percentageChange<n.percentageChange)&&(n={discipline:s,percentageChange:e.percentageChange})}return{disciplineStats:r,highestIncrease:l,highestDecline:n}})(w,w.filter((e=>{let t=!0;return R.trim()&&(t=t&&e.disciplina_nome===R),O&&(t=t&&new Date(e.data_lancamento)>=O),H&&(t=t&&new Date(e.data_lancamento)<=H),t})));return(0,I.jsx)(f.default,{style:{flex:1},children:(0,I.jsxs)(n.default,{style:[Ge.statsContainer,{backgroundColor:"dark"===x?"#000":"#FFF"}],children:[(0,I.jsx)(b.default,{onPress:()=>N(!0),style:Ge.professionalFilterButton,children:(0,I.jsx)(u.default,{style:Ge.professionalFilterButtonText,children:"Filtrar Estat\xedsticas"})}),e&&Object.keys(e.disciplineStats).length?Object.keys(e.disciplineStats).map((t=>{const a=e.disciplineStats[t];return(0,I.jsxs)(n.default,{style:Ge.statItem,children:[(0,I.jsx)(u.default,{style:Ge.statTitle,children:t}),(0,I.jsxs)(u.default,{style:Ge.statDescription,children:["A m\xe9dia global \xe9 ",a.overallAvg.toFixed(2)," e a m\xe9dia da disciplina \xe9 ",a.filteredAvg.toFixed(2),", o que significa que houve"," ",a.percentageChange>0?(0,I.jsxs)(u.default,{style:{color:"#47AD4D"},children:["um aumento de ",a.percentageChange.toFixed(2),"%"]}):a.percentageChange<0?(0,I.jsxs)(u.default,{style:{color:"#dc3545"},children:["uma diminui\xe7\xe3o de ",Math.abs(a.percentageChange).toFixed(2),"%"]}):(0,I.jsx)(u.default,{children:"nenhuma altera\xe7\xe3o"}),"."]}),(0,I.jsxs)(u.default,{style:Ge.statDescription,children:["Nota mais alta: ",a.highestFiltered.toFixed(2),"; Nota mais baixa: ",a.lowestFiltered.toFixed(2),"."]}),a.notesOrdered&&a.notesOrdered.length>=2?(0,I.jsx)(ce,{notes:a.notesOrdered,percentageChange:a.percentageChange}):(0,I.jsx)(u.default,{style:{marginTop:8,color:"dark"===x?"#FFF":"#000"},children:"Dados insuficientes para gr\xe1fico."})]},t)})):(0,I.jsx)(u.default,{style:{color:"dark"===x?"#FFF":"#000",marginTop:10},children:"Sem dados suficientes para as estat\xedsticas avan\xe7adas."}),(0,I.jsx)(n.default,{style:{marginTop:20}})]})})})(),"list"!==F&&"stats"!==F&&"pie"!==P&&(0,I.jsx)(n.default,{style:{marginTop:10},children:(0,I.jsx)(b.default,{style:[Ge.filterButton,{backgroundColor:"#47AD4D"}],onPress:()=>Q(!0),children:(0,I.jsx)(u.default,{style:[Ge.filterButtonText,{color:i.colors.onPrimary}],children:"Filtrar"})})}),(0,I.jsx)(D.default,{visible:Z,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Ge.modalContainer,children:(0,I.jsxs)(n.default,{style:[Ge.modalContent,{backgroundColor:i.colors.surface}],children:[(0,I.jsx)(u.default,{style:[Ge.modalTitle,{color:i.colors.onSurface}],children:"Filtrar Notas"}),(0,I.jsx)(Re.default,{style:[Ge.modalInput,{color:i.colors.onSurface,borderColor:i.colors.outline}],placeholder:"Disciplina (t\xe9cnico)",placeholderTextColor:"#999"}),(0,I.jsxs)(n.default,{style:Ge.modalButtonRow,children:[(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#47AD4D"}],onPress:()=>Q(!1),children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Aplicar"})}),(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#dc3545"}],onPress:()=>Q(!1),children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Limpar"})}),(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#6c757d"}],onPress:()=>Q(!1),children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Fechar"})})]})]})})}),(0,I.jsx)(D.default,{visible:L,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Ge.modalContainer,children:(0,I.jsxs)(n.default,{style:[Ge.modalContent,{backgroundColor:i.colors.surface}],children:[(0,I.jsx)(u.default,{style:[Ge.modalTitle,{color:i.colors.onSurface}],children:"Filtrar Estat\xedsticas"}),(0,I.jsx)(u.default,{style:{marginBottom:8,fontWeight:"bold",color:i.colors.onSurface},children:"Selecione a Disciplina:"}),(0,I.jsx)(f.default,{horizontal:!0,contentContainerStyle:{marginBottom:10},children:J.map(((e,t)=>(0,I.jsx)(b.default,{style:[Ge.filterOptionButton,R===e&&{backgroundColor:"#47AD4D"}],onPress:()=>E(e),children:(0,I.jsx)(u.default,{style:{color:R===e?"#FFF":i.colors.onSurface},children:e})},t.toString())))}),(0,I.jsx)(u.default,{style:{marginBottom:8,fontWeight:"bold",color:i.colors.onSurface},children:"Data In\xedcio:"}),(0,I.jsx)(b.default,{onPress:()=>U(!0),style:Ge.datePickerButton,children:(0,I.jsx)(u.default,{style:{color:i.colors.onSurface},children:O?O.toISOString().split("T")[0]:"Selecionar Data"})}),M&&(0,I.jsx)(ae.default,{value:O||new Date,mode:"date",display:"default",onChange:(e,t)=>{U(!1),t&&W(t)}}),(0,I.jsx)(u.default,{style:{marginBottom:8,fontWeight:"bold",color:i.colors.onSurface},children:"Data Fim:"}),(0,I.jsx)(b.default,{onPress:()=>G(!0),style:Ge.datePickerButton,children:(0,I.jsx)(u.default,{style:{color:i.colors.onSurface},children:H?H.toISOString().split("T")[0]:"Selecionar Data"})}),q&&(0,I.jsx)(ae.default,{value:H||new Date,mode:"date",display:"default",onChange:(e,t)=>{G(!1),t&&$(t)}}),(0,I.jsxs)(n.default,{style:Ge.modalButtonRow,children:[(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#47AD4D"}],onPress:()=>N(!1),children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Aplicar"})}),(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#dc3545"}],onPress:()=>{E(""),W(null),$(null),N(!1)},children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Limpar"})}),(0,I.jsx)(b.default,{style:[Ge.modalButton,{backgroundColor:"#6c757d"}],onPress:()=>N(!1),children:(0,I.jsx)(u.default,{style:Ge.modalButtonText,children:"Fechar"})})]})]})})}),(0,I.jsx)(D.default,{visible:K,transparent:!0,animationType:"fade",children:(0,I.jsx)(n.default,{style:Ge.modalOverlay,children:(0,I.jsxs)(n.default,{style:[Ge.detailModalContent,{backgroundColor:"dark"===x?"#000":"#FFF"}],children:[ee?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Ge.modalTitle,{color:"dark"===x?"#FFF":"#000"}],children:"Detalhes da Nota"}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Nota: "}),ee.nota]}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Disciplina: "}),ee.disciplina_nome]}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Data: "}),ee.data_lancamento]}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Professor: "}),ee.professor_email]})]}):oe?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Ge.modalTitle,{color:"dark"===x?"#FFF":"#000"}],children:"Detalhes da Disciplina"}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Disciplina: "}),oe.name]}),(0,I.jsxs)(u.default,{style:[Ge.detailText,{color:"dark"===x?"#FFF":"#000"}],children:[(0,I.jsx)(u.default,{style:Ge.detailLabel,children:"Total de Notas: "}),oe.population]})]}):null,(0,I.jsx)(b.default,{style:[Ge.closeModalButton,{backgroundColor:"#47AD4D"}],onPress:()=>{X(!1),te(null),re(null)},children:(0,I.jsx)(u.default,{style:{color:i.colors.onPrimary},children:"Fechar"})})]})})}),(0,I.jsx)(A,{visible:le,dynamicHeaderBackground:ue,dynamicTextColor:fe,onClose:()=>ne(!1),navigation:e,email:o}),"chart"===F&&"pie"!==P&&(0,I.jsx)(n.default,{ref:se,style:{position:"absolute",top:-1e4,left:0,opacity:0},children:(0,I.jsx)((()=>{const e=[];R.trim()&&e.push(`Disciplina: ${R}`),O&&e.push(`Data In\xedcio: ${O.toISOString().split("T")[0]}`),H&&e.push(`Data Fim: ${H.toISOString().split("T")[0]}`);const t=e.length?`Filtro - ${e.join(", ")}`:"";if("bar"===P)return(0,I.jsxs)(n.default,{style:[Ge.chartWrapper,{backgroundColor:"#f0f0f0",padding:5}],children:[(0,I.jsx)(f.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:T.map(((e,t)=>{const a=parseFloat(e.nota)/20*200;return(0,I.jsxs)(n.default,{style:[Ge.barContainer,{width:40,marginHorizontal:4}],children:[(0,I.jsx)(n.default,{style:[Ge.barWrapper,{height:200}],children:(0,I.jsx)(n.default,{style:[Ge.bar,{height:a,backgroundColor:"rgba(71, 173, 77, 0.8)"}],children:(0,I.jsx)(u.default,{style:[Ge.barValue,{fontSize:10,color:"#000"}],children:e.nota})})}),(0,I.jsx)(u.default,{style:[Ge.barLabel,{fontSize:10,color:"#000"}],numberOfLines:1,ellipsizeMode:"tail",children:e.disciplina_nome})]},t.toString())}))}),t?(0,I.jsx)(u.default,{style:{fontSize:10,color:"#000",marginTop:4},children:t}):null]});if("line"===P){const e=[...T].sort(((e,t)=>new Date(e.data_lancamento).getTime()-new Date(t.data_lancamento).getTime())),a=e.map((e=>new Date(e.data_lancamento).toLocaleDateString())),o=e.map((e=>parseFloat(e.nota)));return(0,I.jsxs)(n.default,{style:[Ge.chartWrapper,{backgroundColor:"#FFF",padding:5}],children:[(0,I.jsx)(We.LineChart,{data:{labels:a,datasets:[{data:o,color:()=>"#000"}]},width:.9*Le,height:220,fromZero:!0,chartConfig:{backgroundGradientFrom:"#FFF",backgroundGradientTo:"#FFF",color:()=>"#000",strokeWidth:2,decimalPlaces:0,propsForDots:{r:"3",strokeWidth:"1",stroke:"#000"},propsForBackgroundLines:{stroke:"#e3e3e3"},propsForLabels:{fill:"#000"}},bezier:!0}),t?(0,I.jsx)(u.default,{style:{fontSize:10,color:"#000",marginTop:4},children:t}):null]})}return null}),{})})]})]})};var Ye=a(6294);const Ze=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),Qe=e=>`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)}`,Ke=m.default.create({background:{flex:1},fullScreenContainer:{flex:1,backgroundColor:"transparent"},headerContainer:{position:"absolute",top:0,width:"100%",flexDirection:"row",justifyContent:"space-between",paddingTop:30,paddingHorizontal:10,backgroundColor:"#FFF",zIndex:10},icon:{width:30,height:30},container:{flex:1,paddingHorizontal:10},calendarWrapper:{borderRadius:8,padding:10,marginTop:80},webEventContainer:{width:"90%",height:"90%",alignSelf:"center"},selectedEventContainer:{backgroundColor:"#47AD4D",borderRadius:4,width:45,height:45,justifyContent:"center",alignItems:"center",marginTop:5,marginLeft:1},menuEventContainer:{backgroundColor:"#abedde",borderRadius:4,width:45,height:45,justifyContent:"center",alignItems:"center",marginTop:5,marginLeft:1},eventText:{fontSize:20,margin:0},selectedDateItem:{margin:4,padding:8,borderRadius:8,alignSelf:"flex-start"},feedbackButton:{backgroundColor:"#FF9000",padding:12,borderRadius:6,alignItems:"center",marginVertical:5},feedbackButtonText:{color:"#FFF",fontSize:16,fontWeight:"bold"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",alignItems:"center"},ratingNumber:{fontSize:20,fontWeight:"normal",width:30,textAlign:"center"},ratingSelected:{fontWeight:"bold",borderWidth:2,borderColor:"#47AD4D",borderRadius:4,padding:2},selectedDatesWrapper:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},modalContent:{backgroundColor:"#FFF",borderRadius:8,padding:20,width:"80%"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},detailRow:{flexDirection:"row",alignItems:"center",marginVertical:5},detailText:{fontSize:16,marginLeft:8},modalActionButton:{backgroundColor:"#47AD4D",marginTop:20,borderRadius:5},textInput:{borderWidth:1,borderColor:"#CCC",borderRadius:4,padding:8,textAlignVertical:"top",marginTop:10},ratingRow:{flexDirection:"row",justifyContent:"space-between",marginVertical:10},buttonsRow:{flexDirection:"row",alignItems:"center",marginVertical:10,paddingHorizontal:10},spacer:{flex:1},smallFeedbackButton:{backgroundColor:"#FF9000",paddingVertical:8,paddingHorizontal:12,borderRadius:5},smallFeedbackButtonText:{color:"#fff",fontSize:14},saveButton:{backgroundColor:"#47AD4D",paddingVertical:10,paddingHorizontal:20,borderRadius:5},saveButtonText:{color:"#fff",fontSize:16}}),Xe=()=>{const e=(0,s.useNavigation)(),{email:t}=(0,s.useRoute)().params,[o,l]=(0,r.useState)([]),[i,d]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[C,v]=(0,r.useState)([]),[w,S]=(0,r.useState)(!1),[k,F]=(0,r.useState)(!0),[B,P]=(0,r.useState)(!1),[z,R]=(0,r.useState)(null),[E,O]=(0,r.useState)(!1),[V,_]=(0,r.useState)(!1),[W,H]=(0,r.useState)(null),[$,L]=(0,r.useState)(""),[U,G]=(0,r.useState)("light"),[J,Y]=(0,r.useState)(null),Z=`${c.baseUrl}/calendarioFiles/almocos/found_lunch.php`,Q=`${c.baseUrl}/calendarioFiles/almocos/found_menu.php`,K=`${c.baseUrl}/calendarioFiles/almocos/update_lunch.php`,X=`${c.baseUrl}/calendarioFiles/almocos/found_feedbacks.php`,ee=`${c.baseUrl}/calendarioFiles/almocos/submit_feedback.php`,te=(new Date).getHours(),ae=(e,t)=>{window.alert(t?`${e}\n\n${t}`:e)};(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),Y(e),G("dark"===t?"dark":"light")}catch(e){console.error("Erro ao carregar configura\xe7\xf5es",e)}finally{F(!1)}})()}),[]);const oe=(0,r.useCallback)((()=>fetch(Z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error(e.message);const t=e.data.map((e=>{const t=Ze(new Date(e.dia+"T00:00:00"));return{id:Qe(t),title:e.turma||"",start:t,end:t,fromDB:!0}}));l(t)}))),[t]),re=(0,r.useCallback)((()=>fetch(Q).then((e=>e.json())).then((e=>{if(!e.success)throw new Error("Erro no fetch de menus");const t=e.data.map((e=>({dia:e.dia,sopa:e.sopa,prato_principal:e.prato_principal,sobremesa:e.sobremesa})));j(t)}))),[]),le=(0,r.useCallback)((()=>fetch(X,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error("Erro no fetch de feedbacks");v(e.data.map((e=>e.dia)))}))),[t]),ne=(0,r.useCallback)((()=>{S(!0),Promise.all([oe(),re(),le()]).then((()=>{d([]),p([])})).catch((e=>console.error(e))).finally((()=>S(!1)))}),[oe,re,le]);if((0,r.useEffect)((()=>{ne()}),[ne]),k)return(0,I.jsx)(u.default,{style:{padding:20},children:"A carregar..."});const se=e=>x.find((t=>t.dia===Qe(e))),ie=o.filter((e=>!m.some((t=>Qe(t)===Qe(e.start))))),de=i.map((e=>({id:Qe(e),title:"",start:e,end:e,isManual:!0}))),ce=new Set([...ie.map((e=>Qe(e.start))),...de.map((e=>Qe(e.start)))]),ue=x.filter((e=>!ce.has(e.dia))).map((e=>({id:e.dia,title:"",start:new Date(e.dia+"T00:00:00"),end:new Date(e.dia+"T00:00:00"),hasMenu:!0}))),fe=[...ie,...de,...ue],me=e=>{const t=Ze(e),a=Qe(t),o=Ze(new Date),r=Ze(new Date(Date.now()+2592e6));if(t<o||t>r)return void ae("Data inv\xe1lida","S\xf3 entre hoje e 1 m\xeas depois.");if([0,6].includes(t.getDay()))return void ae("Data inv\xe1lida","N\xe3o \xe9 poss\xedvel marcar a senha da refei\xe7\xe3o aos fins de semana.");const l=se(t);if(l)return R(l),void P(!0);const n=ie.some((e=>Qe(e.start)===a)),s=i.some((e=>Qe(e)===a)),c=m.some((e=>Qe(e)===a));n||s?(n&&p((e=>[...e,t])),s&&d((e=>e.filter((e=>Qe(e)!==a))))):c?p((e=>e.filter((e=>Qe(e)!==a)))):d((e=>[...e,t]))},ge=()=>{const e=i.map((e=>Qe(e))),a=m.map((e=>Qe(e)));if(e.length+a.length===0)return void ae("Aten\xe7\xe3o","Nenhuma altera\xe7\xe3o.");window.confirm("Guardar altera\xe7\xf5es?")&&fetch(K,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,diasParaAdicionar:e,diasParaRemover:a})}).then((e=>e.json())).then((e=>{if(!e.success)throw new Error(e.message);ne(),ae("Sucesso","Altera\xe7\xf5es guardadas.")})).catch((e=>{console.error(e),ae("Erro","N\xe3o foi poss\xedvel guardar.")}))},he=Qe(new Date),pe=ie.some((e=>Qe(e.start)===he)),xe=C.includes(he);return(0,I.jsx)(h.default,{source:J?{uri:J}:a(8922),style:Ke.background,resizeMode:"cover",children:(0,I.jsxs)(n.default,{style:Ke.fullScreenContainer,children:[(0,I.jsxs)(n.default,{style:Ke.headerContainer,children:[(0,I.jsx)(b.default,{onPress:()=>e.navigate("Aluno",{email:t}),children:(0,I.jsx)(g.default,{source:a(7588),style:[Ke.icon,{tintColor:"dark"===U?"#FFF":"#000"}]})}),(0,I.jsx)(b.default,{onPress:()=>_(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:[Ke.icon,{tintColor:"dark"===U?"#FFF":"#000"}]})})]}),(0,I.jsxs)(f.default,{style:Ke.container,refreshControl:(0,I.jsx)(N.default,{refreshing:w,onRefresh:ne}),contentContainerStyle:{paddingTop:10,paddingBottom:20},children:[(0,I.jsx)(n.default,{style:[Ke.calendarWrapper,{backgroundColor:"dark"===U?"#000":"#FFF"}],children:(0,I.jsx)(q.Calendar,{events:fe,height:.4*M.default.get("window").width,mode:"month",weekStartsOn:1,showTime:!1,onPressCell:me,renderEvent:e=>{const t=Qe(e.start),a=(e.fromDB||e.isManual)&&!m.some((e=>Qe(e)===t)),o=e.hasMenu||!!se(e.start),r=Ke.webEventContainer;return(0,I.jsx)(b.default,{onPress:()=>me(e.start),children:a?(0,I.jsx)(n.default,{style:[Ke.selectedEventContainer,r],children:(0,I.jsx)(u.default,{style:[Ke.eventText,{color:"dark"===U?"#FFF":"#000"}],children:"\u2713"})}):o?(0,I.jsx)(n.default,{style:[Ke.menuEventContainer,r],children:(0,I.jsx)(u.default,{style:[Ke.eventText,{color:"dark"===U?"#FFF":"#000"}],children:"\ud83c\udf74"})}):null})}})}),(0,I.jsxs)(n.default,{style:Ke.buttonsRow,children:[pe&&!xe&&te>=12&&(0,I.jsx)(b.default,{style:Ke.smallFeedbackButton,onPress:()=>O(!0),children:(0,I.jsx)(u.default,{style:Ke.smallFeedbackButtonText,children:`Opini\xe3o (${he})`})}),(0,I.jsx)(n.default,{style:Ke.spacer}),(0,I.jsx)(b.default,{style:Ke.saveButton,onPress:()=>{(e=>{const t=new Date;t.setHours(0,0,0,0);const a=new Date(e);return a.setHours(0,0,0,0),a>t})(new Date)?ge():ae("Erro","N\xe3o \xe9 poss\xedvel marcar o almo\xe7o para hoje ou para datas passadas.")},children:(0,I.jsx)(u.default,{style:Ke.saveButtonText,children:"Guardar"})})]}),(0,I.jsx)(n.default,{style:Ke.selectedDatesWrapper,children:Array.from(ce).sort().map((e=>(0,I.jsx)(n.default,{style:[Ke.selectedDateItem,{backgroundColor:"dark"===U?"#222":"#e0e0e0"}],children:(0,I.jsx)(u.default,{style:{color:"dark"===U?"#FFF":"#000"},children:e})},e)))})]}),(0,I.jsx)(D.default,{visible:B,transparent:!0,animationType:"slide",onRequestClose:()=>P(!1),children:(0,I.jsx)(y.default,{onPress:()=>P(!1),children:(0,I.jsx)(n.default,{style:Ke.modalOverlay,children:(0,I.jsx)(y.default,{children:(0,I.jsxs)(n.default,{style:[Ke.modalContent,{backgroundColor:"dark"===U?"#333":"#FFF"}],children:[(0,I.jsx)(u.default,{style:[Ke.modalTitle,{color:"dark"===U?"#FFF":"#000"}],children:"Detalhes do Almo\xe7o"}),z&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:Ke.detailRow,children:[(0,I.jsx)(Ye.default,{icon:"bowl",size:20,iconColor:"dark"===U?"#FFF":"#000"}),(0,I.jsxs)(u.default,{style:[Ke.detailText,{color:"dark"===U?"#FFF":"#000"}],children:["Sopa: ",z.sopa]})]}),(0,I.jsxs)(n.default,{style:Ke.detailRow,children:[(0,I.jsx)(Ye.default,{icon:"food-variant",size:20,iconColor:"dark"===U?"#FFF":"#000"}),(0,I.jsxs)(u.default,{style:[Ke.detailText,{color:"dark"===U?"#FFF":"#000"}],children:["Prato: ",z.prato_principal]})]}),(0,I.jsxs)(n.default,{style:Ke.detailRow,children:[(0,I.jsx)(Ye.default,{icon:"cupcake",size:20,iconColor:"dark"===U?"#FFF":"#000"}),(0,I.jsxs)(u.default,{style:[Ke.detailText,{color:"dark"===U?"#FFF":"#000"}],children:["Sobremesa: ",z.sobremesa]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!z)return;const e=new Date(z.dia+"T00:00:00"),t=Qe(e),a=ie.some((e=>Qe(e.start)===t)),o=i.some((e=>Qe(e)===t));a&&p((t=>[...t,e])),o&&d((e=>e.filter((e=>Qe(e)!==t)))),a||o||d((t=>[...t,e])),P(!1),R(null)},style:Ke.modalActionButton,children:(ye=ie,ye.some((e=>Qe(e.start)===z.dia))?"Desmarcar":"Marcar")})]})]})})})})}),(0,I.jsx)(D.default,{visible:E,transparent:!0,animationType:"fade",onRequestClose:()=>{O(!1),H(null)},children:(0,I.jsx)(y.default,{onPress:()=>{O(!1),H(null)},children:(0,I.jsx)(n.default,{style:Ke.modalOverlay,children:(0,I.jsx)(y.default,{children:(0,I.jsxs)(n.default,{style:Ke.modalContent,children:[(0,I.jsx)(u.default,{style:Ke.modalTitle,children:"Avalie o almo\xe7o"}),(0,I.jsx)(n.default,{style:Ke.ratingRow,children:[0,1,2,3,4,5].map((e=>(0,I.jsx)(b.default,{onPress:()=>H(e),children:(0,I.jsx)(u.default,{style:[Ke.ratingNumber,W===e&&Ke.ratingSelected],children:e})},e)))}),(0,I.jsx)(Re.default,{style:Ke.textInput,placeholder:"Coment\xe1rio (opcional)",value:$,onChangeText:L,multiline:!0,numberOfLines:3}),(0,I.jsx)(T.default,{mode:"contained",disabled:null===W,onPress:()=>{if(null===W)return;const e=Qe(new Date);fetch(ee,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,dia:e,avaliacao:W,opiniao:$})}).then((e=>e.json())).then((t=>{if(!t.success)throw new Error(t.message);v((t=>[...t,e])),O(!1),ae("Obrigado","Feedback registado.")})).catch((e=>{console.error(e),ae("Erro","N\xe3o foi poss\xedvel enviar.")}))},style:Ke.modalActionButton,children:"Enviar"})]})})})})}),(0,I.jsx)(A,{visible:V,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>_(!1),navigation:e,email:t})]})});var ye};var et=a(7919);a(6214);const tt=m.default.create({safeArea:{flex:1},background:{flex:1},header:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,backgroundColor:"white"},filterButtonsContainer:{backgroundColor:"transparent"},tabsContainer:{flexDirection:"row",alignItems:"center",paddingVertical:10,paddingHorizontal:10},filterButton:{width:50,height:30,justifyContent:"center",alignItems:"center",backgroundColor:"#EEE",borderRadius:15,marginHorizontal:5},filterButtonActive:{backgroundColor:"#555"},filterText:{fontSize:16,color:"#333"},filterTextActive:{color:"#FFF"},listContainer:{flex:1,paddingHorizontal:16,paddingVertical:10},listContent:{paddingBottom:20},itemContainer:{padding:16,marginVertical:8,backgroundColor:"#FFF",borderRadius:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2,elevation:2},itemTitle:{fontSize:18,fontWeight:"600",marginBottom:6,color:"#333"},itemSub:{fontSize:14,color:"#666"},error:{color:"#FF3B30",fontSize:16,textAlign:"center",marginTop:10},previewContainer:{backgroundColor:"#FFF",borderTopLeftRadius:15,borderTopRightRadius:15,overflow:"hidden",marginHorizontal:4,marginBottom:8},previewHeader:{flexDirection:"row",justifyContent:"space-between",padding:15,borderBottomWidth:1,borderColor:"#EEE",backgroundColor:"#F5F5F5"},previewTitle:{fontSize:18,fontWeight:"600",color:"#333"},pdfContainer:{flex:1,backgroundColor:"#000"},controlsContainer:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingVertical:10,borderTopWidth:1,borderColor:"#DDD",backgroundColor:"#F9F9F9"},controlButton:{paddingVertical:10,paddingHorizontal:20,backgroundColor:"#47AD4D",borderRadius:5},controlButtonText:{color:"#FFF",fontSize:16},webInlinePreviewContainer:{padding:16,backgroundColor:"#FFF",marginHorizontal:16,marginBottom:16,borderRadius:10,shadowColor:"#000",shadowOpacity:.2,shadowRadius:2,elevation:2},webPreviewTitle:{fontSize:20,fontWeight:"600",marginBottom:10,textAlign:"center",color:"#333"},iframeContainer:{height:600,backgroundColor:"#ccc"},iframeStyle:{width:"100%",height:"100%"},webModalButton:{backgroundColor:"#47AD4D",paddingVertical:10,paddingHorizontal:20,borderRadius:5,width:"100%",alignItems:"center"},webModalButtonText:{color:"#FFF",fontSize:16}}),at=({navigation:e})=>{const t=(0,s.useRoute)(),{email:o}=t.params,i=(0,s.useTheme)(),[d,m]=(0,r.useState)(!1),[p,x]=(0,r.useState)([]),[y,j]=(0,r.useState)(null),[C,v]=(0,r.useState)(null),[w,S]=(0,r.useState)(i.dark?"dark":"light"),[T,k]=(0,r.useState)(null),[F,D]=(0,r.useState)(0),[B,P]=(0,r.useState)(""),[z,R]=(0,r.useState)(null),[E,O]=(0,r.useState)(null),[W,H]=(0,r.useState)(null),[$,L]=(0,r.useState)(null),[N,U]=(0,r.useState)(!1);(0,r.useRef)(new et.default.Value(0)).current,M.default.get("window").height;(0,r.useEffect)((()=>{R(null),O(null),H(null),L(null)}),[B]);const q=(0,r.useCallback)((async()=>{m(!0),j(null);try{const e=new FormData;e.append("email",o);const t=await fetch(`${c.baseUrl}/calendarioFiles/aluno/getCalendarByEmail.php`,{method:"POST",body:e}),a=await t.json();console.log("DEBUG: Resposta do fetchCalendarData:",a),a.success?x(a.data):j(a.message||"Erro ao buscar calend\xe1rios.")}catch(e){j("Erro na comunica\xe7\xe3o com o servidor.")}finally{m(!1)}}),[o]),G=(0,r.useCallback)((async()=>{try{let e=null,t=null;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),v(e),S("dark"===t?"dark":"light")}catch(e){console.log("Erro ao carregar configura\xe7\xf5es.",e)}finally{m(!1)}}),[]);(0,r.useEffect)((()=>{q()}),[q]),(0,r.useEffect)((()=>{G()}),[G]),(0,r.useEffect)((()=>{if(p.length>0){const e=p.find((e=>"ativo"===e.status));if(e){const t=parseInt(e.ano,10);D(t),k({turma:e.turma,ano_inicio:e.ano_inicio.toString(),ano_fim:e.ano_fim.toString()}),P(String(e.ano))}}}),[p]);const J=p.filter((e=>!!T&&(e.turma===T.turma&&e.ano_inicio.toString()===T.ano_inicio&&e.ano_fim.toString()===T.ano_fim&&String(e.ano)===B)));return(0,I.jsx)(_.default,{style:[tt.safeArea,{backgroundColor:"dark"===w?"#333":"#FFF"}],children:(0,I.jsxs)(h.default,{source:C?{uri:C}:a(8922),style:tt.background,resizeMode:"cover",children:[(0,I.jsxs)(n.default,{style:tt.header,children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===w?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>U(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===w?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(n.default,{style:tt.filterButtonsContainer,children:(()=>{if(10===F)return null;let e=11===F?["10","11"]:["10","11","12"];return(0,I.jsx)(f.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:tt.tabsContainer,children:e.map((e=>(0,I.jsx)(b.default,{style:[tt.filterButton,e===B&&tt.filterButtonActive],onPress:()=>P(e),children:(0,I.jsxs)(u.default,{style:[tt.filterText,e===B&&tt.filterTextActive],children:[e,"\xba"]})},e)))})})()}),(0,I.jsxs)(n.default,{style:tt.listContainer,children:[d&&(0,I.jsx)(l.default,{size:"large",color:"#007AFF"}),y&&(0,I.jsx)(u.default,{style:tt.error,children:y}),!d&&!y&&J.length>0?(0,I.jsx)(V.default,{data:J,keyExtractor:e=>e.id,renderItem:({item:e,index:t})=>(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(b.default,{style:tt.itemContainer,onPress:()=>{return t=e.pdf_url,void O(E===t?null:t);var t},children:[(0,I.jsxs)(u.default,{style:tt.itemTitle,children:["Hor\xe1rio de ",e.ano,"\xba - ",e.turma]}),(0,I.jsxs)(u.default,{style:tt.itemSub,children:["Data de Upload: ",e.data_de_upload]}),(0,I.jsxs)(u.default,{style:tt.itemSub,children:["Arquivo: ",e.pdf]})]}),!1,E===e.pdf_url&&(0,I.jsxs)(n.default,{style:tt.webInlinePreviewContainer,children:[(0,I.jsx)(u.default,{style:tt.webPreviewTitle,children:"Visualiza\xe7\xe3o do PDF"}),(0,I.jsx)(n.default,{style:tt.iframeContainer,children:(0,I.jsx)("iframe",{title:"PDF Viewer",src:`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(e.pdf_url)}#page=1`,style:tt.iframeStyle})}),(0,I.jsx)(b.default,{style:[tt.webModalButton,{backgroundColor:"#47AD4D",marginTop:15}],onPress:()=>{window.open(`https://mozilla.github.io/pdf.js/web/viewer.html?file=${encodeURIComponent(e.pdf_url)}`,"_blank")},children:(0,I.jsx)(u.default,{style:tt.webModalButtonText,children:"Abrir PDF completo"})})]})]}),contentContainerStyle:tt.listContent}):!d&&(0,I.jsxs)(u.default,{style:tt.error,children:["Nenhum calend\xe1rio para o ",B,"\xba ano."]})]}),(0,I.jsx)(A,{visible:N,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>U(!1),navigation:e,email:o})]})})};const ot="#47AD4D",rt="#E74C3C",lt="rgba(71,173,77,0.3)",nt="rgba(255,165,0,0.3)",st="rgba(255,0,0,0.3)",it="#999",dt="#e0dede",ct="#000",ut="rgba(0, 0, 0, 0.5)",ft=e=>{const[t,a]=e.split(" "),o=t.split("-");let r,l,n;4===o[0].length?[r,l,n]=o.map(Number):[n,l,r]=o.map(Number);let s=0,i=0,d=0;if(a){const e=a.split(":").map(Number);s=e[0]||0,i=e[1]||0,d=e[2]||0}return new Date(r,l-1,n,s,i,d)},mt=({viewMode:e,setViewMode:t,filterType:a,setFilterType:o,dynamicTextColor:r})=>(0,I.jsxs)(n.default,{style:gt.toolbarContainer,children:[(0,I.jsxs)(n.default,{style:gt.viewModeContainer,children:[(0,I.jsx)(b.default,{onPress:()=>t("list"),style:[gt.viewModeButton,"list"===e&&gt.viewModeButtonActive],children:(0,I.jsx)(u.default,{style:[gt.viewModeText,{color:r}],children:"Lista"})}),(0,I.jsx)(b.default,{onPress:()=>t("calendar"),style:[gt.viewModeButton,"calendar"===e&&gt.viewModeButtonActive],children:(0,I.jsx)(u.default,{style:[gt.viewModeText,{color:r}],children:"Calend\xe1rio"})})]}),(0,I.jsxs)(n.default,{style:gt.filterContainer,children:[(0,I.jsx)(b.default,{onPress:()=>o("todos"),style:[gt.filterButton,"todos"===a&&gt.filterButtonActive],children:(0,I.jsx)(u.default,{style:[gt.filterButtonText,{color:r}],children:"Todos"})}),(0,I.jsx)(b.default,{onPress:()=>o("entrada"),style:[gt.filterButton,"entrada"===a&&gt.filterButtonActive],children:(0,I.jsx)(u.default,{style:[gt.filterButtonText,{color:r}],children:"Entradas"})}),(0,I.jsx)(b.default,{onPress:()=>o("saida"),style:[gt.filterButton,"saida"===a&&gt.filterButtonActive],children:(0,I.jsx)(u.default,{style:[gt.filterButtonText,{color:r}],children:"Sa\xeddas"})})]})]}),gt=m.default.create({darkOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:ut,zIndex:1},loadingBackground:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,width:"97%",alignSelf:"center",marginTop:80,zIndex:2},centered:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{fontSize:18,marginTop:10},toolbarContainer:{paddingVertical:10,paddingHorizontal:15},viewModeContainer:{flexDirection:"row",justifyContent:"center",marginBottom:10},viewModeButton:{paddingVertical:8,paddingHorizontal:15,backgroundColor:"rgba(194,194,194,0.6)",borderRadius:20,marginHorizontal:5},viewModeButtonActive:{backgroundColor:"rgba(82,82,82,0.7)"},viewModeText:{fontWeight:"bold"},filterContainer:{flexDirection:"row",justifyContent:"center"},filterButton:{paddingVertical:8,paddingHorizontal:15,backgroundColor:"rgba(194,194,194,0.6)",borderRadius:20,marginHorizontal:5},filterButtonActive:{backgroundColor:"rgba(82,82,82,0.7)"},filterButtonText:{fontWeight:"bold"},listContent:{paddingBottom:20},dayContainer:{marginBottom:15,borderRadius:10,overflow:"hidden"},dayHeader:{padding:10,borderBottomWidth:2},dayHeaderText:{fontSize:18,fontWeight:"bold"},recordItem:{flexDirection:"row",justifyContent:"space-between",padding:10,marginHorizontal:2,marginVertical:3,borderRadius:5},recordText:{fontSize:16},calendarWrapper:{flex:1,margin:0,padding:0,backgroundColor:"transparent"},modalContainer:{flex:1,paddingTop:40},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:15},modalCalendarWrapper:{flex:1,backgroundColor:"transparent",margin:10},eventRectangle:{padding:5,borderRadius:5},eventRectangleText:{color:"#fff",fontSize:12},toast:{position:"absolute",top:5,alignSelf:"center",backgroundColor:"rgba(0,0,0,0.7)",paddingVertical:5,paddingHorizontal:15,borderRadius:20,zIndex:1e3},toastText:{color:"#fff",fontSize:14}}),ht=({navigation:e})=>{const t=(0,s.useRoute)(),{email:o}=t.params,i=`${c.baseUrl}/calendarioFiles/entradasSaidas/getEntradasEsaidas.php`,[d,f]=(0,r.useState)([]),[m,p]=(0,r.useState)("todos"),[x,y]=(0,r.useState)("list"),[j,C]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[S,k]=(0,r.useState)(""),[F,B]=(0,r.useState)(null),[P,z]=(0,r.useState)("light"),[R,E]=(0,r.useState)(!0),[O,_]=(0,r.useState)(!1);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),B(e),z("dark"===t?"dark":"light")}catch(e){}finally{E(!1)}}()}),[]);const W="dark"===P?dt:ct,H="dark"===P?"#000":"#fff";(0,r.useEffect)((()=>{e.setOptions({headerTitle:"Entradas e Sa\xeddas",headerLeft:()=>(0,I.jsx)(T.default,{onPress:()=>e.goBack(),mode:"text",contentStyle:{padding:8},icon:()=>(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,tintColor:W,marginTop:30}}),style:{alignSelf:"flex-start"},children:""})})}),[e,W]),(0,r.useEffect)((()=>{$()}),[]);const $=async()=>{try{const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),t=await e.json();if(t.success){const e=t.days.sort(((e,t)=>ft(t.date).getTime()-ft(e.date).getTime())).map((e=>{const t=e.records.sort(((e,t)=>ft(t.data_do_registo).getTime()-ft(e.data_do_registo).getTime()));return Object.assign({},e,{records:t})}));f(e)}}catch(e){}},L=({item:e})=>{if("todos"!==m&&e.type!==m)return null;const t="entrada"===e.type?ot:rt;return(0,I.jsxs)(n.default,{style:[gt.recordItem,{backgroundColor:t}],children:[(0,I.jsx)(u.default,{style:[gt.recordText,{color:"#fff"}],children:e.type.toUpperCase()}),(0,I.jsx)(u.default,{style:[gt.recordText,{color:"#fff"}],children:e.data_do_registo})]})},N=({item:e})=>{let t=lt;"demasia"===e.status?t=nt:"demasiadas"===e.status&&(t=st);const a="todos"===m?e.records:e.records.filter((e=>e.type===m)),o=e.status.charAt(0).toUpperCase()+e.status.slice(1).toLowerCase();return(0,I.jsxs)(n.default,{style:[gt.dayContainer,{backgroundColor:t}],children:[(0,I.jsx)(n.default,{style:gt.dayHeader,children:(0,I.jsxs)(u.default,{style:[gt.dayHeaderText,{color:W}],children:[e.date," - ",o]})}),(0,I.jsx)(V.default,{data:a,keyExtractor:e=>e.id.toString(),renderItem:L,scrollEnabled:!1})]})},M=[];d.forEach((e=>{e.records.forEach((e=>{const t=ft(e.data_do_registo),a=new Date(t.getTime()+18e5),o=`${e.type.toUpperCase()} - ${t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`;M.push({title:o,start:t,end:a,color:"entrada"===e.type?ot:rt})}))}));const U="todos"===m?M:M.filter((e=>e.title.toLowerCase().includes(m))),G=[],J=U.reduce(((e,t)=>{const a=t.start.toISOString().split("T")[0];return e[a]||(e[a]=[]),e[a].push(t),e}),{});Object.keys(J).forEach((e=>{const t=J[e].sort(((e,t)=>t.start.getTime()-e.start.getTime()));if(t.length>2){const e=new Date(t[1].start.getTime()-1),a=new Date(e.getTime()+18e5);G.push(t[0],t[1],{title:"...",start:e,end:a,color:it})}else G.push(...t)}));const Y=v?M.filter((e=>e.start.toISOString().split("T")[0]===v.toISOString().split("T")[0])):[];return R||!d.length?(0,I.jsxs)(h.default,{source:F?{uri:F}:a(8922),style:gt.loadingBackground,children:["dark"===P&&(0,I.jsx)(n.default,{style:gt.darkOverlay}),(0,I.jsx)(n.default,{style:gt.centered,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})})]}):(0,I.jsxs)(h.default,{source:F?{uri:F}:a(8922),style:{flex:1},children:["dark"===P&&(0,I.jsx)(n.default,{style:gt.darkOverlay}),(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===P?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>_(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===P?"#FFFFFF":"#000"}})})]}),(0,I.jsxs)(n.default,{style:gt.container,children:[(0,I.jsx)(mt,{viewMode:x,setViewMode:y,filterType:m,setFilterType:p,dynamicTextColor:W}),"list"===x?(0,I.jsx)(V.default,{data:d,keyExtractor:e=>e.date,renderItem:N,contentContainerStyle:gt.listContent}):(0,I.jsxs)(n.default,{style:gt.calendarWrapper,children:[""!==S&&(0,I.jsx)(n.default,{style:gt.toast,children:(0,I.jsx)(u.default,{style:gt.toastText,children:S})}),(0,I.jsx)(n.default,{style:{backgroundColor:"dark"===P?"rgba(0, 0, 0, 0.7)":"#fff",height:500,borderRadius:5,overflow:"hidden"},children:(0,I.jsx)(q.Calendar,{events:G,height:500,mode:"month",swipeEnabled:!0,weekStartsOn:1,showTime:!1,onPressCell:e=>{const t=new Date(e),a=t.getDay();if(0===a||6===a)return k("N\xe3o pode selecionar um fim de semana"),void setTimeout((()=>k("")),2e3);w(t),C(!0)},calendarContainerStyle:{height:500,borderRadius:5,overflow:"hidden"},headerContainerStyle:{backgroundColor:"dark"===P?"rgba(0, 0, 0, 0.5)":"#fff",borderTopLeftRadius:5,borderTopRightRadius:5,overflow:"hidden"},renderEvent:e=>(0,I.jsx)(n.default,{style:[gt.eventRectangle,{backgroundColor:e.color}],children:(0,I.jsx)(u.default,{style:gt.eventRectangleText,numberOfLines:1,children:e.title})})})})]})]}),(0,I.jsx)(D.default,{visible:j,animationType:"slide",children:(0,I.jsxs)(n.default,{style:[gt.modalContainer,{backgroundColor:H}],children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>C(!1),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===P?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>_(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===P?"#FFFFFF":"#000"}})})]}),v&&(0,I.jsx)(n.default,{style:gt.modalCalendarWrapper,children:(0,I.jsx)(q.Calendar,{date:v,events:Y,height:500,mode:"day",swipeEnabled:!0,showTime:!1,eventCellStyle:e=>({backgroundColor:e.color,height:20,marginVertical:2,paddingHorizontal:2,borderRadius:3}),headerContainerStyle:Object.assign({backgroundColor:H,height:40,justifyContent:"center",alignItems:"center"},"dark"===P&&{borderWidth:1,borderColor:"#fff",borderRadius:20,paddingHorizontal:10}),calendarContainerStyle:{backgroundColor:"transparent"}})})]})}),(0,I.jsx)(A,{visible:O,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>_(!1),navigation:e,email:o})]})};const pt=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}],xt=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),a=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-a);const o=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-o.getTime())/864e5+1)/7)},yt=(e,t,a)=>{if(a)return"day";if(e.toDateString()===t.toDateString())return"day";const o=xt(e),r=xt(t);if(6===e.getDay()&&1===t.getDay())return"month";if(o===r)return"week";return(t.getTime()-e.getTime())/864e5>7?"month":"week"},bt=m.default.create({loadingText:{marginTop:16,fontSize:16,color:"#000",textAlign:"center"},background:{flex:1},scrollContainer:{flexGrow:1,padding:5,marginTop:70,paddingBottom:100},formContainer:{flex:1,alignSelf:"stretch"},innerScroll:{flexGrow:1},previewContainer:{flex:1},previewDetails:{marginVertical:15},previewText:{fontSize:16,marginVertical:2,color:"#000"},title:{fontSize:22,fontWeight:"bold",marginBottom:15,textAlign:"center"},input:{marginBottom:15,backgroundColor:"#f5f5f5",color:"#000",borderRadius:8,paddingHorizontal:10},inputGroup:{marginBottom:10},picker:{backgroundColor:"#f5f5f5",color:"#000"},label:{marginBottom:5,fontWeight:"bold"},button:{borderRadius:8},errorText:{color:"red",textAlign:"center",marginBottom:10},successText:{color:"green",textAlign:"center",marginBottom:10},infoText:{color:"red",textAlign:"center",marginBottom:10},loaderContainer:{flex:1,justifyContent:"center",alignItems:"center"},colorModalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},colorModalContainer:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modalContainer:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20,maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",marginBottom:10},colorCircle:{width:30,height:30,borderRadius:15,marginRight:10},colorName:{fontSize:16},modalCloseButton:{backgroundColor:"#47AD4D",marginTop:10},selectedColorDisplay:{flexDirection:"row",alignItems:"center",marginTop:10},colorText:{fontSize:16,color:"#47AD4D"},backButton:{alignSelf:"flex-start"},errorBorder:{borderWidth:1,borderColor:"red",borderRadius:8,marginBottom:10},turmaRow:{flexDirection:"row",alignItems:"center",paddingVertical:5},selectedTurmaRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:"#ccc",padding:8,borderRadius:8,marginVertical:3},addTurmaButton:{borderRadius:8,marginVertical:10},noTurmaOverlay:{flex:1,backgroundColor:"rgba(255, 255, 255, 0.5)",justifyContent:"center",alignItems:"center"},noTurmaModal:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20,alignItems:"center"},noTurmaText:{fontSize:16,textAlign:"center",marginBottom:20},noTurmaButton:{backgroundColor:"#47AD4D"}}),jt=()=>{const e=(0,j.useTheme)(),t=(0,s.useNavigation)(),o=(0,s.useRoute)(),{email:i}=o.params,d=`${c.baseUrl}/calendarioFiles/professor/eventos/add_event.php`,u=`${c.baseUrl}/calendarioFiles/professor/tarefas/add_task.php`,m=`${c.baseUrl}/calendarioFiles/professor/fetchProfessorInfo.php`,[p,x]=(0,r.useState)({title:"",description:""}),[y,C]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[k,F]=(0,r.useState)(""),P="Tarefa"===k,[z,R]=(0,r.useState)("#DC143C"),[E,V]=(0,r.useState)(!1),[_,H]=(0,r.useState)(new Date),[$,L]=(0,r.useState)(new Date),[N,M]=(0,r.useState)(new Date),[U,G]=(0,r.useState)(new Date),[J,Y]=(0,r.useState)(!1),[Z,Q]=(0,r.useState)(!1),[K,X]=(0,r.useState)(!1),[ee,oe]=(0,r.useState)(!1),[re,le]=(0,r.useState)([]),[ne,se]=(0,r.useState)([]),[ie,de]=(0,r.useState)(!1),[ce,ue]=(0,r.useState)(""),[fe,me]=(0,r.useState)(""),[ge,he]=(0,r.useState)(!1),[pe,xe]=(0,r.useState)({}),[ye,be]=(0,r.useState)(!1),[je,Ce]=(0,r.useState)(null),[ve,we]=(0,r.useState)(e.dark?"dark":"light"),[Se,Te]=(0,r.useState)(!1);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),Ce(e),we("dark"===t?"dark":"light")}catch(ce){console.log("Erro ao carregar configura\xe7\xf5es.",ce)}finally{be(!1)}}()}),[]);const ke=0===re.length,Fe=e=>{ue(e),window.alert(e)},De=e=>e.toLocaleDateString("pt-PT"),Be=e=>e.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"});(0,r.useEffect)((()=>{B.default.post(m,{email:i}).then((e=>{console.log("Response:",e.data),e.data&&Array.isArray(e.data.turmas)?le(e.data.turmas):le([])})).catch((()=>{le([])}))}),[i]),(0,r.useEffect)((()=>{y?"Trabalho de casa"===y?k||F("Tarefa"):k||F("Evento"):F("")}),[y]);const Ie=e=>{ne.some((t=>t.turma===e.turma&&t.ano===e.ano))?se(ne.filter((t=>!(t.turma===e.turma&&t.ano===e.ano)))):se([...ne,e])},Pe=()=>{const e={email:i||"",title:p.title,description:p.description.trim()?p.description:"",category:"Outro"===y?v:y,type:k,color:z};if(P?e.data_da_tarefa=`${De(_)} ${Be($)}`:(e.start_date=De(_),e.start_time=Be($),e.end_date=De(N),e.end_time=Be(U)),!(ne.length>0))return void Fe("Pedimos que selecione pelo menos uma turma.");e.turma=ne[0].turma,e.ano=ne[0].ano;const a=P?u:d;B.default.post(a,e).then((e=>{var a;if(!0===e.data.success){me(a=P?"Voc\xea conseguiu criar uma nova tarefa com sucesso!":"Voc\xea conseguiu criar um novo evento com sucesso!"),window.alert(a),setTimeout((()=>{t.goBack()}),1e3)}else Fe(e.data.message||"Ocorreu um erro ao tentar adicionar um novo evento/tarefa, pedimos que tente novamente mais tarde.")})).catch((()=>{Fe("Erro ao adicionar. Tente novamente mais tarde.")}))};let Ae=new Date(_),ze=new Date(_);if(P){const e=$.getHours(),t=$.getMinutes();ze.setHours(e,t,0,0),0===e&&t<30?(Ae=new Date(ze.getTime()),ze=new Date(ze.getTime()+18e5)):Ae=new Date(ze.getTime()-18e5)}const Re=[{title:`${p.title} - ${Be($)}`,start:P?Ae:new Date(_.getFullYear(),_.getMonth(),_.getDate(),$.getHours(),$.getMinutes()),end:P?ze:new Date(N.getFullYear(),N.getMonth(),N.getDate(),U.getHours(),U.getMinutes()),color:z}],Ee="dark"===ve?"#e0dede":"#000";return ye?(0,I.jsxs)(h.default,{source:je?{uri:je}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===ve&&(0,I.jsx)(n.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1}}),(0,I.jsx)(n.default,{style:{alignItems:"center"},children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})})]}):ge?(0,I.jsxs)(h.default,{source:je?{uri:je}:a(8922),style:bt.background,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#ddd"},children:[(0,I.jsx)(b.default,{onPress:()=>{t.goBack()},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===ve?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>Te(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===ve?"#FFFFFF":"#000"}})})]}),(0,I.jsxs)(f.default,{contentContainerStyle:bt.scrollContainer,children:[(0,I.jsx)(q.Calendar,{date:_,events:Re,height:500,mode:yt(_,P?_:N,P),swipeEnabled:!0,showTime:!1,eventCellStyle:e=>e.color?{backgroundColor:e.color}:{}}),(0,I.jsxs)(n.default,{style:bt.previewDetails,children:[(0,I.jsxs)(W.default,{style:bt.previewText,children:["T\xedtulo: ",p.title]}),P?(0,I.jsxs)(W.default,{style:bt.previewText,children:["Data da Tarefa: ",De(_)," \xe0s ",Be($)]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(W.default,{style:bt.previewText,children:["In\xedcio: ",De(_)," \xe0s ",Be($)]}),(0,I.jsxs)(W.default,{style:bt.previewText,children:["Fim: ",De(N)," \xe0s ",Be(U)]})]}),(0,I.jsxs)(W.default,{style:bt.previewText,children:["Turmas Selecionadas:"," ",ne.map(((e,t)=>(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma,t<ne.length-1?", ":""]},t)))]}),(0,I.jsxs)(W.default,{style:bt.previewText,children:["Categoria: ","Outro"===y?v:y]}),(0,I.jsxs)(W.default,{style:bt.previewText,children:["Tipo: ",k]}),(0,I.jsxs)(n.default,{style:bt.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[bt.colorCircle,{backgroundColor:z}]}),(0,I.jsx)(W.default,{style:bt.previewText,children:"Cor Selecionada"})]})]}),ce?(0,I.jsx)(W.default,{style:bt.errorText,children:ce}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:Pe,style:[bt.button,{backgroundColor:"#47AD4D"}],children:"Confirmar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>he(!1),style:[bt.button,{backgroundColor:"red",marginTop:10}],children:"Editar"})]})]}):(0,I.jsxs)(h.default,{source:je?{uri:je}:a(8922),style:bt.background,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===ve?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>Te(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===ve?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(f.default,{contentContainerStyle:bt.scrollContainer,children:(0,I.jsxs)(n.default,{style:bt.formContainer,children:[0===re.length&&(0,I.jsx)(W.default,{style:bt.infoText,children:"Nenhuma turma encontrada para si. Por favor, pedimos que tente mais tarde, ou pe\xe7a para ter uma turma."}),(0,I.jsxs)(f.default,{style:bt.innerScroll,contentContainerStyle:{paddingBottom:100},nestedScrollEnabled:!0,children:[(0,I.jsx)(n.default,{style:[bt.inputGroup,pe.category&&bt.errorBorder],children:(0,I.jsxs)(te.Picker,{selectedValue:y,onValueChange:e=>{C(e),"Outro"!==e&&w(""),F("")},style:bt.picker,children:[(0,I.jsx)(te.Picker.Item,{label:"Selecione a categoria",value:""}),(0,I.jsx)(te.Picker.Item,{label:"Teste",value:"Teste"}),(0,I.jsx)(te.Picker.Item,{label:"Trabalho de casa",value:"Trabalho de casa"}),(0,I.jsx)(te.Picker.Item,{label:"Atividade",value:"Atividade"}),(0,I.jsx)(te.Picker.Item,{label:"Visita de estudo",value:"Visita de estudo"}),(0,I.jsx)(te.Picker.Item,{label:"Outro",value:"Outro"})]})}),""!==y&&(0,I.jsxs)(I.Fragment,{children:["Outro"===y&&(0,I.jsx)(n.default,{style:[bt.inputGroup,pe.customCategory&&bt.errorBorder],children:(0,I.jsx)(S.default,{label:"Categoria personalizada *",value:v,onChangeText:e=>w(e),mode:"outlined",error:!!pe.customCategory,style:bt.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}})}),(0,I.jsx)(n.default,{style:[bt.inputGroup,pe.type&&bt.errorBorder],children:(0,I.jsxs)(te.Picker,{selectedValue:k,onValueChange:e=>F(e),style:bt.picker,children:[(0,I.jsx)(te.Picker.Item,{label:"Evento",value:"evento"}),(0,I.jsx)(te.Picker.Item,{label:"Tarefa",value:"Tarefa"})]})}),(0,I.jsx)(n.default,{style:bt.inputGroup,children:(0,I.jsxs)(b.default,{onPress:()=>V(!0),style:bt.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[bt.colorCircle,{backgroundColor:z}]}),(0,I.jsx)(W.default,{style:bt.colorText,children:"Cor Selecionada"})]})}),(0,I.jsx)(S.default,{label:"T\xedtulo *",value:p.title,onChangeText:e=>x(Object.assign({},p,{title:e})),mode:"outlined",error:!!pe.title,style:bt.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),(0,I.jsx)(n.default,{style:bt.inputGroup,children:(0,I.jsx)(S.default,{label:"Descri\xe7\xe3o",value:p.description,onChangeText:e=>x(Object.assign({},p,{description:e})),mode:"outlined",style:bt.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}})})]}),(0,I.jsxs)(n.default,{style:bt.inputGroup,children:[(0,I.jsx)(S.default,{label:P?"Data da Tarefa *":"Data de In\xedcio *",value:De(_),mode:"outlined",style:bt.input,editable:!1,onPressIn:()=>Y(!0),right:(0,I.jsx)(S.default.Icon,{icon:"calendar",onPress:()=>Y(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),J&&(0,I.jsx)(ae.default,{value:_,mode:"date",display:"calendar",onChange:(e,t)=>{Y(!1),"dismissed"!==e.type&&t&&H(t)}})]}),(0,I.jsxs)(n.default,{style:bt.inputGroup,children:[(0,I.jsx)(S.default,{label:P?"Hora da Tarefa *":"Hora de In\xedcio *",value:Be($),mode:"outlined",style:bt.input,editable:!1,onPressIn:()=>Q(!0),right:(0,I.jsx)(S.default.Icon,{icon:"clock",onPress:()=>Q(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),Z&&(0,I.jsx)(ae.default,{value:$,mode:"time",display:"clock",is24Hour:!0,onChange:(e,t)=>{Q(!1),"dismissed"!==e.type&&t&&L(t)}})]}),!P&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:bt.inputGroup,children:[(0,I.jsx)(S.default,{label:"Data de Fim *",value:De(N),mode:"outlined",style:bt.input,editable:!1,onPressIn:()=>X(!0),right:(0,I.jsx)(S.default.Icon,{icon:"calendar",onPress:()=>X(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),K&&(0,I.jsx)(ae.default,{value:N,mode:"date",display:"calendar",onChange:(e,t)=>{X(!1),"dismissed"!==e.type&&t&&M(t)}})]}),(0,I.jsxs)(n.default,{style:bt.inputGroup,children:[(0,I.jsx)(S.default,{label:"Hora de Fim *",value:Be(U),mode:"outlined",style:bt.input,editable:!1,onPressIn:()=>oe(!0),right:(0,I.jsx)(S.default.Icon,{icon:"clock",onPress:()=>oe(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),ee&&(0,I.jsx)(ae.default,{value:U,mode:"time",display:"clock",is24Hour:!0,onChange:(e,t)=>{oe(!1),"dismissed"!==e.type&&t&&G(t)}})]})]}),ne.length>0&&(0,I.jsxs)(n.default,{style:bt.inputGroup,children:[(0,I.jsx)(W.default,{style:bt.label,children:"Turmas Selecionadas:"}),ne.map(((e,t)=>(0,I.jsxs)(n.default,{style:bt.selectedTurmaRow,children:[(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma]}),(0,I.jsx)(Ye.default,{icon:"close",size:20,onPress:()=>Ie(e)})]},t)))]}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>de(!0),style:bt.addTurmaButton,labelStyle:{color:"#47AD4D"},children:"+ Adicionar turma"}),ce?(0,I.jsx)(W.default,{style:bt.errorText,children:ce}):null,fe?(0,I.jsx)(W.default,{style:bt.successText,children:fe}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{const e=(()=>{const e={};return P?(y||(e.category=!0),"Outro"!==y||v.trim()||(e.customCategory=!0),p.title.trim()||(e.title=!0),_||(e.startDate=!0),$||(e.startTime=!0)):(p.title.trim()||(e.title=!0),_||(e.startDate=!0),$||(e.startTime=!0),N||(e.endDate=!0),U||(e.endTime=!0),0===ne.length&&(e.turmas=!0)),e})();if(Object.keys(e).length>0)return xe(e),void Fe("Por favor, preencha todos os campos obrigat\xf3rios.");if(xe({}),!P){const e=new Date(_.getFullYear(),_.getMonth(),_.getDate(),$.getHours(),$.getMinutes()),t=new Date(N.getFullYear(),N.getMonth(),N.getDate(),U.getHours(),U.getMinutes());if(e>t||e.getTime()===t.getTime())return void O.default.alert("Erro de Data/Hora","A data e hora de in\xedcio n\xe3o pode ser posterior ou igual \xe0 data e hora de fim.");t<e&&(M(_),G($))}ue("");const t=((e,t,a,o)=>{const r=[],l=e=>({hours:e.getHours(),minutes:e.getMinutes()});if(o){const{hours:e,minutes:a}=l(t);(e>17||17===e&&a>=15)&&r.push("A hora da tarefa \xe9 ap\xf3s 17:15.")}else{const{hours:e,minutes:o}=l(t),{hours:n,minutes:s}=l(a);(e>17||17===e&&o>=15)&&r.push("A hora de in\xedcio \xe9 ap\xf3s 17:15."),(n>17||17===n&&s>=15)&&r.push("A hora de fim \xe9 ap\xf3s 17:15.")}const n=e.getDay();return 0!==n&&6!==n||r.push("A data selecionada \xe9 no fim de semana."),r})(_,$,U,P);if(t.length>0){const e=t.join("\n")+"\nTem certeza que deseja continuar?";O.default.alert("Aviso",e,[{text:"Cancelar",style:"cancel"},{text:"Continuar",onPress:()=>he(!0)}])}else he(!0)},style:[bt.button,{backgroundColor:"#47AD4D"}],children:"Visualizar Preview"})]})]})}),(0,I.jsx)(D.default,{visible:ie,onRequestClose:()=>de(!1),animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:bt.modalOverlay,children:(0,I.jsxs)(n.default,{style:bt.modalContainer,children:[(0,I.jsx)(W.default,{style:bt.modalTitle,children:"Selecione uma Turma"}),0===re.length?(0,I.jsx)(W.default,{style:bt.infoText,children:"N\xe3o h\xe1 turmas dispon\xedveis para este professor."}):(0,I.jsx)(f.default,{children:re.map(((e,t)=>(0,I.jsx)(b.default,{style:bt.turmaRow,onPress:()=>{Ie(e),de(!1)},children:(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma]})},t)))}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>de(!1),style:bt.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:E,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:bt.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:bt.colorModalContainer,children:[(0,I.jsx)(W.default,{style:[bt.modalTitle,{color:"#000"}],children:"Selecionar Cor"}),pt.map((e=>(0,I.jsxs)(b.default,{style:bt.colorOptionRow,onPress:()=>{R(e.value),V(!1)},children:[(0,I.jsx)(n.default,{style:[bt.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{style:[bt.colorName,{color:"#000"}],children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>V(!1),style:bt.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:ke,animationType:"fade",transparent:!0,children:(0,I.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},children:(0,I.jsxs)(n.default,{style:{width:"80%",backgroundColor:"dark"===ve?"#333":"#fff",padding:20,borderRadius:8,alignItems:"center"},children:[(0,I.jsx)(l.default,{size:"large",color:"#47AD4D",style:{marginBottom:16}}),(0,I.jsx)(W.default,{style:{fontSize:16,textAlign:"center",marginBottom:24,color:Ee},children:"N\xe3o \xe9 poss\xedvel criar nenhum evento porque n\xe3o foram encontradas turmas."}),(0,I.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",width:"100%"},children:[(0,I.jsx)(b.default,{onPress:()=>de(!1),style:{flex:1,backgroundColor:"#47AD4D",paddingVertical:10,borderRadius:6,alignItems:"center",marginRight:8},children:(0,I.jsx)(W.default,{style:{color:"#fff",fontWeight:"bold"},children:"Tentar novamente"})}),(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{padding:10,justifyContent:"center",alignItems:"center"},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:24,height:24,tintColor:"#47AD4D"}})})]})]})})}),(0,I.jsx)(A,{visible:Se,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>Te(!1),navigation:t,email:i})]})};var Ct=a(1258);const vt=`${c.baseUrl}/calendarioFiles/professor/notas/saveNote.php`,wt=`${c.baseUrl}/calendarioFiles/professor/fetchProfessorInfo.php`,St=`${c.baseUrl}/calendarioFiles/professor/fetch_turmas.php`,Tt=`${c.baseUrl}/calendarioFiles/professor/fetchStudents.php`,kt=`${c.baseUrl}/calendarioFiles/professor/fetchModulos.php`,Ft=m.default.create({wrapper:{flex:1},header:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#ddd"},icon:{width:35,height:35,marginLeft:3,marginTop:-15},loaderContainer:{flex:1,justifyContent:"center",alignItems:"center"},scrollContent:{paddingTop:80,paddingHorizontal:16,paddingBottom:16},contentWrapper:{backgroundColor:"#fff",borderRadius:8,padding:16,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:3,elevation:2},title:{fontSize:26,fontWeight:"bold",marginBottom:20,color:"#333",textAlign:"center"},label:{fontSize:16,marginBottom:8,color:"#555",fontWeight:"500"},turmaContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:20,justifyContent:"center"},turmaButton:{margin:4},turmaButtonSelected:{backgroundColor:"#47AD4D",borderColor:"#47AD4D"},turmaButtonLabel:{color:"#47AD4D"},turmaButtonLabelSel:{color:"#FFF"},moduloContainer:{flexDirection:"row",flexWrap:"wrap",marginBottom:20,justifyContent:"center"},moduloButton:{margin:4},moduloButtonSelected:{backgroundColor:"#47AD4D",borderColor:"#47AD4D"},moduloButtonLabel:{color:"#47AD4D"},moduloButtonLabelSelected:{color:"#FFF"},moduloButtonContent:{paddingVertical:6,paddingHorizontal:12},alunoContainer:{marginBottom:16,padding:16,backgroundColor:"#FFF",borderRadius:8,elevation:3},alunoHeader:{flexDirection:"row",alignItems:"center",marginBottom:8},alunoEmail:{marginLeft:8,fontSize:16,color:"#333",fontWeight:"500"},alunoForm:{marginTop:8},input:{marginBottom:12,backgroundColor:"white"},comentarioInput:{height:80,textAlignVertical:"top"},saveButton:{marginTop:20,backgroundColor:"#47AD4D"},infoText:{fontSize:16,marginBottom:20,textAlign:"center",color:"#888"}}),Dt=({route:e,navigation:t})=>{const{email:o}=e.params,s=(0,j.useTheme)(),[i,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(s.dark?"dark":"light"),[p,x]=(0,r.useState)(!0),[y,C]=(0,r.useState)(!0),[v,w]=(0,r.useState)(!1),[k,F]=(0,r.useState)(!1),[D,P]=(0,r.useState)(null),[z,R]=(0,r.useState)(""),[E,V]=(0,r.useState)(null),[_,H]=(0,r.useState)([]),[$,L]=(0,r.useState)(null),[N,M]=(0,r.useState)([]),[U,q]=(0,r.useState)(""),[G,J]=(0,r.useState)([]),[Y,Z]=(0,r.useState)(!1),[Q,K]=(0,r.useState)("");function X(e,t){K(`${e}: ${t}`),Z(!0)}(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),d(e),m("dark"===t?"dark":"light")}finally{x(!1)}})()}),[]),(0,r.useEffect)((()=>{(async()=>{C(!0);try{const e=await B.default.post(wt,{email:o});if(!e.data.success)throw new Error(e.data.message);V({user_id:e.data.professor.user_id,disciplina:e.data.professor.disciplina});const t=await B.default.post(St,{email:o});if(!t.data.success)throw new Error(t.data.message);H(t.data.turmas)}catch(e){X("Erro",e.message)}finally{C(!1)}})()}),[o]),(0,r.useEffect)((()=>{E&&$&&B.default.post(kt,{professor_id:E.user_id,disciplina:E.disciplina,turma_id:$.id}).then((e=>{if(!e.data.success)throw new Error(e.data.message);M(e.data.modulos),q("")})).catch((e=>X("Erro",e.message)))}),[E,$]),(0,r.useEffect)((()=>{E&&$&&U&&(async()=>{try{const e=await B.default.post(Tt,{professor_id:E.user_id,disciplina:E.disciplina,turma:$.turma,ano:$.ano,modulo:U});if(!e.data.success)throw new Error(e.data.message);J((e.data.students||[]).map((e=>Object.assign({},e,{selected:!1}))))}catch(e){X("Erro",e.message),J([])}})()}),[E,$,U]);if(p||y||v){const e="dark"===u?"#e0dede":"#000";return(0,I.jsxs)(h.default,{source:i?{uri:i}:a(8922),style:Ft.loaderContainer,children:[(0,I.jsx)(l.default,{size:"large",color:e}),(0,I.jsx)(W.default,{style:{marginTop:12,color:e,fontSize:16},children:"Carregando\u2026"})]})}return(0,I.jsxs)(h.default,{source:i?{uri:i}:a(8922),style:Ft.wrapper,children:[(0,I.jsxs)(n.default,{style:Ft.header,children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:[Ft.icon,{tintColor:"dark"===u?"#FFF":"#000"}]})}),(0,I.jsx)(b.default,{onPress:()=>F(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:[Ft.icon,{tintColor:"dark"===u?"#FFF":"#000"}]})})]}),(0,I.jsx)(f.default,{contentContainerStyle:Ft.scrollContent,children:(0,I.jsxs)(n.default,{style:Ft.contentWrapper,children:[(0,I.jsx)(W.default,{style:Ft.title,children:"Atribui\xe7\xe3o de Notas"}),(0,I.jsx)(W.default,{style:Ft.label,children:"Selecione a Turma:"}),(0,I.jsx)(n.default,{style:Ft.turmaContainer,children:_.map((e=>{const t=$?.id===e.id;return(0,I.jsxs)(T.default,{mode:t?"contained":"outlined",onPress:()=>L(e),style:[Ft.turmaButton,t&&Ft.turmaButtonSelected],labelStyle:t?Ft.turmaButtonLabelSel:Ft.turmaButtonLabel,children:[e.ano," - ",e.turma]},e.id)}))}),(0,I.jsx)(W.default,{style:Ft.label,children:"Selecione o M\xf3dulo:"}),(0,I.jsx)(n.default,{style:Ft.moduloContainer,children:N.length>0?N.map(((e,t)=>{const a=`${e.numero_do_modulo}\xba \u2014 ${e.nome}`,o=U===e.nome;return(0,I.jsx)(T.default,{mode:o?"contained":"outlined",onPress:()=>{q(e.nome),P(e.numero_do_modulo)},style:[Ft.moduloButton,o&&Ft.moduloButtonSelected],labelStyle:o?Ft.moduloButtonLabelSelected:Ft.moduloButtonLabel,contentStyle:Ft.moduloButtonContent,children:a},t)})):(0,I.jsx)(W.default,{style:Ft.infoText,children:"Nenhum m\xf3dulo dispon\xedvel."})}),G.length>0?G.map(((e,t)=>(0,I.jsxs)(n.default,{style:Ft.alunoContainer,children:[(0,I.jsxs)(n.default,{style:Ft.alunoHeader,children:[(0,I.jsx)(b.default,{onPress:()=>{const e=[...G];e[t].selected=!e[t].selected,J(e)},style:{padding:4},children:(0,I.jsx)(Ct.default,{name:e.selected?"checkbox-marked":"checkbox-blank-outline",size:24,color:s.colors.primary})}),(0,I.jsx)(W.default,{style:Ft.alunoEmail,children:e.email})]}),e.selected&&(0,I.jsxs)(n.default,{style:Ft.alunoForm,children:[(0,I.jsx)(S.default,{label:"Nota (0\u201320)",keyboardType:"numeric",value:e.nota||"",onChangeText:e=>{const a=e.replace(/[^0-9]/g,"");if(""===a||+a>=0&&+a<=20){const e=[...G];e[t].nota=a,J(e)}},style:Ft.input}),(0,I.jsx)(S.default,{label:"Coment\xe1rio Privado",multiline:!0,value:e.comentario_privado||"",onChangeText:e=>{const a=[...G];a[t].comentario_privado=e,J(a)},style:[Ft.input,Ft.comentarioInput]})]})]},e.id))):(0,I.jsx)(W.default,{style:Ft.infoText,children:"Nenhum aluno encontrado"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!E||!$||null===D)return;const e=G.filter((e=>e.selected));if(0===e.length)return void X("Aten\xe7\xe3o","Nenhum aluno selecionado");const a=e.filter((e=>void 0!==e.nota&&+e.nota>=10)),o=e.filter((e=>void 0!==e.nota&&+e.nota<10)),r=async()=>{w(!0);try{const e={professor_id:E.user_id,disciplina:E.disciplina,modulo:D,turma:$.turma,ano:$.ano,alunos:a},o=await B.default.post(vt,e);if(!o.data.success)throw new Error(o.data.message);X("Sucesso",`Notas publicadas para: ${a.map((e=>`${e.email} (${e.nota})`)).join(", ")}`),t.goBack()}catch(e){X("Erro",e.message)}finally{w(!1)}};if(o.length>0){const e=o.map((e=>`${e.email} (${e.nota})`)).join("\n");O.default.alert("M\xf3dulo em atraso",`As seguintes notas (< 10) N\xc3O ser\xe3o publicadas:\n\n${e}\n\nDeseja continuar e publicar apenas ${a.length} aluno(s) com nota \u2265 10?`,[{text:"Cancelar",style:"cancel"},{text:"Continuar",onPress:r}])}else r()},style:Ft.saveButton,children:"Atribuir Notas"})]})}),(0,I.jsx)(Pe.default,{visible:Y,onDismiss:()=>Z(!1),duration:3e3,action:{label:"Fechar",onPress:()=>Z(!1)},children:Q}),(0,I.jsx)(A,{visible:k,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>F(!1),navigation:t,email:o})]})},Bt=e=>m.default.create({background:{flex:1},loadingBackground:{flex:1,justifyContent:"center",alignItems:"center"},loadingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)"},loadingContainer:{alignItems:"center"},loadingText:{fontSize:18,marginTop:10},header:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:p.default.currentHeight||20,paddingHorizontal:15,paddingBottom:10,elevation:4,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:3},contentWrapper:{flex:1,marginTop:15,paddingHorizontal:15},webContainer:{flexDirection:"row",justifyContent:"space-between"},tasksContainer:{flex:1,marginRight:10,backgroundColor:e.colors.surface,borderRadius:8,padding:10,elevation:2,shadowColor:"#000",shadowOpacity:.15,shadowOffset:{width:0,height:1},marginBottom:15},eventsContainer:{flex:1,marginLeft:10,backgroundColor:e.colors.surface,borderRadius:8,padding:10,elevation:2,shadowColor:"#000",shadowOpacity:.15,shadowOffset:{width:0,height:1},marginBottom:15},mobileContainer:{paddingBottom:20},sectionHeader:{fontSize:20,fontWeight:"bold",color:e.colors.text,marginBottom:10,paddingVertical:5,borderBottomWidth:1,borderBottomColor:"#ccc",textShadowColor:"rgba(0, 0, 0, 0.1)",textShadowOffset:{width:0,height:1},textShadowRadius:1},listItem:{paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#eee"},itemTitle:{fontSize:17,fontWeight:"600",color:e.colors.text},itemInfo:{fontSize:14,color:e.colors.disabled,marginTop:3},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",padding:20},modalContent:{borderRadius:10,paddingTop:80,paddingHorizontal:20,paddingBottom:20},modalHeader:{position:"absolute",top:20,left:15,right:15,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},modalWarning:{textAlign:"center",fontSize:16,fontWeight:"bold",marginBottom:20,color:e.dark?"#FFF":e.colors.onSurface},fieldContainer:{backgroundColor:"#F9F9F9",borderRadius:8,padding:12,marginVertical:6,elevation:2},fieldLabel:{fontSize:14,fontWeight:"bold",marginBottom:4,color:"#333"},fieldValue:{fontSize:16,color:"#555"},editableBox:{backgroundColor:"#EFEFEF",borderRadius:8,padding:12,marginVertical:6,elevation:1},selectedColorDisplay:{flexDirection:"row",alignItems:"center",marginBottom:5},colorButton:{paddingVertical:10},colorCircle:{width:30,height:30,borderRadius:15,marginRight:10},editText:{fontSize:16,color:e.dark?"#FFF":e.colors.onSurface},notificationRow:{flexDirection:"row",alignItems:"center",marginBottom:8},spinnerContainer:{width:70,marginHorizontal:5,position:"relative"},spinnerInput:{width:"100%",height:40,borderWidth:1,borderColor:"#ccc",borderRadius:5,textAlign:"center",fontSize:16,backgroundColor:"#FFF",color:"#000"},spinnerButtons:{position:"absolute",right:0,top:0,bottom:0,justifyContent:"space-between",marginVertical:3},stepButton:{paddingHorizontal:5},stepButtonText:{fontSize:14,fontWeight:"bold",color:"#000"},removeBtn:{fontSize:20,fontWeight:"bold",marginLeft:5,color:"#900"},addTimeButton:{marginVertical:10,borderColor:"#47AD4D"},addTimeButtonLabel:{color:"#47AD4D",fontWeight:"bold"},saveButton:{backgroundColor:"#47AD4D",marginTop:20},saveButtonLabel:{color:"#FFF",fontWeight:"bold"},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorModalOverlay:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},colorModalContent:{backgroundColor:e.colors.surface,borderRadius:10,padding:20,width:"80%",alignItems:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",paddingVertical:8,width:"100%",borderBottomWidth:1,borderBottomColor:"#ccc"},colorName:{fontSize:16,marginLeft:10,color:"#333"},modalCloseButton:{marginTop:10,backgroundColor:"#47AD4D"}}),It=e=>{e.colors.placeholder,e.colors.text,e.colors.surface;const t={fontSize:16,padding:10,minWidth:110,borderWidth:1,borderColor:e.colors.placeholder,borderRadius:5,color:e.colors.text,backgroundColor:e.colors.surface,marginHorizontal:5};return{inputIOS:t,inputAndroid:t,inputWeb:t}},Pt=()=>{const e=(0,s.useRoute)(),t=(0,s.useNavigation)(),o=(0,j.useTheme)(),i=Bt(o),{email:d,theme:u,backgroundUrl:m}=e.params,p=`${c.baseUrl}/calendarioFiles/aluno/fetch_tasks.php`,x=`${c.baseUrl}/calendarioFiles/aluno/fetch_events.php`,y=`${c.baseUrl}/calendarioFiles/aluno/update_events_config.php`,C=`${c.baseUrl}/calendarioFiles/aluno/update_tasks_config.php`,[v,w]=(0,r.useState)(!1),[k,F]=(0,r.useState)(!1),[P,z]=(0,r.useState)([]),[R,E]=(0,r.useState)([]),[V,_]=(0,r.useState)(null),[H,$]=(0,r.useState)(null),[L,N]=(0,r.useState)("#DC143C"),[M,q]=(0,r.useState)(""),[G,J]=(0,r.useState)([]),[Y,Z]=(0,r.useState)(m),[Q,K]=(0,r.useState)("dark"===u?"dark":"light"),[X,ee]=(0,r.useState)(!1),te=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}],ae=()=>{B.default.post(p,{email:d}).then((e=>{e.data.success&&Array.isArray(e.data.tasks)?z(e.data.tasks):z([])})).catch((e=>{console.error("Erro ao buscar tarefas:",e)}))},oe=()=>{B.default.post(x,{email:d}).then((e=>{Array.isArray(e.data)?E(e.data):e.data.success&&Array.isArray(e.data.events)?E(e.data.events):E([])})).catch((e=>{console.error("Erro ao buscar eventos:",e)}))};(0,r.useEffect)((()=>{ae(),oe()}),[]);const re="dark"===Q?"#E0E0E0":"#000",le="dark"===Q?"#000":"#FFF";if(X)return(0,I.jsxs)(h.default,{source:Y?{uri:Y}:a(8922),style:i.loadingBackground,children:["dark"===Q&&(0,I.jsx)(n.default,{style:i.loadingOverlay}),(0,I.jsxs)(n.default,{style:i.loadingContainer,children:[(0,I.jsx)(l.default,{size:"large",color:re}),(0,I.jsx)(W.default,{style:[i.loadingText,{color:re}],children:"Carregando registros..."})]})]});const ne=e=>e.replace(/['";]/g,""),se=(e,t=1)=>{const a={minutes:["minuto","minutos"],hours:["hora","horas"],days:["dia","dias"],weeks:["semana","semanas"]};return 1===t?a[e][0]:a[e][1]},ie=()=>{J((e=>[...e,{timeValue:15,unit:"minutes",alertType:"notification"}]))},de=e=>{J((t=>{const a=[...t];return a[e].timeValue<60&&(a[e].timeValue+=1),a}))},ce=e=>{J((t=>{const a=[...t];return a[e].timeValue>1&&(a[e].timeValue-=1),a}))};return(0,I.jsxs)(h.default,{source:Y?{uri:Y}:a(8922),style:i.background,children:[(0,I.jsxs)(n.default,{style:[i.header,{backgroundColor:le}],children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,tintColor:"dark"===Q?"#FFF":"#5F6368"}})}),(0,I.jsx)(b.default,{onPress:()=>w(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:{width:35,height:35,tintColor:"dark"===Q?"#FFF":"#5F6368"}})})]}),(0,I.jsx)(n.default,{style:i.contentWrapper,children:(0,I.jsxs)(n.default,{style:i.webContainer,children:[(0,I.jsxs)(n.default,{style:i.tasksContainer,children:[(0,I.jsx)(W.default,{style:i.sectionHeader,children:"As Minhas Tarefas"}),P.map(((e,t)=>(0,I.jsxs)(b.default,{onPress:()=>(e=>{_(e),B.default.post(p,{tarefa_id:e.tarefa_id,email:d}).then((e=>{if(e.data.success&&e.data.tasks&&e.data.tasks.length>0){const t=e.data.tasks[0];if(N(t.cor||"#47AD4D"),q(t.descricao||""),t.notification_times&&Array.isArray(t.notification_times)){const e=t.notification_times.map((e=>({timeValue:e,unit:"minutes",alertType:"notification"})));J(e)}else J([])}else N("#47AD4D"),q(""),J([])})).catch((e=>{console.error("Erro ao buscar configura\xe7\xe3o da tarefa:",e),N("#47AD4D"),q(""),J([])}))})(e),style:i.listItem,children:[(0,I.jsx)(W.default,{style:i.itemTitle,children:e.titulo||e.tarefa_id}),(0,I.jsxs)(W.default,{style:i.itemInfo,children:[e.professor_email," | ",e.data_da_tarefa]})]},t)))]}),(0,I.jsxs)(n.default,{style:i.eventsContainer,children:[(0,I.jsx)(W.default,{style:i.sectionHeader,children:"Os Meus Eventos"}),R.map(((e,t)=>(0,I.jsxs)(b.default,{onPress:()=>(e=>{if($(e),N(e.cores||"#DC143C"),q(e.descricao||""),e.notification_times&&Array.isArray(e.notification_times)){const t=e.notification_times.map((e=>({timeValue:e,unit:"minutes",alertType:"notification"})));J(t)}else J([])})(e),style:i.listItem,children:[(0,I.jsx)(W.default,{style:i.itemTitle,children:e.title}),(0,I.jsxs)(W.default,{style:i.itemInfo,children:[e.professor_email," | ",e.start_datetime," - ",e.end_datetime]})]},t)))]})]})}),(V||H)&&(0,I.jsxs)(D.default,{visible:!0,animationType:"slide",transparent:!0,children:[(0,I.jsx)(D.default,{visible:k,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:i.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:i.colorModalContent,children:[(0,I.jsx)(W.default,{style:[i.modalTitle,{color:o.colors.onSurface}],children:"Selecionar Cor"}),!te.find((e=>e.value===L))&&(0,I.jsxs)(b.default,{style:i.colorOptionRow,onPress:()=>{N(L),F(!1)},children:[(0,I.jsx)(n.default,{style:[i.colorCircle,{backgroundColor:L}]}),(0,I.jsx)(W.default,{style:[i.colorName,{color:o.colors.onSurface}],children:"Cor Atual"})]}),te.map((e=>(0,I.jsxs)(b.default,{style:i.colorOptionRow,onPress:()=>{N(e.value),F(!1)},children:[(0,I.jsx)(n.default,{style:[i.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{style:[i.colorName,{color:o.colors.onSurface}],children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>F(!1),style:i.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(n.default,{style:i.modalOverlay,children:(0,I.jsxs)(f.default,{contentContainerStyle:[i.modalContent,{backgroundColor:"dark"===Q?"#000":"#FFF"}],children:[(0,I.jsxs)(n.default,{style:i.modalHeader,children:[(0,I.jsx)(b.default,{onPress:()=>{_(null),$(null),F(!1)},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,tintColor:"dark"===Q?"#FFF":"#5F6368"}})}),(0,I.jsx)(b.default,{onPress:()=>w(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:{width:35,height:35,tintColor:"dark"===Q?"#FFF":"#5F6368"}})})]}),(0,I.jsxs)(W.default,{style:i.modalWarning,children:["As configura\xe7\xf5es abaixo s\xe3o apenas para si e n\xe3o afetam a"," ",V?"tarefa":"evento"," original."]}),V?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:V.titulo||`Tarefa ${V.tarefa_id}`})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Criado por:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:V.professor_email})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Data da Tarefa:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:V.data_da_tarefa})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:V.descricao||"N\xe3o h\xe1 descri\xe7\xe3o."})]}),(0,I.jsxs)(n.default,{style:i.editableBox,children:[(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Cor:"}),(0,I.jsxs)(b.default,{activeOpacity:.7,style:[i.selectedColorDisplay,i.colorButton],onPress:()=>F(!0),children:[(0,I.jsx)(n.default,{style:[i.colorCircle,{backgroundColor:L}]}),(0,I.jsx)(W.default,{style:i.editText,children:"Alterar Cor"})]})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Notifica\xe7\xf5es:"}),G.map(((e,t)=>(0,I.jsxs)(n.default,{style:i.notificationRow,children:[(0,I.jsx)(U.default,{onValueChange:e=>{e&&J((a=>{const o=[...a];return o[t].alertType=e,o}))},items:[{label:"Email",value:"email"},{label:"Notifica\xe7\xe3o",value:"notification"}],placeholder:{},value:e.alertType,useNativeAndroidPickerStyle:!1,style:It(o)}),(0,I.jsxs)(n.default,{style:i.spinnerContainer,children:[(0,I.jsx)(S.default,{style:i.spinnerInput,keyboardType:"numeric",value:null!==e.timeValue?String(e.timeValue):"",onChangeText:e=>{if(""===e)J((e=>{const a=[...e];return a[t].timeValue=null,a}));else{const a=parseInt(e,10);!isNaN(a)&&a>=1&&a<=60&&J((e=>{const o=[...e];return o[t].timeValue=a,o}))}},onBlur:()=>{J((e=>{const a=[...e];return null===a[t].timeValue&&(a[t].timeValue=1),a}))}}),(0,I.jsxs)(n.default,{style:i.spinnerButtons,children:[(0,I.jsx)(b.default,{onPress:()=>de(t),style:i.stepButton,children:(0,I.jsx)(W.default,{style:i.stepButtonText,children:"\u25b2"})}),(0,I.jsx)(b.default,{onPress:()=>ce(t),style:i.stepButton,children:(0,I.jsx)(W.default,{style:i.stepButtonText,children:"\u25bc"})})]})]}),(0,I.jsx)(U.default,{onValueChange:e=>{e&&J((a=>{const o=[...a];return o[t].unit=e,o}))},items:[{label:se("minutes"),value:"minutes"},{label:se("hours"),value:"hours"},{label:se("days"),value:"days"},{label:se("weeks"),value:"weeks"}],placeholder:{},value:e.unit,useNativeAndroidPickerStyle:!1,style:It(o)}),(0,I.jsx)(b.default,{onPress:()=>J((e=>e.filter(((e,a)=>a!==t)))),children:(0,I.jsx)(g.default,{source:a(5132),style:{width:25,height:25,tintColor:"dark"===Q?"#FFF":"#5F6368"}})})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:ie,style:i.addTimeButton,labelStyle:i.addTimeButtonLabel,children:"+ Adicionar notifica\xe7\xe3o"})]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{V&&O.default.alert("Confirma\xe7\xe3o","Ao guardar estas configura\xe7\xf5es, elas mudar\xe3o apenas para si!",[{text:"Cancelar",style:"cancel"},{text:"Guardar",onPress:()=>{const e=G.map((e=>{let t=e.timeValue;return"hours"===e.unit&&(t=60*e.timeValue),"days"===e.unit&&(t=1440*e.timeValue),"weeks"===e.unit&&(t=10080*e.timeValue),t})),t={tarefa_id:V.tarefa_id,email:d,cor:L,descricao:ne(M),notificacao_tipo:"notificacao",notification_times:e};B.default.post(C,t).then((e=>{e.data.success?(O.default.alert("Sucesso",e.data.message),ae(),_(null)):O.default.alert("Erro",e.data.message)})).catch((e=>{console.error("Erro ao atualizar configura\xe7\xe3o da tarefa:",e),O.default.alert("Erro","N\xe3o foi poss\xedvel atualizar a configura\xe7\xe3o da tarefa.")}))}}])},style:i.saveButton,labelStyle:i.saveButtonLabel,children:"Salvar Configura\xe7\xf5es"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:H?.title})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Criado por:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:"-"})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Data de In\xedcio:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:H?.start_datetime})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Data de Fim:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:H?.end_datetime})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:i.fieldValue,children:H?.descricao||"N\xe3o h\xe1 descri\xe7\xe3o."})]}),(0,I.jsxs)(n.default,{style:i.editableBox,children:[(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Cor:"}),(0,I.jsxs)(b.default,{activeOpacity:.7,style:[i.selectedColorDisplay,i.colorButton],onPress:()=>F(!0),children:[(0,I.jsx)(n.default,{style:[i.colorCircle,{backgroundColor:L}]}),(0,I.jsx)(W.default,{style:i.editText,children:"Alterar Cor"})]})]}),(0,I.jsxs)(n.default,{style:i.fieldContainer,children:[(0,I.jsx)(W.default,{style:i.fieldLabel,children:"Notifica\xe7\xf5es:"}),G.map(((e,t)=>(0,I.jsxs)(n.default,{style:i.notificationRow,children:[(0,I.jsx)(U.default,{onValueChange:e=>{e&&J((a=>{const o=[...a];return o[t].alertType=e,o}))},items:[{label:"Email",value:"email"},{label:"Notifica\xe7\xe3o",value:"notification"}],placeholder:{},value:e.alertType,useNativeAndroidPickerStyle:!1,style:It(o)}),(0,I.jsxs)(n.default,{style:i.spinnerContainer,children:[(0,I.jsx)(S.default,{style:i.spinnerInput,keyboardType:"numeric",value:null!==e.timeValue?String(e.timeValue):"",onChangeText:e=>{if(""===e)J((e=>{const a=[...e];return a[t].timeValue=null,a}));else{const a=parseInt(e,10);!isNaN(a)&&a>=1&&a<=60&&J((e=>{const o=[...e];return o[t].timeValue=a,o}))}},onBlur:()=>{J((e=>{const a=[...e];return null===a[t].timeValue&&(a[t].timeValue=1),a}))}}),(0,I.jsxs)(n.default,{style:i.spinnerButtons,children:[(0,I.jsx)(b.default,{onPress:()=>de(t),style:i.stepButton,children:(0,I.jsx)(W.default,{style:i.stepButtonText,children:"\u25b2"})}),(0,I.jsx)(b.default,{onPress:()=>ce(t),style:i.stepButton,children:(0,I.jsx)(W.default,{style:i.stepButtonText,children:"\u25bc"})})]})]}),(0,I.jsx)(U.default,{onValueChange:e=>{e&&J((a=>{const o=[...a];return o[t].unit=e,o}))},items:[{label:se("minutes"),value:"minutes"},{label:se("hours"),value:"hours"},{label:se("days"),value:"days"},{label:se("weeks"),value:"weeks"}],placeholder:{},value:e.unit,useNativeAndroidPickerStyle:!1,style:It(o)}),(0,I.jsx)(b.default,{onPress:()=>J((e=>e.filter(((e,a)=>a!==t)))),children:(0,I.jsx)(g.default,{source:a(5132),style:{width:25,height:25,tintColor:"dark"===Q?"#FFF":"#5F6368"}})})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:ie,style:i.addTimeButton,labelStyle:i.addTimeButtonLabel,children:"+ Adicionar notifica\xe7\xe3o"})]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{H&&O.default.alert("Confirma\xe7\xe3o","Ao guardar estas configura\xe7\xf5es, elas mudar\xe3o apenas para si!",[{text:"Cancelar",style:"cancel"},{text:"Guardar",onPress:()=>{const e=G.map((e=>{let t=e.timeValue;return"hours"===e.unit&&(t=60*e.timeValue),"days"===e.unit&&(t=1440*e.timeValue),"weeks"===e.unit&&(t=10080*e.timeValue),t})),t={event_id:H.id,email:d,cor:L,descricao:ne(M),notificacao_tipo:"notificacao",notification_times:e};B.default.post(y,t).then((e=>{e.data.success?(O.default.alert("Sucesso",e.data.message),oe(),$(null)):O.default.alert("Erro",e.data.message)})).catch((e=>{console.error("Erro ao atualizar configura\xe7\xe3o do evento:",e),O.default.alert("Erro","N\xe3o foi poss\xedvel atualizar a configura\xe7\xe3o do evento.")}))}}])},style:i.saveButton,labelStyle:i.saveButtonLabel,children:"Salvar Configura\xe7\xf5es"})]})]})})]}),(0,I.jsx)(A,{visible:v,dynamicHeaderBackground:le,dynamicTextColor:"dark"===Q?"#FFF":"#000",onClose:()=>w(!1),navigation:t,email:d})]})};var At=a(7701),zt=a(680);const Rt=m.default.create({loadingContainer:{flex:1,backgroundColor:"black",justifyContent:"center",alignItems:"center"},background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,backgroundColor:"black"},camera:{flex:1},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,justifyContent:"center",alignItems:"center"},overlayTop:{flex:1,width:"100%",backgroundColor:"rgba(0,0,0,0.5)"},overlayMiddle:{flexDirection:"row",width:"100%",alignItems:"center"},overlaySide:{flex:1,height:300,backgroundColor:"rgba(0,0,0,0.5)"},focusedArea:{width:300,height:300,borderRadius:20,borderWidth:2,borderColor:"#fff",overflow:"hidden",backgroundColor:"transparent"},overlayBottom:{flex:1,width:"100%",backgroundColor:"rgba(0,0,0,0.5)"},animationOverlay:{position:"absolute",top:"40%",left:"50%",marginLeft:-50,marginTop:-50,width:100,height:100,justifyContent:"center",alignItems:"center",borderRadius:50,backgroundColor:"rgba(255, 255, 255, 0.3)"},animationText:{fontSize:40,color:"white"},backButton:{position:"absolute",top:40,left:20,zIndex:10,backgroundColor:"rgba(0,0,0,0.5)",padding:10,borderRadius:20},backIcon:{width:20,height:20,tintColor:"white"},manualButton:{position:"absolute",bottom:40,alignSelf:"center",backgroundColor:"rgba(0,0,0,0.7)",paddingVertical:10,paddingHorizontal:20,borderRadius:10},manualButtonText:{color:"white",fontSize:16},centered:{flex:1,width:"80%",height:"80%",backgroundColor:"rgba(0,0,0,0.6)",justifyContent:"center",alignItems:"center",padding:20,borderRadius:10},text:{color:"white",fontSize:16,marginBottom:20,textAlign:"center"},buttonContainer:{flexDirection:"row",justifyContent:"space-between"},button:{paddingVertical:10,paddingHorizontal:15,borderRadius:5,marginHorizontal:5},btnSolicitar:{backgroundColor:"#47AD4D"},btnManual:{backgroundColor:"#47AD4D"},buttonText:{color:"white",fontSize:14},modalBackground:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0,0,0,0.7)"},modalContainer:{width:"80%",height:"40%",backgroundColor:"white",borderRadius:10,padding:20,alignItems:"center",justifyContent:"center"},modalText:{fontSize:16,marginBottom:20,textAlign:"center",color:"black"},modalButtonContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%"},modalButton:{flex:1,paddingVertical:10,paddingHorizontal:20,borderRadius:5,marginHorizontal:5,alignItems:"center"},btnConfirmar:{backgroundColor:"#47AD4D"},btnCancelar:{backgroundColor:"red"},modalButtonText:{color:"white",fontSize:16},previewText:{fontSize:24,fontWeight:"bold",marginBottom:10,color:"green"},previewSaida:{color:"red"},previewHora:{fontSize:18,marginBottom:20}}),Et=({navigation:e,route:t})=>{const o=t?.params?.email||null,[s,i]=(0,At.useCameraPermissions)(),d=Boolean(s?.granted),[f,m]=(0,r.useState)(!0),[p,x]=(0,r.useState)(null),[y,j]=(0,r.useState)(!1),[C,v]=(0,r.useState)(null),[w,S]=(0,r.useState)(!1),T=(0,r.useRef)(null),k=(0,r.useRef)(new et.default.Value(0)).current,F=`${c.baseUrl}/calendarioFiles/entradasSaidas/handleEntradasESaidas.php`,B=`${c.baseUrl}/calendarioFiles/entradasSaidas/getEntradasESaidas.php`;(0,r.useEffect)((()=>{s||i()}),[s]),(0,r.useEffect)((()=>{e?.setOptions&&e.setOptions({headerShown:!1})}),[e]);const P=()=>{j(!0),S(!0),v(null),A()},A=async()=>{try{const e=await fetch(B,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),t=await e.json();let a="entrada";if(t.success&&t.days&&t.days.length>0){const e=(new Date).toISOString().slice(0,10),o=t.days.find((t=>t.date===e));if(o&&o.records&&o.records.length>0){a="entrada"===o.records[o.records.length-1].type?"saida":"entrada"}}const r=(new Date).toLocaleTimeString();v({tipo:a,hora:r})}catch(e){alert("Erro ao buscar registos.")}finally{S(!1)}};if(!s)return(0,I.jsxs)(n.default,{style:Rt.loadingContainer,children:[(0,I.jsx)(l.default,{size:"large",color:"#fff"}),(0,I.jsx)(u.default,{style:Rt.text,children:"A pedir as permiss\xf5es..."})]});const z=a(8922);if(!d)return(0,I.jsx)(h.default,{source:z,style:Rt.background,children:(0,I.jsxs)(n.default,{style:Rt.centered,children:[(0,I.jsx)(u.default,{style:Rt.text,children:"A permiss\xe3o para usar a c\xe2mera foi negada."}),(0,I.jsxs)(n.default,{style:Rt.buttonContainer,children:[(0,I.jsx)(b.default,{onPress:i,style:[Rt.button,Rt.btnSolicitar],children:(0,I.jsx)(u.default,{style:Rt.buttonText,children:"Pedir Permiss\xe3o"})}),(0,I.jsx)(b.default,{onPress:P,style:[Rt.button,Rt.btnManual],children:(0,I.jsx)(u.default,{style:Rt.buttonText,children:"Inserir Manualmente"})})]})]})});const R={transform:[{scale:k.interpolate({inputRange:[0,1],outputRange:[.5,1.5]})}],opacity:k};return(0,I.jsxs)(n.default,{style:Rt.container,children:[(0,I.jsxs)(zt.default,{ref:T,style:Rt.camera,facing:"back",onBarcodeScanned:async({data:t})=>{if(f){let r=o;t&&t.startsWith("email:")&&(r=t.replace("email:","").trim()),x(t),m(!1);try{const t=await fetch(F,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),a=await t.json();console.log("Resposta do servidor:",a),a.success?et.default.sequence([et.default.timing(k,{toValue:1,duration:500,useNativeDriver:!0}),et.default.delay(500),et.default.timing(k,{toValue:0,duration:500,useNativeDriver:!0})]).start((()=>{e.navigate("Aluno",{email:r,manualInsertion:!1})})):m(!0)}catch(a){console.error("Erro ao enviar dados:",a),m(!0)}}},children:[(0,I.jsx)(b.default,{style:Rt.backButton,onPress:()=>e.navigate("Aluno",{email:o}),children:(0,I.jsx)(g.default,{source:a(7588),style:Rt.backIcon})}),(0,I.jsxs)(n.default,{style:Rt.overlay,children:[(0,I.jsx)(n.default,{style:Rt.overlayTop}),(0,I.jsxs)(n.default,{style:Rt.overlayMiddle,children:[(0,I.jsx)(n.default,{style:Rt.overlaySide}),(0,I.jsx)(n.default,{style:Rt.focusedArea,children:p&&(0,I.jsx)(et.default.View,{style:[Rt.animationOverlay,R],children:(0,I.jsx)(u.default,{style:Rt.animationText,children:"\u2713"})})}),(0,I.jsx)(n.default,{style:Rt.overlaySide})]}),(0,I.jsx)(n.default,{style:Rt.overlayBottom})]})]}),(0,I.jsx)(b.default,{onPress:P,style:Rt.manualButton,children:(0,I.jsx)(u.default,{style:Rt.manualButtonText,children:"Inserir Manualmente"})}),(0,I.jsx)(D.default,{visible:y,transparent:!0,animationType:"fade",onRequestClose:()=>j(!1),children:(0,I.jsx)(n.default,{style:Rt.modalBackground,children:(0,I.jsx)(n.default,{style:Rt.modalContainer,children:w?(0,I.jsx)(l.default,{size:"large",color:"#fff"}):C?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Rt.previewText,"saida"===C.tipo&&Rt.previewSaida],children:"saida"===C.tipo?"SA\xcdDA":"ENTRADA"}),(0,I.jsxs)(u.default,{style:Rt.previewHora,children:["Hora: ",C.hora]}),(0,I.jsxs)(n.default,{style:Rt.modalButtonContainer,children:[(0,I.jsx)(b.default,{onPress:async()=>{j(!1);try{const t=await fetch(F,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),a=await t.json();console.log("Inser\xe7\xe3o manual:",a),a.success?e.navigate("Aluno",{email:o,manualInsertion:!0}):alert("Erro ao inserir registo.")}catch(t){alert("Erro ao inserir registo.")}},style:[Rt.modalButton,Rt.btnConfirmar],children:(0,I.jsx)(u.default,{style:Rt.modalButtonText,children:"Sim"})}),(0,I.jsx)(b.default,{onPress:()=>j(!1),style:[Rt.modalButton,Rt.btnCancelar],children:(0,I.jsx)(u.default,{style:Rt.modalButtonText,children:"N\xe3o"})})]})]}):(0,I.jsx)(u.default,{style:Rt.modalText,children:"N\xe3o foi poss\xedvel carregar o preview."})})})})]})},Ot=m.default.create({container:{flex:1},loaderBg:{flex:1,justifyContent:"center",alignItems:"center"},header:{width:"100%",flexDirection:"row",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,backgroundColor:"white",position:"absolute",top:0,zIndex:10},backIcon:{width:35,height:35,tintColor:"#000"},userIcon:{width:35,height:35,tintColor:"#000"},scroll:{marginTop:40,paddingTop:90,padding:16},mobileLayout:{flexDirection:"column"},webLayout:{flexDirection:"row",justifyContent:"space-between"},box:{backgroundColor:"white",borderRadius:8,padding:12},boxMobile:{width:"100%",height:300,marginBottom:20},boxWeb:{width:"48%",height:400},sectionTitle:{fontSize:24,fontWeight:"bold",marginBottom:12},item:{paddingVertical:8,borderBottomWidth:1,borderColor:"#ddd"},itemText:{fontSize:18,marginVertical:6},modalBg:{flex:1},mobileModalBox:{flex:1,marginTop:90,backgroundColor:"white",borderTopLeftRadius:16,borderTopRightRadius:16,marginBottom:190,padding:20},webModalBox:{marginTop:120,width:"90%",maxWidth:700,maxHeight:"85%",backgroundColor:"white",borderRadius:16,padding:40,alignSelf:"center",justifyContent:"flex-start"},configModalContainer:{padding:30,paddingBottom:50,alignItems:"stretch"},warningText:{fontStyle:"italic",textAlign:"center",marginBottom:20},summaryContainer:{backgroundColor:"#F9F9F9",borderRadius:8,padding:20,marginBottom:24,minHeight:100},summaryRow:{flexDirection:"row",alignItems:"center",marginBottom:12},summaryLabel:{flex:1,fontWeight:"bold",fontSize:18},summaryValue:{flex:2,fontSize:18},label:{marginBottom:8,fontSize:18},input:{marginBottom:20,height:50},webInput:{marginBottom:12,padding:8,borderWidth:1,borderRadius:4},selectedColorDisplay:{flexDirection:"row",alignItems:"center",marginBottom:12},colorCircle:{width:30,height:30,borderRadius:15,marginRight:10},buttonsRow:{flexDirection:"row",justifyContent:"space-between",marginVertical:16},saveButtonSmall:{flex:1,marginRight:8,backgroundColor:"#47AD4D"},deleteButtonSmall:{flex:1,marginLeft:8,backgroundColor:"#FF5733"},editButton:{alignSelf:"flex-end",marginBottom:16,borderColor:"#47AD4D",borderWidth:1},colorModalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},colorModalContainer:{width:"80%",backgroundColor:"#FFF",padding:20,borderRadius:10},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",paddingVertical:8,borderBottomWidth:1,borderColor:"#ccc"},toast:{position:"absolute",top:10,alignSelf:"center",paddingHorizontal:20,paddingVertical:10,borderRadius:8,zIndex:1e3,maxWidth:"90%"},toastSuccess:{backgroundColor:"#4CAF50"},toastError:{backgroundColor:"#F44336"},toastText:{color:"#FFF",fontSize:16,textAlign:"center"},centerContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"}}),Vt=()=>{const e=(0,j.useTheme)(),t=(0,s.useNavigation)(),o=(0,s.useRoute)(),{email:i}=o.params,d=`${c.baseUrl}/calendarioFiles/professor/tarefas/fetch_tasks.php`,m=`${c.baseUrl}/calendarioFiles/professor/tarefas/fetch_task_view.php`,p=`${c.baseUrl}/calendarioFiles/professor/tarefas/update_task.php`,x=`${c.baseUrl}/calendarioFiles/professor/tarefas/delete_task.php`,y=`${c.baseUrl}/calendarioFiles/professor/eventos/fetch_events.php`,C=`${c.baseUrl}/calendarioFiles/professor/eventos/update_event.php`,v=`${c.baseUrl}/calendarioFiles/professor/eventos/delete_event.php`,[w,k]=(0,r.useState)(!0),[F,P]=(0,r.useState)(null),[z,R]=(0,r.useState)(e.dark?"dark":"light"),[E,O]=(0,r.useState)([]),[V,H]=(0,r.useState)(null),[$,L]=(0,r.useState)(""),[N,M]=(0,r.useState)("#000000"),[U,q]=(0,r.useState)(new Date),[G,J]=(0,r.useState)(new Date),[Y,Z]=(0,r.useState)(!1),[Q,K]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[te,ae]=(0,r.useState)(!1),[oe,re]=(0,r.useState)(!1),[le,ne]=(0,r.useState)([]),[se,ie]=(0,r.useState)(null),[de,ce]=(0,r.useState)(""),[ue,fe]=(0,r.useState)(""),[me,ge]=(0,r.useState)("#000000"),[he,pe]=(0,r.useState)(!1),[xe,ye]=(0,r.useState)(!1),[be,je]=(0,r.useState)(!1),[Ce,ve]=(0,r.useState)(new Date),[we,Se]=(0,r.useState)(new Date),[Te,ke]=(0,r.useState)(!1),[Fe,De]=(0,r.useState)(!1),[Be,Ie]=(0,r.useState)(new Date),[Pe,Ae]=(0,r.useState)(new Date),[ze,Re]=(0,r.useState)(!1),[Ee,Oe]=(0,r.useState)(!1),[Ve,_e]=(0,r.useState)(!1),[We,He]=(0,r.useState)(""),[$e,Le]=(0,r.useState)({visible:!1,message:"",type:"success"}),Ne="dark"===z?"#e0dede":e.colors.onSurface,Me=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}];(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),P(e),R("dark"===t?"dark":"light")}catch(e){}finally{k(!1)}})()}),[]),(0,r.useEffect)((()=>{Ue(),qe()}),[]);const Ue=()=>{B.default.post(d,{email:i}).then((e=>{O(e.data.success&&Array.isArray(e.data.tasks)?e.data.tasks:[])})).catch()},qe=()=>{B.default.post(y,{email:i}).then((e=>{ne(Array.isArray(e.data)?e.data:[])})).catch()},Ge=e=>e.replace(/['";]/g,""),Je=()=>{const e=U.toISOString().slice(0,10),[t,a]=G.toTimeString().substr(0,5).split(":"),o=`${t}:${a}:00`;B.default.post(p,{tarefa_id:V.id,email:i,titulo:Ge(We),descricao:Ge($),cor:N,data_da_tarefa:`${e} ${o}`}).then((e=>{e.data.success?(Ke(e.data.message,"success"),Ue(),Z(!1),H(null)):Ke(e.data.message,"error")})).catch((()=>{Ke("Ocorreu um erro da nossa parte enquanto tent\xe1vamos atualizar os dados da tarefa. Pedimos que tente novamente mais tarde.","error")}))},Ye=()=>{B.default.post(x,{tarefa_id:V.id,email:i}).then((e=>{e.data.success?(Ke(e.data.message,"success"),Ue(),Z(!1),H(null)):Ke(e.data.message,"error")})).catch((()=>{Ke("Ocorreu um erro enquanto tent\xe1vamos remover a tarefa permanentemente. Pedimos que tente novamente mais tarde.","error")}))},Ze=()=>{const e=Ce.toISOString().slice(0,10),[t,a]=we.toTimeString().substr(0,5).split(":"),o=`${e} ${t}:${a}:00`,r=Be.toISOString().slice(0,10),[l,n]=Pe.toTimeString().substr(0,5).split(":"),s=`${r} ${l}:${n}:00`;B.default.post(C,{event_id:se.id,email:i,title:Ge(de),start_datetime:o,end_datetime:s,descricao:Ge(ue),color:me}).then((e=>{e.data.success?(Ke(e.data.message,"success"),qe(),pe(!1),ie(null)):Ke(e.data.message,"error")})).catch((()=>{Ke("Ocorreu um erro enquanto tent\xe1vamos alterar os dados do evento. Pedimos que tente novamente mais tarde.","error")}))},Qe=()=>{B.default.post(v,{event_id:se.id,email:i}).then((e=>{e.data.success?(Ke(e.data.message,"success"),qe(),pe(!1),ie(null)):Ke(e.data.message,"error")})).catch((()=>{Ke("Ocorreu um erro enquanto tent\xe1vamos eliminar o evento permanentemente. Pedimos que tente novamente mais tarde.","error")}))},Ke=(e,t)=>{window.alert(e)};return w?(0,I.jsx)(_.default,{style:Ot.centerContainer,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:F?{uri:F}:a(8922),style:Ot.container,children:[(0,I.jsxs)(n.default,{style:Ot.header,children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),children:(0,I.jsx)(g.default,{source:a(7588),style:Ot.backIcon})}),(0,I.jsx)(b.default,{onPress:()=>_e(!0),children:(0,I.jsx)(g.default,{source:a(9119),style:Ot.userIcon})})]}),$e.visible&&(0,I.jsx)(n.default,{style:[Ot.toast,"success"===$e.type?Ot.toastSuccess:Ot.toastError],children:(0,I.jsx)(W.default,{style:Ot.toastText,children:$e.message})}),(0,I.jsx)(f.default,{contentContainerStyle:Ot.scroll,children:(0,I.jsxs)(n.default,{style:Ot.webLayout,children:[(0,I.jsxs)(n.default,{style:[Ot.box,Ot.boxWeb],children:[(0,I.jsx)(W.default,{style:[Ot.sectionTitle,{color:Ne}],children:"Tarefas"}),(0,I.jsx)(f.default,{children:E.map(((e,t)=>(0,I.jsx)(b.default,{onPress:()=>{return H(t=e),void B.default.post(m,{tarefa_id:t.id,email:i}).then((e=>{if(e.data.success&&e.data.config){const t=e.data.config;L(t.descricao||"");const a=new Date(t.data_da_tarefa);q(a),J(a),He(t.titulo||""),M(t.cor||"#000000")}else L(""),M("#000000");K(!1),Z(!0)})).catch((e=>{Z(!0)}));var t},style:Ot.item,children:(0,I.jsxs)(W.default,{style:[Ot.itemText,{color:Ne}],children:[e.titulo," \u2013 ",e.data_da_tarefa]})},t)))})]}),(0,I.jsxs)(n.default,{style:[Ot.box,Ot.boxWeb],children:[(0,I.jsx)(W.default,{style:[Ot.sectionTitle,{color:Ne}],children:"Eventos"}),(0,I.jsx)(f.default,{children:le.map(((e,t)=>(0,I.jsx)(b.default,{onPress:()=>(e=>{ie(e),ce(e.title),fe(e.descricao||""),ge(e.color||"#000000");const t=new Date(e.start_datetime);ve(t),Se(t);const a=new Date(e.end_datetime);Ie(a),Ae(a),ye(!1),pe(!0)})(e),style:Ot.item,children:(0,I.jsxs)(W.default,{style:[Ot.itemText,{color:Ne}],children:[e.title," \u2013 ",e.start_datetime]})},t)))})]})]})}),(0,I.jsx)(D.default,{visible:Y,animationType:"slide",transparent:!0,children:(0,I.jsxs)(h.default,{source:F?{uri:F}:a(8922),style:Ot.modalBg,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>Z(!1),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===z?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>_e(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===z?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(n.default,{style:Ot.webModalBox,children:(0,I.jsxs)(f.default,{contentContainerStyle:Ot.configModalContainer,children:[(0,I.jsx)(W.default,{style:Ot.warningText,children:Q?"Edi\xe7\xe3o da tarefa.":"Detalhes da tarefa:"}),Q?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"T\xedtulo:"}),(0,I.jsx)(S.default,{mode:"outlined",value:We,onChangeText:e=>He(Ge(e)),style:Ot.input}),(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"Descri\xe7\xe3o:"}),(0,I.jsx)(S.default,{mode:"outlined",value:$,onChangeText:e=>L(Ge(e)),style:Ot.input}),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Data da Tarefa:"}),(0,I.jsx)("input",{type:"date",value:U.toISOString().slice(0,10),onChange:e=>q(new Date(e.target.value)),style:Ot.webInput}),(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Hora da Tarefa:"}),(0,I.jsx)("input",{type:"time",value:G.toTimeString().slice(0,5),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(G);o.setHours(+t),o.setMinutes(+a),J(o)},style:Ot.webInput})]}),(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"Cor:"}),(0,I.jsxs)(b.default,{onPress:()=>re(!0),style:Ot.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:N}]}),(0,I.jsx)(W.default,{style:{color:Ne},children:"Clique para alterar cor"})]}),(0,I.jsxs)(n.default,{style:Ot.buttonsRow,children:[(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!V)return;window.confirm("Pretende atualizar os dados da tarefa?")&&Je()},style:Ot.saveButtonSmall,children:"Salvar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!V)return;window.confirm("Tem a certeza que pretende eliminar a tarefa permanentemente?")&&Ye()},style:Ot.deleteButtonSmall,children:"Apagar"})]}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>K(!1),labelStyle:{color:"#47AD4D"},children:"Cancelar"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:Ot.summaryContainer,children:[(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:Ot.summaryValue,children:We})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:Ot.summaryValue,children:$})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Data/Hora:"}),(0,I.jsxs)(W.default,{style:Ot.summaryValue,children:[U.toISOString().slice(0,10)," ",G.toTimeString().slice(0,5)]})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Cor:"}),(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:N}]})]})]}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>K(!0),style:Ot.editButton,labelStyle:{color:"#47AD4D"},children:"Editar"})]})]})})]})}),(0,I.jsx)(D.default,{visible:oe,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Ot.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:Ot.colorModalContainer,children:[(0,I.jsx)(W.default,{style:Ot.modalTitle,children:"Selecionar Cor"}),Me.map((e=>(0,I.jsxs)(b.default,{style:Ot.colorOptionRow,onPress:()=>{M(e.value),re(!1)},children:[(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>re(!1),style:{backgroundColor:"#47AD4D"},children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:he,animationType:"slide",transparent:!0,children:(0,I.jsxs)(h.default,{source:F?{uri:F}:a(8922),style:Ot.modalBg,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>pe(!1),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===z?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>_e(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===z?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(n.default,{style:Ot.webModalBox,children:(0,I.jsxs)(f.default,{contentContainerStyle:Ot.configModalContainer,children:[(0,I.jsx)(W.default,{style:Ot.warningText,children:xe?"Edite os campos e salve.":"Detalhes do evento:"}),xe?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"T\xedtulo:"}),(0,I.jsx)(S.default,{mode:"outlined",value:de,onChangeText:e=>ce(Ge(e)),style:Ot.input}),(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Data de In\xedcio:"}),(0,I.jsx)("input",{type:"date",value:Ce.toISOString().slice(0,10),onChange:e=>ve(new Date(e.target.value)),style:Ot.webInput}),(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Hora de In\xedcio:"}),(0,I.jsx)("input",{type:"time",value:we.toTimeString().slice(0,5),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(we);o.setHours(+t),o.setMinutes(+a),Se(o)},style:Ot.webInput}),(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Data de Fim:"}),(0,I.jsx)("input",{type:"date",value:Be.toISOString().slice(0,10),onChange:e=>Ie(new Date(e.target.value)),style:Ot.webInput}),(0,I.jsx)(u.default,{style:[Ot.label,{color:Ne}],children:"Hora de Fim:"}),(0,I.jsx)("input",{type:"time",value:Pe.toTimeString().slice(0,5),onChange:e=>{const[t,a]=e.target.value.split(":"),o=new Date(Pe);o.setHours(+t),o.setMinutes(+a),Ae(o)},style:Ot.webInput})]}),(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"Descri\xe7\xe3o:"}),(0,I.jsx)(S.default,{mode:"outlined",value:ue,onChangeText:e=>fe(Ge(e)),style:Ot.input}),(0,I.jsx)(W.default,{style:[Ot.label,{color:Ne}],children:"Cor:"}),(0,I.jsxs)(b.default,{onPress:()=>je(!0),style:Ot.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:me}]}),(0,I.jsx)(W.default,{style:{color:Ne},children:"Clique para alterar cor"})]}),(0,I.jsxs)(n.default,{style:Ot.buttonsRow,children:[(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!se)return;window.confirm("Guardar altera\xe7\xf5es no evento?")&&Ze()},style:Ot.saveButtonSmall,children:"Salvar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!se)return;window.confirm("Tem a certeza que pretende eliminar o evento de forma permanente?")&&Qe()},style:Ot.deleteButtonSmall,children:"Apagar"})]}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>ye(!1),labelStyle:{color:"#47AD4D"},children:"Cancelar"})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:Ot.summaryContainer,children:[(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"T\xedtulo:"}),(0,I.jsx)(W.default,{style:Ot.summaryValue,children:de})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"In\xedcio:"}),(0,I.jsxs)(W.default,{style:Ot.summaryValue,children:[Ce.toISOString().slice(0,10)," ",we.toTimeString().slice(0,5)]})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Fim:"}),(0,I.jsxs)(W.default,{style:Ot.summaryValue,children:[Be.toISOString().slice(0,10)," ",Pe.toTimeString().slice(0,5)]})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Descri\xe7\xe3o:"}),(0,I.jsx)(W.default,{style:Ot.summaryValue,children:ue})]}),(0,I.jsxs)(n.default,{style:Ot.summaryRow,children:[(0,I.jsx)(W.default,{style:Ot.summaryLabel,children:"Cor:"}),(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:me}]})]})]}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>ye(!0),style:Ot.editButton,labelStyle:{color:"#47AD4D"},children:"Editar"})]})]})})]})}),(0,I.jsx)(D.default,{visible:be,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Ot.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:Ot.colorModalContainer,children:[(0,I.jsx)(W.default,{style:Ot.modalTitle,children:"Selecionar Cor do Evento"}),Me.map((e=>(0,I.jsxs)(b.default,{style:Ot.colorOptionRow,onPress:()=>{ge(e.value),je(!1)},children:[(0,I.jsx)(n.default,{style:[Ot.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>je(!1),style:{backgroundColor:"#47AD4D"},children:"Fechar"})]})})}),(0,I.jsx)(A,{visible:Ve,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>_e(!1),navigation:t,email:i})]})},_t=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,width:"100%",padding:16,justifyContent:"center",alignItems:"center"},box:{width:"90%",maxWidth:400,borderRadius:12,padding:24,elevation:3,alignItems:"center"},headerRow:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},title:{fontWeight:"bold",color:"#000"},input:{width:"100%",backgroundColor:"#fff"},submitButton:{width:"100%",marginTop:16,backgroundColor:"#47AD4D"},errorText:{color:"#B00020",marginTop:8},link:{textAlign:"center",marginTop:8},iconStyle:{width:24,height:24,resizeMode:"contain"}}),Wt=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),o=t.params?.email||"",i=`${c.baseUrl}/loginFiles/updatePassword.php`,[d,f]=(0,r.useState)(""),[m,x]=(0,r.useState)(""),[y,j]=(0,r.useState)(!1),[C,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(""),[F,D]=(0,r.useState)(!1);return F?(0,I.jsx)(h.default,{source:a(8922),style:_t.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:a(8922),style:_t.background,children:[(0,I.jsx)(p.default,{barStyle:"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsx)(ne.default,{behavior:"padding",style:_t.container,children:(0,I.jsxs)(n.default,{style:[_t.box,{backgroundColor:"#FFFFFF"}],children:[(0,I.jsxs)(n.default,{style:_t.headerRow,children:[(0,I.jsx)(u.default,{style:{fontSize:24,fontWeight:"bold",color:"#000",textAlign:"center"},children:"Nova Palavra\u2011Passe"}),(0,I.jsx)(n.default,{style:{width:60}})]}),(0,I.jsx)(S.default,{label:"Nova Palavra\u2011Passe",value:d,onChangeText:f,secureTextEntry:!y,mode:"outlined",style:_t.input,theme:{colors:{primary:"#47AD4D",background:"#fff",text:"#000"}},right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(b.default,{onPress:()=>j((e=>!e)),children:(0,I.jsx)(g.default,{source:a(y?6751:7051),style:_t.iconStyle})})})}),(0,I.jsx)(S.default,{label:"Confirmar Palavra\u2011Passe",value:m,onChangeText:x,secureTextEntry:!C,mode:"outlined",style:[_t.input,{marginTop:10}],theme:{colors:{primary:"#47AD4D",background:"#fff",text:"#000"}},right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(b.default,{onPress:()=>v((e=>!e)),children:(0,I.jsx)(g.default,{source:a(C?6751:7051),style:_t.iconStyle})})})}),w?(0,I.jsx)(se.default,{type:"error",visible:!0,style:_t.errorText,children:w}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(d.length<6?(k("Para a sua seguran\xe7a pedimos que a palavra-passe tenha pelo menos 6 caracteres."),0):d!==m?(k("As palavras-passes n\xe3o coincidem."),0):(k(""),1)){D(!0);try{const t=await B.default.post(i,{email:o,newPassword:d});if(t.data.success){if("aluno"===t.data.userRole&&!t.data.studentDetailsComplete)return void D(!1);const a="A sua palavra-passe foi criada. Agora, fa\xe7a login com a nova palavra\u2011passe.";window.alert(a),e.replace("Login")}else k(t.data.message||"Ocorreu um problema enquanto tentavamos atualizar a sua palavra-passe.")}catch{k("Ocorreu um problema enquanto tentavamos conectar aos nossos servidores. Pedimos que tente novamente.")}finally{D(!1)}}},style:_t.submitButton,labelStyle:{color:"#fff"},children:"Confirmar"}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>e.navigate("Login"),style:_t.link,labelStyle:{color:"#47AD4D"},children:"Voltar"})]})})]})};const Ht=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,width:"100%",padding:16,justifyContent:"center",alignItems:"center"},box:{width:"90%",maxWidth:400,borderRadius:12,padding:24,elevation:3,alignItems:"center"},form:{width:"100%"},subtitle:{marginTop:8,textAlign:"center",color:"#333"},input:{width:"100%",marginBottom:8,backgroundColor:"#fff"},submitButton:{width:"100%",marginTop:12,backgroundColor:"#47AD4D"},resendButton:{width:"100%",marginTop:8,borderColor:"#47AD4D"},errorText:{color:"#B00020",marginBottom:4},backButton:{marginTop:16,alignSelf:"center"},link:{textAlign:"center",marginTop:8}}),$t=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),o=t.params?.email||"",i=`${c.baseUrl}/loginFiles/sendVerificationCode.php`,d=`${c.baseUrl}/loginFiles/verifyCode.php`,[m,g]=(0,r.useState)(""),[x,y]=(0,r.useState)(""),[b,j]=(0,r.useState)(!1),[C,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(0),F=(0,r.useRef)(null),D=(0,r.useCallback)((async()=>{if(!(C||w>0)){v(!0),y("");try{const e=await B.default.post(i,{email:o},{headers:{"Content-Type":"application/json"}});e.data.success?(k(60),F.current=setInterval((()=>{k((e=>e<=1?(F.current&&clearInterval(F.current),0):e-1))}),1e3)):y(e.data.message||"Ocorreu um erro da nossa parte ao tentar enviar o c\xf3digo para o seu email. Pedimos que tente novamente mais tarde.")}catch{y("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{v(!1)}}}),[o,C,w]);(0,r.useEffect)((()=>{o&&D()}),[o,D]);return b?(0,I.jsx)(h.default,{source:a(8922),style:Ht.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:a(8922),style:Ht.background,children:[(0,I.jsx)(p.default,{barStyle:"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsx)(ne.default,{behavior:"padding",style:Ht.container,children:(0,I.jsx)(n.default,{style:[Ht.box,{backgroundColor:"#FFFFFF"}],children:(0,I.jsxs)(f.default,{contentContainerStyle:Ht.form,children:[(0,I.jsx)(u.default,{style:{fontSize:24,fontWeight:"bold",color:"#000",textAlign:"center"},children:"Verifica\xe7\xe3o adicional"}),(0,I.jsxs)(u.default,{style:Ht.subtitle,children:["Para a sua seguran\xe7a enviamos um c\xf3digo para:","\n",(0,I.jsx)(u.default,{style:{fontWeight:"bold",marginBottom:20},children:o})]}),(0,I.jsx)(S.default,{label:"C\xf3digo de Verifica\xe7\xe3o",value:m,onChangeText:g,mode:"outlined",keyboardType:"numeric",style:Ht.input,theme:{colors:{primary:"#47AD4D",background:"#fff",text:"#000"}}}),x?(0,I.jsx)(se.default,{type:"error",visible:!0,style:Ht.errorText,children:x}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(m.trim()){j(!0);try{const t=await B.default.post(d,{email:o,code:m},{headers:{"Content-Type":"application/json"}});t.data.success?(window.alert("C\xf3digo verificado com sucesso!"),e.replace("InsertPasswordScreen",{email:o})):y(t.data.message||"O c\xf3digo que inseriu n\xe3o \xe9 o mesmo que foi enviado para o seu email.")}catch{y("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{j(!1)}}else y("Por favor, para a sua seguran\xe7a pedimos que insira o c\xf3digo de verifica\xe7\xe3o.")},style:Ht.submitButton,labelStyle:{color:"#fff"},disabled:b,children:"Confirmar C\xf3digo"}),(0,I.jsx)(T.default,{mode:"outlined",onPress:D,style:Ht.resendButton,labelStyle:{color:"#47AD4D"},disabled:w>0||C,children:w>0?`Reenviar em ${w}s`:"Reenviar C\xf3digo"}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>e.navigate("Login"),style:Ht.link,labelStyle:{color:"#47AD4D"},children:"Voltar"})]})})})]})};const Lt=m.default.create({iconStyle:{width:24,height:24,resizeMode:"contain"},background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,justifyContent:"center",alignItems:"center",padding:16,width:"100%"},box:{width:"90%",maxWidth:400,backgroundColor:"white",borderRadius:12,padding:24,elevation:4,shadowColor:"#000",shadowOpacity:.2,shadowRadius:8,shadowOffset:{width:0,height:2},alignItems:"center"},title:{marginBottom:16,fontWeight:"700",textAlign:"center"},input:{width:"100%",marginBottom:16,backgroundColor:"white"},submitButton:{width:"100%",marginTop:8,backgroundColor:"#47AD4D"},errorText:{color:"#D9534F",marginBottom:8,textAlign:"center"},backText:{color:"#D9534F",marginTop:12}}),Nt=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o}=t.params,i=`${c.baseUrl}/forgetPasswordfiles/SaveNewPassForgetPassword.php`,[d,u]=(0,r.useState)(""),[f,m]=(0,r.useState)(""),[p,x]=(0,r.useState)(!1),[y,j]=(0,r.useState)(!1),[C,v]=(0,r.useState)(""),[w,k]=(0,r.useState)(!1),F=e=>{window.alert(e)};return w?(0,I.jsx)(h.default,{source:a(8922),style:Lt.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsx)(h.default,{source:a(8922),style:Lt.background,children:(0,I.jsx)(ne.default,{behavior:void 0,style:Lt.container,children:(0,I.jsxs)(n.default,{style:Lt.box,children:[(0,I.jsx)(W.default,{variant:"headlineMedium",style:[Lt.title,{color:"#000"}],children:"Atualizar a palavra\u2011passe"}),""!==C&&(0,I.jsx)(se.default,{type:"error",visible:!0,style:Lt.errorText,children:C}),(0,I.jsx)(S.default,{label:"Palavra\u2011passe",value:d,onChangeText:u,secureTextEntry:!p,mode:"outlined",style:Lt.input,outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D",right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(b.default,{onPress:()=>x((e=>!e)),children:(0,I.jsx)(g.default,{source:a(p?6751:7051),style:Lt.iconStyle})})})}),(0,I.jsx)(S.default,{label:"Confirmar a palavra\u2011passe",value:f,onChangeText:m,secureTextEntry:!y,mode:"outlined",style:Lt.input,outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D",right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(b.default,{onPress:()=>j((e=>!e)),children:(0,I.jsx)(g.default,{source:a(y?6751:7051),style:Lt.iconStyle})})})}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(d.length<6)F("Para a sua seguran\xe7a pedimos que coloque uma palavra-passe com mais de 6 caracteres.");else if(d===f){k(!0),v("");try{const{data:t}=await B.default.post(i,{email:o,newPassword:d});if(t.success){F("A sua palavra\u2011passe atualizada com sucesso!"),e.replace("Login")}else v(t.message||"Ocorreu um erro da nossa para enquanto tentavamos atualizar a sua palavra\u2011passe. Pedimos que tente novamente.")}catch(t){v("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{k(!1)}}else F("As palavras-passes n\xe3o s\xe3o iguais.")},style:Lt.submitButton,labelStyle:{color:"#FFF"},disabled:!d||!f,children:"Atualizar a palavra-passe"}),(0,I.jsx)(b.default,{onPress:()=>e.replace("Login"),children:(0,I.jsx)(W.default,{style:Lt.backText,children:"Cancelar"})})]})})})};const Mt=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,justifyContent:"center",alignItems:"center",width:"100%",padding:16},box:{borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,backgroundColor:"white",shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},title:{marginBottom:16,fontWeight:"bold",color:"#333"},input:{width:"100%",marginBottom:16,backgroundColor:"white"},link:{textAlign:"center",marginTop:-8},verifyButton:{width:"100%",marginBottom:16,backgroundColor:"#47AD4D"},errorText:{color:"red",marginBottom:8},backText:{color:"red",marginTop:8},toastContainer:{position:"absolute",top:-200,left:16,right:16,alignItems:"center",zIndex:10},toastBox:{backgroundColor:"#47AD4D",borderRadius:14,paddingVertical:12,paddingHorizontal:24,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:4},toastText:{color:"#FFF",fontSize:14}}),Ut=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o="",initialMessage:i=""}=t.params,d=`${c.baseUrl}/forgetPasswordfiles/validateCodeForgetPassword.php`,u=`${c.baseUrl}/forgetPasswordfiles/sendEmailForgetPassword.php`,[f,m]=(0,r.useState)({email:o,code:""}),[g,p]=(0,r.useState)(""),[x,y]=(0,r.useState)(""),[j,C]=(0,r.useState)(!1),[v,w]=(0,r.useState)(0);(0,r.useEffect)((()=>{i&&(y(i),setTimeout((()=>{y("")}),2e3))}),[i]),(0,r.useEffect)((()=>{let e;return v>0&&(e=setInterval((()=>{w((e=>e<=1?0:e-1))}),1e3)),()=>clearInterval(e)}),[v]);return j?(0,I.jsx)(h.default,{source:a(8922),style:Mt.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsx)(h.default,{source:a(8922),style:Mt.background,children:(0,I.jsx)(ne.default,{behavior:"padding",style:Mt.container,children:(0,I.jsxs)(n.default,{style:Mt.box,children:[(0,I.jsx)(W.default,{variant:"headlineMedium",style:Mt.title,children:"C\xf3digo de verifica\xe7\xe3o"}),""!==x&&(0,I.jsx)(n.default,{style:Mt.toastContainer,children:(0,I.jsx)(n.default,{style:Mt.toastBox,children:(0,I.jsx)(W.default,{style:Mt.toastText,children:x})})}),""!==g&&(0,I.jsx)(se.default,{type:"error",visible:!0,style:Mt.errorText,children:g}),(0,I.jsx)(S.default,{label:"C\xf3digo",value:f.code,onChangeText:e=>{return t="code",a=e,void m(Object.assign({},f,{[t]:a}));var t,a},mode:"outlined",style:Mt.input,keyboardType:"number-pad",outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D"}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(f.code){C(!0),p("");try{const t=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f.email,code:f.code})}),a=await t.json();a.success?(y("C\xf3digo verificado com sucesso!"),setTimeout((()=>y("")),2e3),setTimeout((()=>{e.navigate("PutNewPassForgetPassword",{email:f.email})}),1e3)):p(a.message||"Ocorreu um erro da nossa parte enquanto tentavamos validar o c\xf3digo. Pedimos que tente novamente.")}catch{p("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{C(!1)}}else p("Pedimos que insira o c\xf3digo enviado para o seu email.")},style:Mt.verifyButton,labelStyle:{color:"#fff"},children:"Verificar C\xf3digo"}),(0,I.jsx)(T.default,{mode:"text",onPress:async()=>{if(!(v>0)){w(60),C(!0),p("");try{const e=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f.email})}),t=await e.json();if(t.success){const e=t.message||`Enviamos o c\xf3digo novamente para ${f.email} com sucesso!`;y(e),setTimeout((()=>y("")),5e3)}else p(t.message||"N\xe3o conseguimos enviar o c\xf3digo novamente. Pedimos que tente novamente.")}catch{p("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")}finally{C(!1)}}},disabled:v>0,style:Mt.link,labelStyle:{color:"#47AD4D"},children:v>0?`Reenviar c\xf3digo (${v}s)`:"Reenviar c\xf3digo"}),(0,I.jsx)(b.default,{onPress:()=>e.replace("Login"),children:(0,I.jsx)(W.default,{style:Mt.backText,children:"Voltar"})})]})})})};const qt=m.default.create({background:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,justifyContent:"center",alignItems:"center",width:"100%",padding:16},box:{backgroundColor:"white",borderRadius:12,padding:24,width:"90%",maxWidth:400,elevation:3,shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2},alignItems:"center"},title:{marginBottom:16,fontWeight:"bold"},input:{width:"100%",marginBottom:16},sendLinkButton:{width:"100%",marginBottom:16,backgroundColor:"#47AD4D"},backToLoginButton:{alignSelf:"center",marginTop:4}}),Gt=()=>{const e=(0,s.useNavigation)(),t=`${c.baseUrl}/forgetPasswordFiles/sendEmailForgetPassword.php`,[o,i]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[f,m]=(0,r.useState)(!1);return f?(0,I.jsx)(h.default,{source:a(8922),style:qt.background,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsx)(h.default,{source:a(8922),style:qt.background,children:(0,I.jsx)(ne.default,{behavior:"padding",style:qt.container,children:(0,I.jsxs)(n.default,{style:qt.box,children:[(0,I.jsx)(W.default,{variant:"titleLarge",style:qt.title,children:"Recuperar a palavra-passe"}),(0,I.jsx)(W.default,{variant:"bodySmall",style:qt.title,children:"Insira o seu email, em seguida ser\xe1 enviado um c\xf3digo para o seu email para validar a sua identidade e por fim poder\xe1 alterar a palavra-passe."}),""!==d&&(0,I.jsx)(se.default,{type:"error",visible:!0,children:d}),(0,I.jsx)(S.default,{label:"Email",value:o,onChangeText:i,mode:"outlined",style:qt.input,keyboardType:"email-address",outlineColor:"#47AD4D",activeOutlineColor:"#47AD4D"}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(u(""),o)if(o.includes("@etps.com.pt")){m(!0);try{const a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}),r=await a.json();r.success?e.navigate("VerifyCodeForgetPassword",{email:o,initialMessage:r.message||"Pedimos que verifique o c\xf3digo que enviamos para o seu email."}):!0===r.emailNaoExiste?(u("N\xe3o foi poss\xedvel encontrar o email fornecido na nossa base de dados. Se quiser pode criar uma conta."),e.navigate("Login")):u("N\xe3o foi poss\xedvel encontrar o email fornecido na nossa base de dados. Se quiser pode criar uma conta.")}catch(a){u("Ocorreu um erro da nossa parte enquanto tentavamos enviar um c\xf3digo para o seu email. Pedimos que tente novamente mais tarde.")}finally{m(!1)}}else u("Pedimos que insira um email v\xe1lido.");else u("Pedimos que coloque o seu email no campo.")},style:qt.sendLinkButton,children:"Enviar c\xf3digo para o email"}),(0,I.jsx)(T.default,{mode:"text",onPress:()=>e.navigate("Login"),style:qt.backToLoginButton,textColor:"red",children:"Voltar"})]})})})};var Jt=a(211);const Yt=m.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#fff"},title:{fontSize:24,marginBottom:20},info:{fontSize:16,marginTop:20,textAlign:"center",paddingHorizontal:20}}),Zt=()=>(0,I.jsxs)(n.default,{style:Yt.container,children:[(0,I.jsx)(u.default,{style:Yt.title,children:"QR Code de Entrada/Sa\xedda"}),(0,I.jsx)(Jt.default,{value:"entrada-saida",size:200}),(0,I.jsx)(u.default,{style:Yt.info,children:"Fa\xe7a scan este c\xf3digo para registrar sua entrada/sa\xedda"})]});var Qt=a(9931),Kt=a(9818);const Xt=m.default.create({scrollContent:{padding:16,paddingBottom:32},card:{borderRadius:12,elevation:4,overflow:"hidden"},background:{flex:1},overlayDark:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1},loadingContainer:{flex:1,alignItems:"center",justifyContent:"center"},loadingText:{fontSize:18,marginTop:10},fixedBox:{alignSelf:"center",width:"90%",borderRadius:12,overflow:"hidden",elevation:5,shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,marginTop:p.default.currentHeight||20,marginBottom:20},contentContainer:{flexGrow:1,paddingTop:60,paddingHorizontal:20,paddingBottom:20},inputsWrapper:{flex:1,justifyContent:"center"},input:{marginBottom:15},botao:{marginTop:20},carregamento:{marginTop:10},previewContainer:{marginVertical:20,alignItems:"center",justifyContent:"center"},previewTitle:{fontSize:16,fontWeight:"600",marginBottom:10},pdfContainer:{width:"100%",height:400,backgroundColor:"#ddd",borderWidth:0},pdfPreview:{flex:1},botoesPreview:{flexDirection:"row",marginTop:10},botaoSalvar:{marginRight:10},botaoMudar:{},modalFundo:{flex:1,backgroundColor:"rgba(0,0,0,0.3)",justifyContent:"center",paddingHorizontal:20},modalContent:{borderRadius:8,padding:20,maxHeight:"80%"},modalTitulo:{fontSize:18,fontWeight:"bold",marginBottom:15},modalItem:{paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#ccc"}}),ea=({navigation:e,route:t})=>{const o=(0,j.useTheme)(),{email:s}=t.params,[i,d]=(0,r.useState)([]),[m,x]=(0,r.useState)(""),[y,C]=(0,r.useState)(""),[v,w]=(0,r.useState)(!1),[k,F]=(0,r.useState)(null),[B,P]=(0,r.useState)(null),[z,R]=(0,r.useState)(!1),[E,V]=(0,r.useState)(null),[W,H]=(0,r.useState)(null),[$,L]=(0,r.useState)(o.dark?"dark":"light"),[N,U]=(0,r.useState)(!0),[q,G]=(0,r.useState)(!1),[J,Y]=(0,r.useState)(!1),Z=`${c.baseUrl}/adminFiles/getTurmas.php`,Q=`${c.baseUrl}/adminFiles/uploadCalendar.php`,K=k,X=p.default.currentHeight||20,ee=M.default.get("window").height;(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),H(e),L("dark"===t?"dark":"light")}catch(e){console.log("[DEBUG] Erro ao carregar as configura\xe7\xf5es:",e)}finally{U(!1)}}()}),[]),(0,r.useEffect)((()=>{fetch(Z).then((e=>e.json())).then((e=>{e.success?(console.log("[DEBUG] Turmas recebidas:",e.data),d(e.data),d(Array.isArray(e.turmas)?e.turmas:[])):(console.log("[DEBUG] Erro ao buscar turmas:",e.message),O.default.alert("Erro",e.message||"Erro ao buscar turmas."))})).catch((()=>{console.log("[DEBUG] Erro na comunica\xe7\xe3o com o servidor."),O.default.alert("Erro","Erro na comunica\xe7\xe3o com o servidor.")}))}),[Z]);if(N)return(0,I.jsx)(ne.default,{style:{flex:1},behavior:"height",children:(0,I.jsxs)(h.default,{source:W?{uri:W}:a(8922),style:Xt.background,children:["dark"===$&&(0,I.jsx)(n.default,{style:Xt.overlayDark}),(0,I.jsxs)(n.default,{style:Xt.loadingContainer,children:[(0,I.jsx)(l.default,{size:"large",color:"dark"===$?"#e0dede":"#000"}),(0,I.jsx)(u.default,{style:[Xt.loadingText,{color:"dark"===$?"#e0dede":"#000"}],children:"Carregando registros..."})]})]})});const te="dark"===$?"#101218":"#FFFFFF",ae="dark"===$?"#3F4454":"#FFFFFF",oe="dark"===$?"#FFFFFF":"#000000";let re,le;return k?(re=.85*ee,le=.1*ee):m&&y?(re=.7*ee,le=.1*ee):(re=.6*ee,le=.15*ee),(0,I.jsx)(ne.default,{style:{flex:1},behavior:"height",children:(0,I.jsxs)(h.default,{source:W?{uri:W}:a(8922),style:{flex:1,width:"100%",height:"100%"},resizeMode:"cover",children:[(0,I.jsxs)(_.default,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:X,paddingHorizontal:16,paddingBottom:12,backgroundColor:te,position:"absolute",top:0,left:0,right:0,zIndex:10,shadowColor:"#000",shadowOpacity:.1,shadowRadius:6,elevation:4},children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),style:{padding:8},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:36,height:36,tintColor:oe}})}),(0,I.jsx)(b.default,{onPress:()=>Y(!0),style:{padding:8},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:32,height:32,tintColor:oe}})})]}),(0,I.jsxs)(f.default,{style:{flex:1},contentContainerStyle:{flexGrow:1,flexDirection:K?"row":"column",justifyContent:"space-between",alignItems:K?"flex-start":"stretch",paddingTop:X+60,paddingBottom:16,paddingHorizontal:16},children:[(0,I.jsxs)(n.default,{style:{flex:K?.48:void 0,width:K?void 0:"100%",marginBottom:k?24:0},children:[(0,I.jsx)(Qt.default,{style:{borderRadius:8,overflow:"hidden",marginBottom:16},children:(0,I.jsxs)(Qt.default.Content,{style:{paddingVertical:12,paddingHorizontal:8,backgroundColor:"dark"===$?"#FFFFFF":"#dedad5"},children:[(0,I.jsx)(b.default,{onPress:()=>w(!0),children:(0,I.jsx)(S.default,{label:"Ano",value:m,mode:"outlined",editable:!1,style:{backgroundColor:ae,color:oe,marginBottom:12},theme:{colors:{text:oe,placeholder:oe,primary:"#47AD4D",background:ae}}})}),(0,I.jsx)(b.default,{onPress:()=>w(!0),children:(0,I.jsx)(S.default,{label:"Turma",value:y,mode:"outlined",editable:!1,style:{backgroundColor:ae,color:oe},theme:{colors:{text:oe,placeholder:oe,primary:"#47AD4D",background:ae}}})})]})}),m&&y&&!k&&(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{try{w(!1),setTimeout((async()=>{const e=await Kt.getDocumentAsync({type:"application/pdf"});if(console.log("[DEBUG] Resultado do DocumentPicker:",e),!e.canceled&&e.assets&&e.assets.length>0){const a=e.assets[0];console.log("[DEBUG] Arquivo selecionado:",a),F(a),V(a.name);try{{const e=await fetch(a.uri),t=await e.blob(),o=new FileReader;o.onloadend=()=>{let e=o.result;e=e.split(",")[1],P(e)},o.readAsDataURL(t)}}catch(t){console.log("[DEBUG] Erro ao ler o arquivo como base64:",t),O.default.alert("Erro","N\xe3o foi poss\xedvel ler o arquivo para pr\xe9-visualiza\xe7\xe3o.")}}else console.log("[DEBUG] Sele\xe7\xe3o cancelada ou sem sucesso")}),100)}catch(e){console.log("[DEBUG] Erro ao selecionar o arquivo:",e),O.default.alert("Erro","N\xe3o foi poss\xedvel selecionar o arquivo.")}},contentStyle:{paddingVertical:8},style:{borderRadius:6,backgroundColor:"#47AD4D"},children:"Selecionar PDF"})]}),k&&(0,I.jsxs)(n.default,{style:{flex:K?.48:void 0,width:K?void 0:"100%",backgroundColor:te,borderRadius:8,padding:16,marginLeft:K?16:0,alignSelf:K?"flex-start":void 0,shadowColor:"#000",shadowOpacity:.1,shadowRadius:6,elevation:4},children:[(0,I.jsx)(u.default,{style:{fontSize:16,fontWeight:"500",color:oe,marginBottom:12},children:"Pr\xe9-visualiza\xe7\xe3o do PDF"}),(()=>{if(!B)return null;const e=((e,t=1)=>`\n      <!DOCTYPE html> \n      <html>\n        <head>\n          <meta charset="utf-8">\n          <title>PDF Preview</title>\n          <style>\n            html, body { \n              margin: 0; \n              height: 100vh; \n              overflow: hidden; \n              display: flex; \n              justify-content: center; \n              align-items: center; \n              background-color: #eee;\n            }\n            #canvas_container { \n              width: 100vw; \n              height: 100vh; \n              display: flex; \n              justify-content: center; \n              align-items: center; \n              overflow: hidden; \n            }\n            canvas { \n              display: block; \n              max-width: 90vw;  \n              max-height: 90vh;\n              object-fit: contain;\n            }\n          </style>\n          <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"><\/script>\n        </head>\n        <body>\n          <div id="canvas_container"></div>\n          <script>\n            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';\n            var pdfData = "${e}";\n            var loadingTask = pdfjsLib.getDocument({ data: atob(pdfData) });\n\n            loadingTask.promise.then(function(pdf) {\n              pdf.getPage(1).then(function(page) {\n                var scale = ${t};\n                var viewport = page.getViewport({ scale: scale });\n\n                var canvas = document.createElement("canvas");\n                var context = canvas.getContext("2d");\n\n                canvas.height = viewport.height;\n                canvas.width = viewport.width;\n\n                // Adiciona o canvas ao container\n                document.getElementById('canvas_container').appendChild(canvas);\n\n                var renderContext = {\n                  canvasContext: context,\n                  viewport: viewport\n                };\n\n                page.render(renderContext);\n              });\n            });\n          <\/script>\n        </body>\n      </html>\n    `)(B,1);return(0,I.jsx)("iframe",{srcDoc:e,style:Xt.pdfContainer,title:"PDF Preview"})})(),(0,I.jsx)(u.default,{style:{marginTop:8,color:oe},children:E}),(0,I.jsxs)(n.default,{style:{flexDirection:"row",marginTop:16,width:"100%"},children:[(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(m&&y&&k){R(!0);try{const t=new FormData;t.append("ano",m),t.append("turma",y);{const e=await fetch(k.uri),a=await e.blob();t.append("pdf",a,k.name)}console.log("[DEBUG] Enviando FormData:",t);const a=await fetch(Q,{method:"POST",body:t}),o=await a.json();console.log("[DEBUG] Resposta do servidor:",o),o.success?(O.default.alert("Sucesso",o.message),e.navigate("Administrador",{email:s})):O.default.alert("Erro",o.message)}catch(t){console.error("[DEBUG] Erro no upload:",t),O.default.alert("Erro","Erro ao fazer upload.")}finally{R(!1)}}else O.default.alert("Aten\xe7\xe3o","Selecione o ano, a turma e o PDF.")},contentStyle:{paddingVertical:6},style:{flex:1,marginRight:8,borderRadius:6,backgroundColor:"#47AD4D"},children:"Salvar"}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>{w(!1),P(null),F(null),V(null)},contentStyle:{paddingVertical:6},style:{flex:1,borderRadius:6},textColor:"#47AD4D",children:"Mudar"})]}),z&&(0,I.jsx)(l.default,{size:"large",style:{marginTop:16},color:"dark"===$?"#FFF":"#000"})]})]}),(0,I.jsx)(D.default,{animationType:"slide",transparent:!0,visible:v,onRequestClose:()=>w(!1),children:(0,I.jsx)(b.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",padding:16},onPress:()=>w(!1),children:(0,I.jsxs)(n.default,{style:{backgroundColor:te,borderRadius:10,padding:16},children:[(0,I.jsx)(u.default,{style:{fontSize:18,marginBottom:12,color:oe},children:"Selecione o Ano e a Turma"}),i.map(((e,t)=>(0,I.jsx)(b.default,{onPress:()=>{x(e.ano),C(e.turma),w(!1)},style:{paddingVertical:10},children:(0,I.jsxs)(u.default,{style:{fontSize:16,color:oe},children:[e.ano," \u2013 ",e.turma]})},t)))]})})}),(0,I.jsx)(A,{visible:J,dynamicHeaderBackground:"dark"===$?"#101218":"#FFF",dynamicTextColor:oe,onClose:()=>Y(!1),navigation:e,email:s})]})})},{width:ta,height:aa}=M.default.get("window"),oa=e=>e instanceof Date&&!isNaN(e.getTime())?e.toISOString().split("T")[0]:null,ra=m.default.create({background:{flex:1},scrollContainer:{paddingHorizontal:10,paddingBottom:20,paddingTop:80},headerContainer:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},headerButton:{flex:1},headerIcon:{width:35,height:35,tintColor:"#5F6368"},calendarWrapper:{backgroundColor:"#FFF",borderRadius:8,padding:10,marginVertical:15},box:{backgroundColor:"#ffffffaa",marginBottom:20,borderRadius:8,padding:15},titulo:{fontSize:18,fontWeight:"bold",marginBottom:10,color:"#000"},input:{marginBottom:10,backgroundColor:"#fff"},botao:{backgroundColor:"green",marginTop:10},statsContainer:{marginTop:10},statsTexto:{fontSize:14,color:"#000",marginBottom:5},menuItem:{marginBottom:10,borderBottomWidth:1,borderColor:"#ccc",paddingBottom:5},selectedEventContainer:{backgroundColor:"rgba(0,128,0,0.7)",borderRadius:4,padding:2,alignSelf:"center",marginRight:2,height:50,width:50},menuEventContainer:{backgroundColor:"rgba(0,128,0,0.7)",borderRadius:4,padding:2,alignSelf:"center",marginRight:2,height:50,width:50},eventText:{fontSize:30},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},loadingContent:{alignItems:"center"},loadingText:{marginTop:10,fontSize:16},overlayDark:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.3)"})}),la=({navigation:e})=>{const t=(0,j.useTheme)(),o=`${c.baseUrl}/auxiliarFiles/salvar_menu.php`,s=`${c.baseUrl}/auxiliarFiles/listar_menus.php`,[i,d]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[y,C]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[k,F]=(0,r.useState)(""),[D,B]=(0,r.useState)(!0),[P,z]=(0,r.useState)(null),[R,E]=(0,r.useState)([]),[V,_]=(0,r.useState)(!1),[W]=(0,r.useState)({email:"exemplo@dominio.com"}),[H,$]=(0,r.useState)(null),[L,M]=(0,r.useState)(t.dark?"dark":"light"),[U,G]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),$(e),M("dark"===t?"dark":"light")}catch(e){console.error("Erro ao carregar configura\xe7\xf5es:",e)}finally{B(!1)}})()}),[]);const J=["2025-04-25","2025-05-01"],Y="2025-08-01",Z="2025-08-31",Q=(e,t)=>e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate(),K=e=>{if(isNaN(e.getTime()))return void console.error("Data inv\xe1lida no onPressCell:",e);const t=e.getDay(),a=oa(e);if(console.log("Pressed date:",a),0===t||6===t)return O.default.alert("Aviso","N\xe3o \xe9 poss\xedvel selecionar fins de semana."),x((t=>[...t,e])),void setTimeout((()=>{x((t=>t.filter((t=>!Q(t,e)))))}),3e3);a&&J.includes(a)?O.default.alert("Aviso","N\xe3o \xe9 poss\xedvel selecionar feriados."):a&&a>=Y&&a<=Z?O.default.alert("Aviso","N\xe3o \xe9 poss\xedvel selecionar datas nas f\xe9rias."):(e=>{isNaN(e.getTime())?console.error("Tentativa de alternar data inv\xe1lida:",e):d((t=>t.some((t=>Q(t,e)))?t.filter((t=>!Q(t,e))):[...t,e]))})(e)},X=async()=>{try{const e=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();if(t.success&&t.menus){const e=t.menus.map((e=>({date:e.dia,pratoPrincipal:e.prato_principal,sopa:e.sopa,sobremesa:e.sobremesa})));E(e)}else O.default.alert("Aviso","Nenhum menu encontrado.")}catch(e){}};(0,r.useEffect)((()=>{X()}),[]);const ee="dark"===L?"#e0dede":"#000";return(0,I.jsxs)(h.default,{source:H?{uri:H}:a(8922),style:ra.background,resizeMode:"cover",children:[(0,I.jsx)(p.default,{backgroundColor:"transparent",translucent:!0,barStyle:"dark-content"}),D?(0,I.jsxs)(n.default,{style:ra.loadingContainer,children:["dark"===L&&(0,I.jsx)(n.default,{style:ra.overlayDark}),(0,I.jsxs)(n.default,{style:ra.loadingContent,children:[(0,I.jsx)(l.default,{size:"large",color:ee}),(0,I.jsx)(u.default,{style:[ra.loadingText,{color:ee}],children:"Carregando registros..."})]})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:(0,I.jsx)(b.default,{onPress:()=>_(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===L?"#FFFFFF":"#000"}})})}),(0,I.jsxs)(f.default,{contentContainerStyle:ra.scrollContainer,refreshControl:(0,I.jsx)(N.default,{refreshing:U,onRefresh:()=>{G(!0),X(),G(!1)}}),children:[(0,I.jsxs)(n.default,{style:ra.calendarWrapper,children:[(0,I.jsx)(u.default,{style:ra.titulo,children:"Calend\xe1rio"}),(0,I.jsx)(q.Calendar,{events:[...i.filter((e=>!R.some((t=>t.date===oa(e))))).map((e=>({id:"selected-"+oa(e),title:"\u2713",start:e,end:e}))),...R.map((e=>({id:"menu-"+e.date,title:"\ud83c\udf74",start:new Date(e.date),end:new Date(e.date)})))],height:.75*aa,mode:"month",swipeEnabled:!0,weekStartsOn:1,showTime:!1,onPressCell:K,onPressEvent:e=>{"\u2713"===e.title&&K(e.start)},renderEvent:e=>{const t="\u2713"===e.title?ra.selectedEventContainer:ra.menuEventContainer;return(0,I.jsx)(n.default,{style:t,children:(0,I.jsx)(u.default,{style:[ra.eventText,{color:"dark"===L?"#FFF":"#000"}],children:e.title})})}})]}),(0,I.jsxs)(n.default,{style:ra.box,children:[(0,I.jsx)(u.default,{style:ra.titulo,children:"Criar um Menu"}),(0,I.jsx)(S.default,{label:"Prato Principal",value:y,onChangeText:C,mode:"outlined",outlineColor:"green",activeOutlineColor:"green",style:ra.input}),(0,I.jsx)(S.default,{label:"Sopa",value:v,onChangeText:w,mode:"outlined",outlineColor:"green",activeOutlineColor:"green",style:ra.input}),(0,I.jsx)(S.default,{label:"Sobremesa",value:k,onChangeText:F,mode:"outlined",outlineColor:"green",activeOutlineColor:"green",style:ra.input}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(0!==i.length)if(y&&v&&k)try{B(!0);for(const e of i){const t=oa(e);if(!t)continue;const a=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dia:t,sopa:v,prato_principal:y,sobremesa:k})}),r=await a.json();r.success||O.default.alert("Erro",`Falha ao salvar o menu para o dia ${t}: ${r.message}`)}await X(),d([]),C(""),w(""),F(""),O.default.alert("Sucesso","Menu(s) guardado(s) para os dias selecionados!")}catch(e){console.error("[ERROR] guardarMenu ->",e),O.default.alert("Erro","Ocorreu um erro ao guardar o menu.")}finally{B(!1)}else O.default.alert("Aten\xe7\xe3o","Preencha todos os campos do menu.");else O.default.alert("Aten\xe7\xe3o","Nenhum dia selecionado.")},style:ra.botao,children:"Guardar Menu"})]}),(0,I.jsxs)(n.default,{style:ra.box,children:[(0,I.jsx)(u.default,{style:ra.titulo,children:"Estat\xedsticas de Almo\xe7o"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>e.navigate("auxiliarEstatisticas"),style:ra.botao,children:"Estat\xedsticas de Almo\xe7o"}),P&&(0,I.jsxs)(n.default,{style:ra.statsContainer,children:[(0,I.jsxs)(u.default,{style:ra.statsTexto,children:["Total: ",P.totalPessoas," pessoas"]}),P.turmas.map(((e,t)=>(0,I.jsxs)(u.default,{style:ra.statsTexto,children:[e.nome,": ",e.quantidade," (",e.horario,")"]},t)))]})]}),(0,I.jsxs)(n.default,{style:ra.box,children:[(0,I.jsx)(u.default,{style:ra.titulo,children:"Menus J\xe1 inseridos"}),0===R.length?(0,I.jsx)(u.default,{style:ra.statsTexto,children:"Nenhum menu armazenado ainda."}):R.map(((e,t)=>(0,I.jsxs)(n.default,{style:ra.menuItem,children:[(0,I.jsxs)(u.default,{style:ra.statsTexto,children:["Dia: ",e.date]}),(0,I.jsxs)(u.default,{style:ra.statsTexto,children:["Prato Principal: ",e.pratoPrincipal]}),(0,I.jsxs)(u.default,{style:ra.statsTexto,children:["Sopa: ",e.sopa]}),(0,I.jsxs)(u.default,{style:ra.statsTexto,children:["Sobremesa: ",e.sobremesa]})]},t)))]})]}),(0,I.jsx)(A,{visible:V,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>_(!1),navigation:e,email:W.email})]})]})};var na=a(5495),sa=a(9695),ia=a(7682);const da=Object.assign({},j.DefaultTheme,{colors:Object.assign({},j.DefaultTheme.colors,{primary:"#47AD4D"})}),ca={school:a(698),account:a(3885),"account-circle":a(2256),refresh:a(781)},ua=e=>t=>(0,I.jsx)(g.default,{source:ca[e],style:{width:24,height:24,tintColor:t.color},resizeMode:"contain"});function fa({route:e,navigation:t}){const{colors:o}=(0,j.useTheme)(),l=e.params?.email??"",s={profInfo:`${c.baseUrl}/calendarioFiles/professor/fetchProfessorInfo.php`,turmas:`${c.baseUrl}/calendarioFiles/professor/fetch_turmas.php`,students:`${c.baseUrl}/calendarioFiles/professor/fetchStudents.php`,grades:`${c.baseUrl}/calendarioFiles/professor/fetchStudentGrades.php`},[i,d]=(0,r.useState)([]),[u,f]=(0,r.useState)(!0),[m,h]=(0,r.useState)(!1),[x,y]=(0,r.useState)(null),[C,v]=(0,r.useState)(null),[w,S]=(0,r.useState)(null),[T,k]=(0,r.useState)({}),[F,D]=(0,r.useState)(!1),P=(0,r.useCallback)((async()=>{y(null);try{const e=await B.default.post(s.profInfo,{email:l});if(!e.data.success)throw new Error("N\xe3o foi poss\xedvel obter dados do professor.");const t=e.data.professor.user_id,a=await B.default.post(s.turmas,{email:l});if(!a.data.success)throw new Error("Nenhuma turma encontrada.");const o=await Promise.all(a.data.turmas.map((async e=>{const a=await B.default.post(s.students,{professor_id:t,turma:e.turma,ano:e.ano}),o=a.data.success?a.data.students.map(((e,t)=>({id:"number"===typeof e.id?e.id:"number"===typeof e.user_id?e.user_id:t,email:e.email,turma:e.turma,ano:e.ano}))):[];return Object.assign({},e,{students:o})})));d(o)}catch(e){y(e.message||"Erro de conex\xe3o.")}finally{f(!1),h(!1)}}),[l]);(0,r.useEffect)((()=>{P()}),[P]);return u&&!m?(0,I.jsx)(_.default,{style:ga.center,children:(0,I.jsx)(na.default,{animating:!0,size:"large",color:o.primary})}):x?(0,I.jsxs)(_.default,{style:ga.center,children:[(0,I.jsx)(W.default,{style:{color:o.error,marginBottom:16},children:x}),(0,I.jsx)(Ye.default,{icon:ua("refresh"),size:36,onPress:P})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(p.default,{backgroundColor:da.colors.primary,barStyle:"light-content"}),(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#ddd"},children:[(0,I.jsx)(b.default,{onPress:()=>{t.goBack()},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>D(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"#000"}})})]}),(0,I.jsx)(_.default,{style:ga.container,children:(0,I.jsx)(V.default,{data:i,keyExtractor:e=>e.id.toString(),refreshControl:(0,I.jsx)(N.default,{refreshing:m,onRefresh:()=>{h(!0),P()},tintColor:da.colors.primary}),renderItem:({item:e})=>(0,I.jsx)(Qt.default,{style:ga.card,elevation:2,children:(0,I.jsxs)(sa.default,{title:`Turma ${e.ano}\xba ${e.turma}`,description:`${e.students.length} aluno(s)`,expanded:C===e.id,onPress:()=>v(C===e.id?null:e.id),right:()=>null,children:[(0,I.jsx)(H.default,{}),e.students.map((e=>(0,I.jsx)(sa.default,{title:e.email,expanded:w===e.id,onPress:async()=>{const t=w!==e.id;S(t?e.id:null),t&&await(async e=>{if(!T[e])try{const t=await B.default.post(s.grades,{professor_email:l,aluno_id:e});k((a=>Object.assign({},a,{[e]:t.data.success?t.data.grades:[]})))}catch{k((t=>Object.assign({},t,{[e]:[]})))}})(e.id)},left:ua("school"),right:()=>null,children:void 0===T[e.id]?(0,I.jsx)(na.default,{style:ga.innerLoader}):T[e.id].length>0?T[e.id].map((e=>(0,I.jsxs)(n.default,{style:ga.gradeRow,children:[(0,I.jsxs)(W.default,{style:ga.gradeDisc,children:[e.disciplina," (",e.modulo,")"]}),(0,I.jsxs)(W.default,{style:ga.gradeNota,children:["Nota: ",e.nota]}),(0,I.jsx)(W.default,{style:ga.gradeDate,children:new Date(e.data_lancamento).toLocaleDateString()}),(0,I.jsx)(H.default,{style:{marginVertical:6}})]},e.id))):(0,I.jsx)(W.default,{style:ga.noGrades,children:"Sem notas registradas"})},e.id)))]})}),ItemSeparatorComponent:()=>(0,I.jsx)(n.default,{style:{height:12}}),contentContainerStyle:{padding:16}})}),(0,I.jsx)(A,{visible:F,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>D(!1),navigation:t,email:l})]})}function ma(e){return(0,I.jsx)(ia.default,{theme:da,children:(0,I.jsx)(fa,Object.assign({},e))})}const ga=m.default.create({container:{flex:1,backgroundColor:"#fdfdfd",marginTop:70},center:{flex:1,justifyContent:"center",alignItems:"center",padding:16},card:{borderRadius:8},innerLoader:{margin:12},gradeRow:{paddingHorizontal:16},gradeDisc:{fontSize:14,fontWeight:"600"},gradeNota:{fontSize:14,marginTop:2},gradeDate:{fontSize:12,color:"#666",marginTop:2},noGrades:{padding:16,fontStyle:"italic",color:"#888"}}),ha=e=>new Date(e.getFullYear(),e.getMonth(),e.getDate()),pa=e=>`${e.getFullYear()}-${("0"+(e.getMonth()+1)).slice(-2)}-${("0"+e.getDate()).slice(-2)}`,xa=m.default.create({background:{flex:1},overlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.5)"}),fullScreenContainer:{flex:1,paddingBottom:15,backgroundColor:"transparent"},container:{flex:1,paddingHorizontal:10,marginTop:50},header:{flexDirection:"row",alignItems:"center",padding:10},backButton:{marginRight:10},title:{fontSize:20,fontWeight:"bold"},bigCalendarContainer:{flex:1},selectedDatesScroll:{maxHeight:100},selectedDatesInnerContainer:{flexDirection:"row",flexWrap:"wrap",justifyContent:"center"},selectedDateText:{fontSize:14},saveButton:{backgroundColor:"#47AD4D",borderRadius:5,paddingVertical:10,paddingHorizontal:20,alignSelf:"center",marginTop:10},saveButtonText:{color:"#fff",fontSize:16},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.4)",justifyContent:"center",alignItems:"center"},modalContent:{borderRadius:8,padding:20,width:"80%",elevation:5},modalTitle:{fontSize:20,fontWeight:"bold",marginBottom:15,textAlign:"center"},detailRow:{flexDirection:"row",alignItems:"center",marginVertical:5},detailText:{fontSize:16,marginLeft:8},modalActionButton:{backgroundColor:"#47AD4D",marginTop:20,borderRadius:5},modalActionButtonLabel:{color:"#fff",fontSize:16},selectedEventContainer:{backgroundColor:"#47AD4D",borderRadius:4,marginTop:5,marginLeft:1,width:45,height:45,justifyContent:"center",alignItems:"center"},menuEventContainer:{backgroundColor:"#abedde",borderRadius:4,marginTop:5,marginLeft:1,width:45,height:45,justifyContent:"center",alignItems:"center"},webEventContainer:{width:"90%",height:"90%",alignSelf:"center"},eventText:Object.assign({},{fontSize:20},{margin:0})}),ya=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o}=t.params,[i,d]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[C,v]=(0,r.useState)([]),[w,S]=(0,r.useState)(!1),[k,F]=(0,r.useState)(!1),[B,P]=(0,r.useState)(null),[z,R]=(0,r.useState)(null),[E,V]=(0,r.useState)("light"),[_,W]=(0,r.useState)(!1),[H,$]=(0,r.useState)(!1),L=`${c.baseUrl}/calendarioFiles/almocos/found_lunch.php`,U=`${c.baseUrl}/calendarioFiles/almocos/found_menu.php`,G=`${c.baseUrl}/calendarioFiles/almocos/update_lunch.php`;(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),R(e),V("dark"===t?"dark":"light")}catch{}finally{W(!1)}}()}),[]);const J=(0,r.useCallback)((()=>{fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})}).then((e=>e.json())).then((e=>{if(e.success){const t=e.data.map((e=>{const t=new Date(e.dia+"T00:00:00"),a=ha(t);return{id:pa(a),title:e.turma||"",start:a,end:a,fromDB:!0}}));p(t)}else O.default.alert("Erro",e.message)})).catch}),[o]),Y=(0,r.useCallback)((()=>{fetch(U).then((e=>e.json())).then((e=>{if(e.success){const t=e.data.map((e=>({dia:e.dia,sopa:e.sopa,prato_principal:e.prato_principal,sobremesa:e.sobremesa})));v(t)}})).catch}),[]);if(_){const e="dark"===E?"white":"black";return(0,I.jsxs)(h.default,{source:z?{uri:z}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===E&&(0,I.jsx)(n.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1}}),(0,I.jsxs)(n.default,{style:{alignItems:"center"},children:[(0,I.jsx)(l.default,{size:"large",color:e}),(0,I.jsx)(u.default,{style:{fontSize:18,marginTop:10,color:e},children:"Carregando registros..."})]})]})}const Z=(0,r.useCallback)((()=>{S(!0),d([]),j([]),P(null),F(!1),Promise.all([J(),Y()]).then((()=>S(!1))).catch((e=>{S(!1)}))}),[J,Y]);(0,r.useEffect)((()=>{J()}),[J]),(0,r.useEffect)((()=>{Y()}),[Y]);const Q=e=>{const t=pa(e);return C.find((e=>e.dia===t))},K=e=>{const t=ha(e),a=pa(t),o=ha(new Date),r=ha(new Date((new Date).setMonth((new Date).getMonth()+1)));if(t<o||t>r)return void window.alert("Data inv\xe1lida: S\xf3 \xe9 poss\xedvel selecionar entre hoje e um m\xeas depois.");if(0===t.getDay()||6===t.getDay())return void window.alert("Data inv\xe1lida: N\xe3o \xe9 poss\xedvel selecionar fins de semana.");const l=Q(t);if(l)return P(l),void F(!0);const n=m.some((e=>pa(e.start)===a))&&!x.some((e=>pa(e)===a)),s=i.some((e=>pa(e)===a)),c=x.some((e=>pa(e)===a));n||s?(n&&j((e=>[...e,t])),s&&d((e=>e.filter((e=>pa(e)!==a))))):c?j((e=>e.filter((e=>pa(e)!==a)))):d((e=>[...e,t]))},X=m.filter((e=>!x.some((t=>pa(t)===pa(e.start))))),ee=i.map((e=>({id:pa(e),title:"",start:e,end:e,isManual:!0}))),te=new Set([...X.map((e=>pa(e.start))),...ee.map((e=>pa(e.start)))]),ae=C.filter((e=>!te.has(e.dia))).map((e=>({id:e.dia,title:"",start:new Date(e.dia+"T00:00:00"),end:new Date(e.dia+"T00:00:00"),hasMenu:!0}))),oe=[...X,...ee,...ae],re=.6*M.default.get("window").width,le=Array.from(new Set([...X.map((e=>pa(e.start))),...i.map((e=>pa(e)))])).sort(),ne="dark"===E?"#FFF":"#000",se={backgroundColor:"dark"===E?"#222":"#e0e0e0",borderColor:"dark"===E?"#444":"transparent",borderWidth:"dark"===E?1:0,borderRadius:8,paddingVertical:8,paddingHorizontal:12,margin:4},ie={backgroundColor:"dark"===E?"#000":"#FFF",borderRadius:8,padding:10,marginTop:15,marginHorizontal:-5,marginBottom:15};return(0,I.jsx)(h.default,{source:z?{uri:z}:a(8922),style:xa.background,resizeMode:"cover",children:(0,I.jsxs)(n.default,{style:xa.fullScreenContainer,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>{window.confirm("Tem a certeza que deseja sair?")&&e.navigate("Professor",{email:o})},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===E?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>$(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===E?"#FFFFFF":"#000"}})})]}),(0,I.jsxs)(f.default,{style:xa.container,refreshControl:(0,I.jsx)(N.default,{refreshing:w,onRefresh:Z}),children:[(0,I.jsx)(n.default,{style:ie,children:(0,I.jsx)(q.Calendar,{events:oe,height:re,mode:"month",swipeEnabled:!0,weekStartsOn:1,showTime:!1,onPressCell:e=>K(e),renderEvent:e=>{const t=pa(e.start),a=(e.isManual||e.fromDB)&&!x.some((e=>pa(e)===t)),o=e.hasMenu||!!Q(e.start),r=xa.webEventContainer;return(0,I.jsx)(b.default,{onPress:()=>K(e.start),children:a?(0,I.jsx)(n.default,{style:[xa.selectedEventContainer,r],children:(0,I.jsx)(u.default,{style:[xa.eventText,{color:"dark"===E?"#FFF":"#000"}],children:"\u2713"})}):o?(0,I.jsx)(n.default,{style:[xa.menuEventContainer,r],children:(0,I.jsx)(u.default,{style:[xa.eventText,{color:"dark"===E?"#FFF":"#000"}],children:"\ud83c\udf74"})}):null})},calendarContainerStyle:xa.bigCalendarContainer})}),le.length>0&&(0,I.jsx)(f.default,{style:xa.selectedDatesScroll,children:(0,I.jsx)(n.default,{style:xa.selectedDatesInnerContainer,children:le.map(((e,t)=>(0,I.jsx)(n.default,{style:se,children:(0,I.jsx)(u.default,{style:[xa.selectedDateText,{color:ne}],children:e})},t)))})}),(0,I.jsx)(b.default,{style:xa.saveButton,onPress:()=>{{if(!window.confirm("Tem a certeza que deseja guardar as altera\xe7\xf5es?"))return;if(0===i.length&&0===x.length)return void window.alert("Aten\xe7\xe3o: Nenhuma altera\xe7\xe3o foi realizada.");const e=i.map((e=>pa(e))),t=x.map((e=>pa(e))),a={email:o,diasParaAdicionar:e,diasParaRemover:t};fetch(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((e=>e.json())).then((e=>{e.success?(j([]),Z(),window.alert("Sucesso: Altera\xe7\xf5es guardadas com sucesso!")):window.alert("Erro: "+(e.message||"N\xe3o foi poss\xedvel guardar as altera\xe7\xf5es."))})).catch((e=>{window.alert("N\xe3o foi poss\xedvel guardar as altera\xe7\xf5es. Pedimos que tente novamente mais tarde.")}))}},children:(0,I.jsx)(u.default,{style:xa.saveButtonText,children:"Guardar"})})]}),(0,I.jsx)(D.default,{visible:k,transparent:!0,animationType:"slide",onRequestClose:()=>{F(!1),P(null)},children:(0,I.jsx)(y.default,{onPress:()=>{F(!1),P(null)},children:(0,I.jsx)(n.default,{style:xa.modalOverlay,children:(0,I.jsx)(y.default,{children:(0,I.jsx)(n.default,{style:[xa.modalContent,{backgroundColor:"dark"===E?"#333":"#fff"}],children:B&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(u.default,{style:[xa.modalTitle,{color:ne}],children:"Detalhes do Almo\xe7o"}),(0,I.jsxs)(n.default,{style:xa.detailRow,children:[!1,(0,I.jsxs)(u.default,{style:[xa.detailText,{color:ne}],children:["Sopa: ",B.sopa]})]}),(0,I.jsxs)(n.default,{style:xa.detailRow,children:[!1,(0,I.jsxs)(u.default,{style:[xa.detailText,{color:ne}],children:["Prato Principal: ",B.prato_principal]})]}),(0,I.jsxs)(n.default,{style:xa.detailRow,children:[!1,(0,I.jsxs)(u.default,{style:[xa.detailText,{color:ne}],children:["Sobremesa: ",B.sobremesa]})]}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{if(!B)return;const e=new Date(B.dia+"T00:00:00"),t=pa(e),a=m.some((e=>pa(e.start)===t))&&!x.some((e=>pa(e)===t)),o=i.some((e=>pa(e)===t)),r=x.some((e=>pa(e)===t));a||o?(a&&j((t=>[...t,e])),o&&d((e=>e.filter((e=>pa(e)!==t))))):r?j((e=>e.filter((e=>pa(e)!==t)))):d((t=>[...t,e])),F(!1),P(null)},style:xa.modalActionButton,labelStyle:xa.modalActionButtonLabel,children:m.some((e=>pa(e.start)===B.dia))&&!x.some((e=>pa(e)===B.dia))||i.some((e=>pa(e)===B.dia))?"Desmarcar":"Marcar"})]})})})})})}),(0,I.jsx)(A,{visible:H,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>$(!1),navigation:e,email:o})]})})};var ba=a(5290);const ja=.25*M.default.get("window").height,Ca=m.default.create({container:{flex:1,backgroundColor:"#f7f7f7",paddingHorizontal:16,paddingVertical:8,marginTop:80},centerContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f7f7f7",padding:16},errorText:{fontSize:18,color:"red",textAlign:"center"},listContent:{paddingHorizontal:16,paddingTop:8},row:{justifyContent:"space-between",marginBottom:8},itemBox:{alignItems:"center",marginVertical:8},smallerCard:{width:"100%",height:"100%",borderRadius:8,elevation:2,backgroundColor:"#fff"},cardContent:{flex:1,justifyContent:"center",alignItems:"center"},itemTitle:{fontSize:16,fontWeight:"bold",textAlign:"center",marginBottom:4,color:"#47AD4D"},infoText:{fontSize:14,textAlign:"center",color:"#333"}}),va=({route:e,navigation:t})=>{const[o]=(0,r.useState)(e?.params?.email||""),[s,i]=(0,r.useState)(null),[d,u]=(0,r.useState)([]),[f,m]=(0,r.useState)(!0),[h,p]=(0,r.useState)(!1),[x,y]=(0,r.useState)(null),[j,C]=(0,r.useState)(!1),v=`${c.baseUrl}/alunoFiles/fetchDisciplinasAluno.php`,w=(0,r.useCallback)((async()=>{try{const e=await B.default.post(v,{email:o});e.data.success?(i(e.data.aluno),u(e.data.disciplinas_professores),y(null)):y(e.data.message||"Erro ao buscar dados do aluno")}catch(e){y("Erro na conex\xe3o com a base de dados (aluno)")}finally{m(!1),p(!1)}}),[o,v]);(0,r.useEffect)((()=>{w()}),[w]);const S=()=>{p(!0),w()};return f?(0,I.jsx)(_.default,{style:Ca.centerContainer,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):x?(0,I.jsx)(_.default,{style:Ca.centerContainer,children:(0,I.jsx)(W.default,{style:Ca.errorText,children:x})}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>C(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"#000"}})})]}),(0,I.jsx)(_.default,{style:Ca.container,children:d.length>0?(0,I.jsx)(V.default,{data:d,keyExtractor:e=>e.disciplina_id.toString(),numColumns:2,contentContainerStyle:Ca.listContent,columnWrapperStyle:Ca.row,refreshControl:(0,I.jsx)(N.default,{refreshing:h,onRefresh:S,tintColor:"#47AD4D"}),renderItem:({item:e})=>(0,I.jsx)(b.default,{style:[Ca.itemBox,Object.assign({width:"42%"},{height:ja})],onPress:()=>t.navigate("NotasDisciplina",{email:s.email,emailprof:e.professor_email,disciplina_id:e.disciplina_id,disciplina_nome:e.disciplina_nome}),accessibilityRole:"button",accessibilityLabel:`Abrir ${e.disciplina_nome}`,children:(0,I.jsx)(Qt.default,{style:[Ca.smallerCard,!1],children:(0,I.jsxs)(Qt.default.Content,{style:Ca.cardContent,children:[(0,I.jsx)(ba.default,{style:Ca.itemTitle,children:e.disciplina_nome}),(0,I.jsx)(W.default,{style:Ca.infoText,children:e.professor_email})]})})})}):(0,I.jsxs)(n.default,{style:Ca.centerContainer,children:[(0,I.jsx)(W.default,{style:Ca.infoText,children:"Nenhuma disciplina dispon\xedvel."}),(0,I.jsx)(b.default,{onPress:S,style:{marginTop:16},children:(0,I.jsx)(W.default,{style:{color:"#47AD4D",fontWeight:"bold"},children:"Tentar novamente"})})]})}),(0,I.jsx)(A,{visible:j,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>C(!1),navigation:t,email:o})]})},wa=m.default.create({container:{flex:1,backgroundColor:"#f7f7f7",paddingHorizontal:16,paddingVertical:8,marginTop:30},centerContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f7f7f7",padding:16},appBar:{backgroundColor:"#47AD4D"},sectionTitle:{fontSize:20,marginTop:12,marginBottom:8,color:"black",textAlign:"center"},infoText:{fontSize:14,color:"#333",marginTop:4},errorText:{fontSize:16,color:"red",textAlign:"center",marginBottom:8},card:{marginVertical:6,borderRadius:8,elevation:3,backgroundColor:"#ffffff"},itemTitle:{fontSize:16,fontWeight:"bold",color:"#47AD4D"},highlightCard:{backgroundColor:"#e0f7fa"},normalCard:{backgroundColor:"#ffffff"}}),Sa=({route:e,navigation:t})=>{const{email:o,disciplina_id:s,disciplina_nome:i,emailprof:d}=e.params,[u,m]=(0,r.useState)([]),[h,p]=(0,r.useState)([]),[x,y]=(0,r.useState)([]),[C,v]=(0,r.useState)(!0),[w,S]=(0,r.useState)(!0),[T,k]=(0,r.useState)(!0),[F,D]=(0,r.useState)(!1),[P,A]=(0,r.useState)(null),[z,R]=(0,r.useState)(null),[E,O]=(0,r.useState)(null),[V,H]=(0,r.useState)(!1),$=`${c.baseUrl}/alunoFiles/fetchNotas.php`,L=`${c.baseUrl}/alunoFiles/fetchEventos.php`,M=`${c.baseUrl}/alunoFiles/fetchTasks.php`,U=((0,j.useTheme)(),(0,r.useCallback)((async()=>{try{console.log("DEBUG: Buscando notas para email:",o,"disciplina_id:",s);const e=await B.default.post($,{email:o,disciplina_id:s});console.log("DEBUG: Resposta do fetchNotas:",e.data),e.data.notas?(m(e.data.notas),A(null)):A(e.data.error||"Nenhuma nota encontrada")}catch(e){console.error("DEBUG: Erro ao buscar notas:",e),A("Erro na conex\xe3o com a base de dados (notas)")}finally{v(!1)}}),[o,s,$])),q=(0,r.useCallback)((async()=>{try{console.log("DEBUG: Buscando eventos para email:",o,"disciplina_id:",s);const e=await B.default.post(L,{email:o,disciplina_id:s});console.log("DEBUG: Resposta do fetchEventos:",e.data),Array.isArray(e.data)&&(p(e.data),R(null))}catch(e){console.error("DEBUG: Erro ao buscar eventos:",e),R("Erro na conex\xe3o com o servidor (eventos)")}finally{S(!1)}}),[o,s,L]),G=(0,r.useCallback)((async()=>{try{console.log("DEBUG: Buscando tarefas para email (professor):",d,"disciplina_id:",s);const e=await B.default.post(M,{email:d,disciplina_id:s});console.log("DEBUG: Resposta do fetchTarefas:",e.data),e.data.success&&Array.isArray(e.data.tasks)?(y(e.data.tasks),O(null)):O(e.data.error||"Nenhuma tarefa encontrada")}catch(e){console.error("DEBUG: Erro ao buscar tarefas:",e),O("Erro na conex\xe3o com o servidor (tarefas)")}finally{k(!1)}}),[d,s,M]);(0,r.useEffect)((()=>{U(),q(),G()}),[U,q,G]);return C||w||T?(0,I.jsx)(_.default,{style:wa.centerContainer,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>H(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"#000"}})})]}),(0,I.jsxs)(f.default,{style:wa.container,refreshControl:(0,I.jsx)(N.default,{refreshing:F,onRefresh:()=>{console.log("DEBUG: Refresh acionado."),D(!0),v(!0),S(!0),k(!0),Promise.all([U(),q(),G()]).finally((()=>D(!1)))}}),children:[(0,I.jsx)(ba.default,{style:wa.sectionTitle,children:"Notas"}),P?(0,I.jsx)(W.default,{style:wa.errorText,children:P}):u.length>0?u.map(((e,t)=>(0,I.jsx)(Qt.default,{style:wa.card,children:(0,I.jsxs)(Qt.default.Content,{children:[(0,I.jsxs)(ba.default,{style:wa.itemTitle,children:["Nota: ",e.nota]}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Professor: ",e.professor_email]}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Data: ",e.data_lancamento]}),e.comentario_privado&&(0,I.jsxs)(W.default,{style:wa.infoText,children:["Coment\xe1rio: ",e.comentario_privado]})]})},e.nota_id?e.nota_id.toString():t.toString()))):(0,I.jsx)(W.default,{style:wa.infoText,children:"Nenhuma nota encontrada."}),(0,I.jsx)(ba.default,{style:wa.sectionTitle,children:"Eventos da Disciplina"}),z?(0,I.jsx)(W.default,{style:wa.errorText,children:z}):h.length>0?h.map((e=>(0,I.jsx)(Qt.default,{style:[wa.card,e.professor_email===d?wa.highlightCard:wa.normalCard],children:(0,I.jsxs)(Qt.default.Content,{children:[(0,I.jsx)(ba.default,{style:wa.itemTitle,children:e.title}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["In\xedcio: ",e.start_datetime]}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Fim: ",e.end_datetime]})]})},e.id.toString()))):(0,I.jsx)(W.default,{style:wa.infoText,children:"Nenhum evento encontrado para esta disciplina."}),(0,I.jsx)(ba.default,{style:wa.sectionTitle,children:"Tarefas Publicadas"}),E?(0,I.jsx)(W.default,{style:wa.errorText,children:E}):x.length>0?x.map((e=>(0,I.jsx)(Qt.default,{style:wa.card,children:(0,I.jsxs)(Qt.default.Content,{children:[(0,I.jsx)(ba.default,{style:wa.itemTitle,children:e.titulo}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Descri\xe7\xe3o: ",e.descricao]}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Data de Cria\xe7\xe3o: ",e.dataDeCriacao]}),(0,I.jsxs)(W.default,{style:wa.infoText,children:["Data da Tarefa: ",e.data_da_tarefa]})]})},e.tarefa_id?e.tarefa_id.toString():e.id.toString()))):(0,I.jsx)(W.default,{style:wa.infoText,children:"Nenhuma tarefa encontrada para esta disciplina."})]})]})};var Ta=a(9872);function ka({navigation:e}){const[t,a]=(0,r.useState)(null),[o,s]=(0,r.useState)(!0),[i,d]=(0,r.useState)(null),[m,g]=(0,r.useState)(null),h=(e,t)=>{window.alert(`${e}\n\n${t}`)};(0,r.useEffect)((()=>{fetch(`${c.baseUrl}/auxiliarFiles/fetchEstatisticasAlmoco.php`).then((async e=>{const t=await e.text();console.log("Texto recebido:",t);try{const e=JSON.parse(t);e.success?a(e):h("Erro","N\xe3o foi poss\xedvel carregar as estat\xedsticas. Pedimos que tente novamente mais tarde.")}catch(o){}})).catch((e=>{h("Erro","Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Pedimos que tente novamente mais tarde.")})).finally((()=>s(!1)))}),[]);if(o)return(0,I.jsx)(n.default,{style:Fa.loadingContainer,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})});return(0,I.jsxs)(f.default,{contentContainerStyle:Fa.container,children:[!i&&(0,I.jsxs)(n.default,{style:Fa.mainContainer,children:[(0,I.jsxs)(n.default,{style:Fa.menuVertical,children:[(0,I.jsx)(b.default,{style:Fa.menuButton,onPress:()=>d("alunos"),children:(0,I.jsx)(u.default,{style:Fa.menuButtonText,children:"Alunos"})}),(0,I.jsx)(b.default,{style:Fa.menuButton,onPress:()=>d("professores"),children:(0,I.jsx)(u.default,{style:Fa.menuButtonText,children:"Professores"})}),(0,I.jsx)(b.default,{style:Fa.menuButton,onPress:()=>d("administradores"),children:(0,I.jsx)(u.default,{style:Fa.menuButtonText,children:"Administradores"})})]}),(0,I.jsxs)(n.default,{style:Fa.headlineContainer,children:[(0,I.jsx)(u.default,{style:Fa.headline,children:t?.headline}),(0,I.jsxs)(u.default,{style:Fa.infoText,children:["Alunos: ",t?.alunosCount]}),(0,I.jsxs)(u.default,{style:Fa.infoText,children:["Professores: ",t?.professoresCount]}),(0,I.jsxs)(u.default,{style:Fa.infoText,children:["Administradores: ",t?.administradoresCount]}),(0,I.jsxs)(u.default,{style:Fa.totalText,children:["\ud83d\udccb Total: ",t?.total]})]})]}),i&&(()=>{if(!t)return null;if("alunos"===i&&null===m){const e=(()=>{const e={};return t?.alunos.forEach((t=>{if(t.turma){const a=`${t.turma.ano} - ${t.turma.turma}`;e[a]||(e[a]=[]),e[a].push(t)}})),e})();return(0,I.jsxs)(n.default,{style:Fa.detailContainer,children:[(0,I.jsx)(u.default,{style:Fa.detailTitle,children:"Turmas com alunos que almo\xe7am"}),Object.keys(e).map(((t,a)=>{const o=e[t],r=()=>g({tipo:"turma",turma:t,alunos:o});return(0,I.jsxs)(b.default,{style:Fa.turmaItem,onPress:r,children:[(0,I.jsx)(b.default,{style:Fa.greenSquare,onPress:r,activeOpacity:.7,children:(0,I.jsx)(Ta.default,{source:"check-circle",size:24})}),(0,I.jsx)(u.default,{style:Fa.turmaText,children:t}),(0,I.jsxs)(u.default,{style:Fa.turmaText,children:["(",o.length,")"]})]},a)})),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>{d(null),g(null)},style:Fa.voltarBotao,labelStyle:Fa.voltarBotaoText,children:"Voltar"})]})}if("alunos"===i&&m&&"turma"===m.tipo)return(0,I.jsxs)(n.default,{style:Fa.detailContainer,children:[(0,I.jsxs)(u.default,{style:Fa.detailTitle,children:["Alunos de ",m.turma]}),m.alunos.map(((e,t)=>(0,I.jsxs)(n.default,{style:Fa.detailItem,children:[(0,I.jsxs)(u.default,{style:Fa.detailItemText,children:["Email: ",e.email]}),(0,I.jsxs)(u.default,{style:Fa.detailItemText,children:["Dias: ",e.dias.join(", ")]})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>g(null),style:Fa.voltarBotao,labelStyle:Fa.voltarBotaoText,children:"Voltar"})]});if("professores"===i||"administradores"===i){const e="professores"===i?t.professores:t.administradores;return(0,I.jsxs)(n.default,{style:Fa.detailContainer,children:[(0,I.jsxs)(u.default,{style:Fa.detailTitle,children:["professores"===i?"Professores":"Administradores"," que almo\xe7am"]}),e.map(((e,t)=>(0,I.jsxs)(n.default,{style:Fa.detailItem,children:[(0,I.jsxs)(u.default,{style:Fa.detailItemText,children:["Email: ",e.email]}),(0,I.jsxs)(u.default,{style:Fa.detailItemText,children:["Dias: ",e.dias.join(", ")]})]},t))),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>d(null),style:Fa.voltarBotao,labelStyle:Fa.voltarBotaoText,children:"Voltar"})]})}return null})(),!i&&(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>e.goBack(),style:Fa.voltarBotao,labelStyle:Fa.voltarBotaoText,children:"Voltar"})]})}const Fa=m.default.create({container:{flex:1,padding:15,backgroundColor:"#fff"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"},mainContainer:{flex:1,flexDirection:"row",alignItems:"stretch",justifyContent:"space-between",paddingVertical:20},menuVertical:{flex:1,marginRight:30,justifyContent:"center"},menuButton:{backgroundColor:"#47AD4D",paddingVertical:18,paddingHorizontal:10,marginBottom:12,borderRadius:10,alignItems:"center",shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:2,elevation:2},menuButtonText:{color:"#fff",fontSize:18,fontWeight:"bold"},headlineContainer:{flex:1,justifyContent:"space-evenly",padding:20,backgroundColor:"#F9F9F9",borderRadius:10,elevation:2,minHeight:300},headline:{fontSize:24,fontWeight:"bold",marginBottom:20,borderBottomWidth:1,borderColor:"#ccc",paddingBottom:10,textAlign:"center"},infoText:{fontSize:20,marginVertical:6,textAlign:"center"},totalText:{fontSize:22,fontWeight:"bold",marginTop:16,textAlign:"center",color:"#2E7D32"},detailContainer:{marginTop:20,alignItems:"center",paddingHorizontal:10},detailTitle:{fontSize:22,fontWeight:"bold",marginBottom:20,textAlign:"center"},detailItem:{backgroundColor:"#F1F8E9",padding:12,borderRadius:8,marginVertical:6,width:"95%",elevation:1},detailItemText:{fontSize:16},turmaItem:{backgroundColor:"#E8F5E9",borderRadius:12,paddingVertical:18,paddingHorizontal:20,marginVertical:8,width:"95%",flexDirection:"row",justifyContent:"space-between",alignItems:"center",elevation:3},turmaText:{fontSize:18,fontWeight:"bold",color:"#2E7D32"},voltarBotao:{marginTop:25,alignSelf:"center",width:"60%"},voltarBotaoText:{color:"#47AD4D"},greenSquare:{width:30,height:30,backgroundColor:"#47AD4D",borderRadius:4,justifyContent:"center",alignItems:"center"}}),Da=m.default.create({bgImage:{flex:1},darkOverlay:Object.assign({},m.default.absoluteFillObject,{backgroundColor:"rgba(0,0,0,0.4)"}),header:{width:"100%",flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:12,paddingHorizontal:16,marginTop:0},headerTitle:{color:"#fff",fontSize:20,fontWeight:"bold"},headerIcon:{width:28,height:28,tintColor:"#000"},listContainer:{flex:1,paddingHorizontal:16,paddingBottom:16,marginTop:90},card:{marginVertical:8,borderRadius:10,elevation:4},cardContent:{flexDirection:"row",alignItems:"center",padding:12},infoBox:{flex:1,marginRight:12},emailText:{fontSize:16,fontWeight:"500"},actionsBox:{flexDirection:"row"},iconAction:{width:24,height:24,marginHorizontal:8},toast:{position:"absolute",top:50,alignSelf:"center",paddingHorizontal:20,paddingVertical:10,borderRadius:8,zIndex:20},toastText:{color:"#fff",fontSize:14},toastSuccess:{backgroundColor:"#47AD4D"},toastError:{backgroundColor:"#D32F2F"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center"},emptyText:{fontSize:16}}),Ba=({navigation:e,route:t})=>{const o=(0,j.useTheme)(),[s,i]=(0,r.useState)(!0),[d,f]=(0,r.useState)(null),[m,x]=(0,r.useState)(o.dark?"dark":"light"),[y,C]=(0,r.useState)([]),[v,w]=(0,r.useState)(!1),[S,T]=(0,r.useState)({visible:!1,message:"",type:""}),k=(0,r.useCallback)(((e,t)=>{T({visible:!0,message:e,type:t}),setTimeout((()=>T({visible:!1,message:"",type:""})),2e3)}),[]);(0,r.useEffect)((()=>{(async()=>{try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),f(e),x("dark"===t?"dark":"light")}catch(e){console.error("Erro carregando configura\xe7\xf5es",e)}})()}),[]);const F=(0,r.useCallback)((async()=>{i(!0);try{const e=await fetch(`${c.baseUrl}/adminFiles/aboutStudents/fetchAlunosPendentes.php`),t=await e.json();t.success?C(t.alunos):k(t.message||"Erro ao carregar alunos","error")}catch(e){console.error("fetchPendentes",e),k("Falha ao procurar os alunos","error")}i(!1)}),[k]);(0,r.useEffect)((()=>{F()}),[F]);const D="dark"===m?"#1e1e1e":"#fff",B="dark"===m?"#fff":"#000";return(0,I.jsxs)(h.default,{source:d?{uri:d}:a(8922),style:Da.bgImage,resizeMode:"cover",children:["dark"===m&&(0,I.jsx)(n.default,{style:Da.darkOverlay}),(0,I.jsx)(p.default,{translucent:!0,backgroundColor:"transparent",barStyle:"dark"===m?"light-content":"dark-content"}),S.visible&&(0,I.jsx)(n.default,{style:[Da.toast,"success"===S.type?Da.toastSuccess:Da.toastError],children:(0,I.jsx)(u.default,{style:Da.toastText,children:S.message})}),(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>e.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===m?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>w(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===m?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(_.default,{style:Da.listContainer,children:s?(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"}):(0,I.jsx)(V.default,{data:y,keyExtractor:e=>e.id.toString(),renderItem:({item:e})=>(0,I.jsx)(Qt.default,{style:[Da.card,{backgroundColor:D}],children:(0,I.jsxs)(n.default,{style:Da.cardContent,children:[(0,I.jsx)(n.default,{style:Da.infoBox,children:(0,I.jsx)(u.default,{style:[Da.emailText,{color:B}],numberOfLines:1,children:e.email})}),(0,I.jsxs)(n.default,{style:Da.actionsBox,children:[(0,I.jsx)(b.default,{onPress:()=>(async e=>{try{const t=await fetch(`${c.baseUrl}/adminFiles/aboutStudents/confirmAluno.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),a=await t.json();a.success?(k("Aluno confirmado","success"),F()):k(a.message,"error")}catch(t){console.error("confirmAluno",t),k("Erro ao confirmar aluno","error")}})(e.id),children:(0,I.jsx)(g.default,{source:a(8320),style:Da.iconAction})}),(0,I.jsx)(b.default,{onPress:()=>(async e=>{try{const t=await fetch(`${c.baseUrl}/adminFiles/aboutStudents/deleteAluno.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})}),a=await t.json();a.success?(k("Aluno removido","success"),F()):k(a.message,"error")}catch(t){console.error("deleteAluno",t),k("Erro ao remover aluno","error")}})(e.id),children:(0,I.jsx)(g.default,{source:a(5132),style:Da.iconAction})})]})]})}),contentContainerStyle:0===y.length&&Da.emptyContainer,ListEmptyComponent:(0,I.jsx)(u.default,{style:[Da.emptyText,{color:B}],children:"Nenhum aluno pendente."})})}),(0,I.jsx)(A,{visible:v,dynamicHeaderBackground:D,dynamicTextColor:B,onClose:()=>w(!1),navigation:e,email:t.params.email})]})};function Ia(e){O.default.alert("",e)}const Pa=m.default.create({bg:{flex:1,justifyContent:"center",alignItems:"center"},container:{flex:1,width:"100%",padding:16,justifyContent:"center",alignItems:"center"},box:{width:"90%",maxWidth:400,backgroundColor:"#fff",borderRadius:12,padding:24,elevation:3,shadowColor:"#000",shadowOpacity:.2,shadowRadius:5,shadowOffset:{width:0,height:2}},title:{textAlign:"center",marginBottom:16,fontWeight:"bold",color:"#333"},list:{maxHeight:200,marginBottom:20},item:{flexDirection:"row",alignItems:"center",marginBottom:8},itemText:{fontSize:16,color:"#333"},button:{width:"100%",marginTop:8,backgroundColor:"#47AD4D"},buttonLabel:{color:"#fff"},errorText:{color:"#B00020",marginBottom:8},toastContainer:{position:"absolute",top:16,left:16,right:16,alignItems:"center",zIndex:10},toastBox:{backgroundColor:"#47AD4D",borderRadius:24,paddingVertical:12,paddingHorizontal:24,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.3,shadowRadius:4},toastText:{color:"#FFF",fontSize:14,textAlign:"center"}}),Aa=()=>{const e=(0,s.useNavigation)(),t=(0,s.useRoute)(),{email:o,initialMessage:i=""}=t.params,d=`${c.baseUrl}/signInFiles/fetchTurmas.php`,m=`${c.baseUrl}/signInFiles/saveSelectedTurma.php`,[g,x]=(0,r.useState)(!1),[y,b]=(0,r.useState)(""),[j,v]=(0,r.useState)(i),[w,S]=(0,r.useState)([]),[k,F]=(0,r.useState)(null);(0,r.useEffect)((()=>{i&&(v(i),setTimeout((()=>v("")),2e3))}),[i]),(0,r.useEffect)((()=>{let e=!0;return(async()=>{try{x(!0);const t=await fetch(d),a=await t.text(),o=JSON.parse(a);o.success?e&&S(o.turmas):Ia(o.message)}catch{Ia("Ocorreu um erro de conex\xe3o. Tente novamente mais tarde.")}finally{e&&x(!1)}})(),()=>{e=!1}}),[]);return g?(0,I.jsx)(h.default,{source:a(8922),style:Pa.bg,children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})}):(0,I.jsxs)(h.default,{source:a(8922),style:Pa.bg,children:[(0,I.jsx)(p.default,{barStyle:"dark-content",backgroundColor:"transparent",translucent:!0}),(0,I.jsxs)(ne.default,{behavior:"padding",style:Pa.container,children:[""!==j&&(0,I.jsx)(n.default,{style:Pa.toastContainer,children:(0,I.jsx)(n.default,{style:Pa.toastBox,children:(0,I.jsx)(u.default,{style:Pa.toastText,children:j})})}),(0,I.jsxs)(n.default,{style:Pa.box,children:[(0,I.jsx)(u.default,{style:Pa.title,children:"Selecione sua Turma (10\xba Ano)"}),y?(0,I.jsx)(se.default,{type:"error",visible:!0,style:Pa.errorText,children:y}):null,(0,I.jsx)(C.default.Group,{onValueChange:e=>F(Number(e)),value:k?.toString(),children:(0,I.jsx)(f.default,{style:Pa.list,children:w.map((e=>(0,I.jsxs)(n.default,{style:Pa.item,children:[(0,I.jsx)(C.default,{value:e.id.toString()}),(0,I.jsxs)(u.default,{style:Pa.itemText,children:["Turma ",e.turma]})]},e.id)))})}),(0,I.jsx)(T.default,{mode:"contained",onPress:async()=>{if(null!==k){b(""),x(!0);try{const t=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,turma_id:k})}),a=await t.text(),r=JSON.parse(a);if(r.success){const t="A sua turma foi selecionada com sucesso! Voc\xea agora vai precisar da aprova\xe7\xe3o de um administrador.";window.alert(t),e.navigate("Login")}else Ia(r.message||"Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Tente novamente mais tarde.")}catch{Ia("Ocorreu um erro enquanto o tentavamos conectar aos nossos servidores. Tente novamente mais tarde.")}finally{x(!1)}}else b("Selecione uma turma antes de avan\xe7ar.")},loading:g,disabled:g,style:Pa.button,labelStyle:Pa.buttonLabel,children:"Confirmar"})]})]})]})};const za=[{value:"#FF6347",name:"Tomate"},{value:"#DC143C",name:"Carmesim"},{value:"#FF4500",name:"Vermelho-Laranja"},{value:"#8A2BE2",name:"Azul-Violeta"},{value:"#5F9EA0",name:"Azul-Cadete"},{value:"#2E8B57",name:"Verde-Mar"},{value:"#FF8C00",name:"Laranja-Escuro"},{value:"#9932CC",name:"Orqu\xeddea-Escura"},{value:"#20B2AA",name:"Verde-Mar-Claro"},{value:"#4682B4",name:"Azul-A\xe7o"}],Ra=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),a=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-a);const o=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-o.getTime())/864e5+1)/7)},Ea=(e,t,a)=>{if(a)return"day";if(e.toDateString()===t.toDateString())return"day";const o=Ra(e),r=Ra(t);if(6===e.getDay()&&1===t.getDay())return"month";if(o===r)return"week";return(t.getTime()-e.getTime())/864e5>7?"month":"week"},Oa=m.default.create({loadingText:{marginTop:16,fontSize:16,color:"#000",textAlign:"center"},background:{flex:1},scrollContainer:{flexGrow:1,padding:5,marginTop:70,paddingBottom:100},formContainer:{flex:1,alignSelf:"stretch"},innerScroll:{flexGrow:1},previewContainer:{flex:1},previewDetails:{marginVertical:15},previewText:{fontSize:16,marginVertical:2,color:"#000"},title:{fontSize:22,fontWeight:"bold",marginBottom:15,textAlign:"center"},input:{marginBottom:15,backgroundColor:"#f5f5f5",color:"#000",borderRadius:8,paddingHorizontal:10},inputGroup:{marginBottom:10},picker:{backgroundColor:"#f5f5f5",color:"#000"},label:{marginBottom:5,fontWeight:"bold"},button:{borderRadius:8},errorText:{color:"red",textAlign:"center",marginBottom:10},successText:{color:"green",textAlign:"center",marginBottom:10},infoText:{color:"red",textAlign:"center",marginBottom:10},loaderContainer:{flex:1,justifyContent:"center",alignItems:"center"},colorModalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},colorModalContainer:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},modalContainer:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20,maxHeight:"80%"},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:15,textAlign:"center"},colorOptionRow:{flexDirection:"row",alignItems:"center",marginBottom:10},colorCircle:{width:30,height:30,borderRadius:15,marginRight:10},colorName:{fontSize:16},modalCloseButton:{backgroundColor:"#47AD4D",marginTop:10},selectedColorDisplay:{flexDirection:"row",alignItems:"center",marginTop:10},colorText:{fontSize:16,color:"#47AD4D"},backButton:{alignSelf:"flex-start"},errorBorder:{borderWidth:1,borderColor:"red",borderRadius:8,marginBottom:10},turmaRow:{flexDirection:"row",alignItems:"center",paddingVertical:5},selectedTurmaRow:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderWidth:1,borderColor:"#ccc",padding:8,borderRadius:8,marginVertical:3},addTurmaButton:{borderRadius:8,marginVertical:10},noTurmaOverlay:{flex:1,backgroundColor:"rgba(255, 255, 255, 0.5)",justifyContent:"center",alignItems:"center"},noTurmaModal:{width:"80%",backgroundColor:"#fff",borderRadius:10,padding:20,alignItems:"center"},noTurmaText:{fontSize:16,textAlign:"center",marginBottom:20},noTurmaButton:{backgroundColor:"#47AD4D"}}),Va=()=>{const e=(0,j.useTheme)(),t=(0,s.useNavigation)(),o=(0,s.useRoute)(),{email:i}=o.params,d=`${c.baseUrl}/calendarioFiles/professor/eventos/add_event.php`,u=`${c.baseUrl}/calendarioFiles/professor/tarefas/add_task.php`,m=`${c.baseUrl}/calendarioFiles/professor/fetchProfessorInfo.php`,[p,x]=(0,r.useState)({title:"",description:""}),[y,C]=(0,r.useState)(""),[v,w]=(0,r.useState)(""),[k,F]=(0,r.useState)(""),P="Tarefa"===k,[z,R]=(0,r.useState)("#DC143C"),[E,O]=(0,r.useState)(!1),[V,_]=(0,r.useState)(new Date),[H,$]=(0,r.useState)(new Date),[L,N]=(0,r.useState)(new Date),[M,U]=(0,r.useState)(new Date),[G,J]=(0,r.useState)(!1),[Y,Z]=(0,r.useState)(!1),[Q,K]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(!1),[oe,re]=(0,r.useState)([]),[le,ne]=(0,r.useState)([]),[se,ie]=(0,r.useState)(!1),[de,ce]=(0,r.useState)(""),[ue,fe]=(0,r.useState)(""),[me,ge]=(0,r.useState)(!1),[he,pe]=(0,r.useState)({}),[xe,ye]=(0,r.useState)(!1),[be,je]=(0,r.useState)(null),[Ce,ve]=(0,r.useState)(e.dark?"dark":"light"),[we,Se]=(0,r.useState)(!1);(0,r.useEffect)((()=>{!async function(){try{let e,t;e=localStorage.getItem("backgroundUrl"),t=localStorage.getItem("userTheme"),e&&!e.startsWith("http")&&(e=`${c.baseUrl}/${e}`),je(e),ve("dark"===t?"dark":"light")}catch(de){console.log("Erro ao carregar configura\xe7\xf5es.",de)}finally{ye(!1)}}()}),[]);const Te=0===oe.length,ke=e=>{ce(e),window.alert(e)},Fe=e=>e.toLocaleDateString("pt-PT"),De=e=>e.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"});(0,r.useEffect)((()=>{B.default.post(m,{email:i}).then((e=>{console.log("Response:",e.data),e.data&&Array.isArray(e.data.turmas)?re(e.data.turmas):re([])})).catch((()=>{re([])}))}),[i]),(0,r.useEffect)((()=>{y?"Trabalho de casa"===y?k||F("Tarefa"):k||F("Evento"):F("")}),[y]);const Be=e=>{le.some((t=>t.turma===e.turma&&t.ano===e.ano))?ne(le.filter((t=>!(t.turma===e.turma&&t.ano===e.ano)))):ne([...le,e])},Ie=()=>{const e={email:i||"",title:p.title,description:p.description.trim()?p.description:"",category:"Outro"===y?v:y,type:k,color:z};if(P?e.data_da_tarefa=`${Fe(V)} ${De(H)}`:(e.start_date=Fe(V),e.start_time=De(H),e.end_date=Fe(L),e.end_time=De(M)),!(le.length>0))return void ke("Pedimos que selecione pelo menos uma turma.");e.turma=le[0].turma,e.ano=le[0].ano;const a=P?u:d;B.default.post(a,e).then((e=>{var a;if(!0===e.data.success){fe(a=P?"Voc\xea conseguiu criar uma nova tarefa com sucesso!":"Voc\xea conseguiu criar um novo evento com sucesso!"),window.alert(a),setTimeout((()=>{t.goBack()}),1e3)}else ke(e.data.message||"Ocorreu um erro ao tentar adicionar um novo evento/tarefa, pedimos que tente novamente mais tarde.")})).catch((()=>{ke("Erro ao adicionar. Tente novamente mais tarde.")}))};let Pe=new Date(V),Ae=new Date(V);if(P){const e=H.getHours(),t=H.getMinutes();Ae.setHours(e,t,0,0),0===e&&t<30?(Pe=new Date(Ae.getTime()),Ae=new Date(Ae.getTime()+18e5)):Pe=new Date(Ae.getTime()-18e5)}const ze=[{title:`${p.title} - ${De(H)}`,start:P?Pe:new Date(V.getFullYear(),V.getMonth(),V.getDate(),H.getHours(),H.getMinutes()),end:P?Ae:new Date(L.getFullYear(),L.getMonth(),L.getDate(),M.getHours(),M.getMinutes()),color:z}],Re="dark"===Ce?"#e0dede":"#000";return xe?(0,I.jsxs)(h.default,{source:be?{uri:be}:a(8922),style:{flex:1,justifyContent:"center",alignItems:"center"},children:["dark"===Ce&&(0,I.jsx)(n.default,{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",zIndex:1}}),(0,I.jsx)(n.default,{style:{alignItems:"center"},children:(0,I.jsx)(l.default,{size:"large",color:"#47AD4D"})})]}):me?(0,I.jsxs)(h.default,{source:be?{uri:be}:a(8922),style:Oa.background,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white",borderBottomWidth:1,borderBottomColor:"#ddd"},children:[(0,I.jsx)(b.default,{onPress:()=>{t.goBack()},style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===Ce?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>Se(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===Ce?"#FFFFFF":"#000"}})})]}),(0,I.jsxs)(f.default,{contentContainerStyle:Oa.scrollContainer,children:[(0,I.jsx)(q.Calendar,{date:V,events:ze,height:500,mode:Ea(V,P?V:L,P),swipeEnabled:!0,showTime:!1,eventCellStyle:e=>e.color?{backgroundColor:e.color}:{}}),(0,I.jsxs)(n.default,{style:Oa.previewDetails,children:[(0,I.jsxs)(W.default,{style:Oa.previewText,children:["T\xedtulo: ",p.title]}),P?(0,I.jsxs)(W.default,{style:Oa.previewText,children:["Data da Tarefa: ",Fe(V)," \xe0s ",De(H)]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(W.default,{style:Oa.previewText,children:["In\xedcio: ",Fe(V)," \xe0s ",De(H)]}),(0,I.jsxs)(W.default,{style:Oa.previewText,children:["Fim: ",Fe(L)," \xe0s ",De(M)]})]}),(0,I.jsxs)(W.default,{style:Oa.previewText,children:["Turmas Selecionadas:"," ",le.map(((e,t)=>(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma,t<le.length-1?", ":""]},t)))]}),(0,I.jsxs)(W.default,{style:Oa.previewText,children:["Categoria: ","Outro"===y?v:y]}),(0,I.jsxs)(W.default,{style:Oa.previewText,children:["Tipo: ",k]}),(0,I.jsxs)(n.default,{style:Oa.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[Oa.colorCircle,{backgroundColor:z}]}),(0,I.jsx)(W.default,{style:Oa.previewText,children:"Cor Selecionada"})]})]}),de?(0,I.jsx)(W.default,{style:Oa.errorText,children:de}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:Ie,style:[Oa.button,{backgroundColor:"#47AD4D"}],children:"Confirmar"}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>ge(!1),style:[Oa.button,{backgroundColor:"red",marginTop:10}],children:"Editar"})]})]}):(0,I.jsxs)(h.default,{source:be?{uri:be}:a(8922),style:Oa.background,children:[(0,I.jsxs)(n.default,{style:{width:"100%",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingTop:40,paddingHorizontal:10,paddingBottom:10,position:"absolute",top:0,zIndex:10,backgroundColor:"white"},children:[(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{flex:1},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:35,height:35,marginLeft:3,marginTop:-15,tintColor:"dark"===Ce?"#FFFFFF":"#000"}})}),(0,I.jsx)(b.default,{onPress:()=>Se(!0),style:{flex:1,alignItems:"flex-end"},children:(0,I.jsx)(g.default,{source:a(9119),style:{width:30,height:30,marginTop:-5,tintColor:"dark"===Ce?"#FFFFFF":"#000"}})})]}),(0,I.jsx)(f.default,{contentContainerStyle:Oa.scrollContainer,children:(0,I.jsxs)(n.default,{style:Oa.formContainer,children:[0===oe.length&&(0,I.jsx)(W.default,{style:Oa.infoText,children:"Nenhuma turma encontrada para si. Por favor, pedimos que tente mais tarde, ou pe\xe7a para ter uma turma."}),(0,I.jsxs)(f.default,{style:Oa.innerScroll,contentContainerStyle:{paddingBottom:100},nestedScrollEnabled:!0,children:[(0,I.jsx)(n.default,{style:[Oa.inputGroup,he.category&&Oa.errorBorder],children:(0,I.jsxs)(te.Picker,{selectedValue:y,onValueChange:e=>{C(e),"Outro"!==e&&w(""),F("")},style:Oa.picker,children:[(0,I.jsx)(te.Picker.Item,{label:"Selecione a categoria",value:""}),(0,I.jsx)(te.Picker.Item,{label:"Teste",value:"Teste"}),(0,I.jsx)(te.Picker.Item,{label:"Trabalho de casa",value:"Trabalho de casa"}),(0,I.jsx)(te.Picker.Item,{label:"Atividade",value:"Atividade"}),(0,I.jsx)(te.Picker.Item,{label:"Visita de estudo",value:"Visita de estudo"}),(0,I.jsx)(te.Picker.Item,{label:"Outro",value:"Outro"})]})}),""!==y&&(0,I.jsxs)(I.Fragment,{children:["Outro"===y&&(0,I.jsx)(n.default,{style:[Oa.inputGroup,he.customCategory&&Oa.errorBorder],children:(0,I.jsx)(S.default,{label:"Categoria personalizada *",value:v,onChangeText:e=>w(e),mode:"outlined",error:!!he.customCategory,style:Oa.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}})}),(0,I.jsx)(n.default,{style:[Oa.inputGroup,he.type&&Oa.errorBorder],children:(0,I.jsxs)(te.Picker,{selectedValue:k,onValueChange:e=>F(e),style:Oa.picker,children:[(0,I.jsx)(te.Picker.Item,{label:"Evento",value:"evento"}),(0,I.jsx)(te.Picker.Item,{label:"Tarefa",value:"Tarefa"})]})}),(0,I.jsx)(n.default,{style:Oa.inputGroup,children:(0,I.jsxs)(b.default,{onPress:()=>O(!0),style:Oa.selectedColorDisplay,children:[(0,I.jsx)(n.default,{style:[Oa.colorCircle,{backgroundColor:z}]}),(0,I.jsx)(W.default,{style:Oa.colorText,children:"Cor Selecionada"})]})}),(0,I.jsx)(S.default,{label:"T\xedtulo *",value:p.title,onChangeText:e=>x(Object.assign({},p,{title:e})),mode:"outlined",error:!!he.title,style:Oa.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),(0,I.jsx)(n.default,{style:Oa.inputGroup,children:(0,I.jsx)(S.default,{label:"Descri\xe7\xe3o",value:p.description,onChangeText:e=>x(Object.assign({},p,{description:e})),mode:"outlined",style:Oa.input,theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}})})]}),(0,I.jsxs)(n.default,{style:Oa.inputGroup,children:[(0,I.jsx)(S.default,{label:P?"Data da Tarefa *":"Data de In\xedcio *",value:Fe(V),mode:"outlined",style:Oa.input,editable:!1,onPressIn:()=>J(!0),right:(0,I.jsx)(S.default.Icon,{onPress:()=>J(!0),icon:()=>(0,I.jsx)(Ct.default,{name:"calendar",size:24,onPress:()=>J(!0)})}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),G&&(0,I.jsx)(ae.default,{value:V,mode:"date",display:"calendar",onChange:(e,t)=>{J(!1),"dismissed"!==e.type&&t&&_(t)}})]}),(0,I.jsxs)(n.default,{style:Oa.inputGroup,children:[(0,I.jsx)(S.default,{label:P?"Hora da Tarefa *":"Hora de In\xedcio *",value:De(H),mode:"outlined",style:Oa.input,editable:!1,onPressIn:()=>Z(!0),right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(Ct.default,{name:"clock",size:24}),onPress:()=>Z(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),Y&&(0,I.jsx)(ae.default,{value:H,mode:"time",display:"clock",is24Hour:!0,onChange:(e,t)=>{Z(!1),"dismissed"!==e.type&&t&&$(t)}})]}),!P&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)(n.default,{style:Oa.inputGroup,children:[(0,I.jsx)(S.default,{label:"Data de Fim *",value:Fe(L),mode:"outlined",style:Oa.input,editable:!1,onPressIn:()=>K(!0),right:(0,I.jsx)(S.default.Icon,{onPress:()=>J(!0),icon:()=>(0,I.jsx)(Ct.default,{name:"calendar",size:24,onPress:()=>K(!0)})}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),Q&&(0,I.jsx)(ae.default,{value:L,mode:"date",display:"calendar",onChange:(e,t)=>{K(!1),"dismissed"!==e.type&&t&&N(t)}})]}),(0,I.jsxs)(n.default,{style:Oa.inputGroup,children:[(0,I.jsx)(S.default,{label:"Hora de Fim *",value:De(M),mode:"outlined",style:Oa.input,editable:!1,onPressIn:()=>ee(!0),right:(0,I.jsx)(S.default.Icon,{icon:()=>(0,I.jsx)(Ct.default,{name:"clock",size:24}),onPress:()=>ee(!0)}),theme:{colors:{text:"#000",primary:"#47AD4D",placeholder:"#000"}}}),X&&(0,I.jsx)(ae.default,{value:M,mode:"time",display:"clock",is24Hour:!0,onChange:(e,t)=>{ee(!1),"dismissed"!==e.type&&t&&U(t)}})]})]}),le.length>0&&(0,I.jsxs)(n.default,{style:Oa.inputGroup,children:[(0,I.jsx)(W.default,{style:Oa.label,children:"Turmas Selecionadas:"}),le.map(((e,t)=>(0,I.jsxs)(n.default,{style:Oa.selectedTurmaRow,children:[(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma]}),(0,I.jsx)(Ye.default,{icon:"close",size:20,onPress:()=>Be(e)})]},t)))]}),(0,I.jsx)(T.default,{mode:"outlined",onPress:()=>ie(!0),style:Oa.addTurmaButton,labelStyle:{color:"#47AD4D"},children:"+ Adicionar turma"}),de?(0,I.jsx)(W.default,{style:Oa.errorText,children:de}):null,ue?(0,I.jsx)(W.default,{style:Oa.successText,children:ue}):null,(0,I.jsx)(T.default,{mode:"contained",onPress:()=>{const e=(()=>{const e={};return P?(y||(e.category=!0),"Outro"!==y||v.trim()||(e.customCategory=!0),p.title.trim()||(e.title=!0),V||(e.startDate=!0),H||(e.startTime=!0)):(p.title.trim()||(e.title=!0),V||(e.startDate=!0),H||(e.startTime=!0),L||(e.endDate=!0),M||(e.endTime=!0),0===le.length&&(e.turmas=!0)),e})();if(Object.keys(e).length>0)return pe(e),void ke("Por favor, preencha todos os campos obrigat\xf3rios.");if(pe({}),!P){const e=new Date(V.getFullYear(),V.getMonth(),V.getDate(),H.getHours(),H.getMinutes()),t=new Date(L.getFullYear(),L.getMonth(),L.getDate(),M.getHours(),M.getMinutes());if(e>t||e.getTime()===t.getTime())return void window.alert("Erro de Data/Hora: A data e hora de in\xedcio n\xe3o pode ser posterior ou igual \xe0 data e hora de fim.");t<e&&(N(V),U(H))}ce("");const t=((e,t,a,o)=>{const r=[],l=e=>({hours:e.getHours(),minutes:e.getMinutes()});if(o){const{hours:e,minutes:a}=l(t);(e>17||17===e&&a>=15)&&r.push("A hora da tarefa \xe9 ap\xf3s 17:15.")}else{const{hours:e,minutes:o}=l(t),{hours:n,minutes:s}=l(a);(e>17||17===e&&o>=15)&&r.push("A hora de in\xedcio \xe9 ap\xf3s 17:15."),(n>17||17===n&&s>=15)&&r.push("A hora de fim \xe9 ap\xf3s 17:15.")}const n=e.getDay();return 0!==n&&6!==n||r.push("A data selecionada \xe9 no fim de semana."),r})(V,H,M,P);if(t.length>0){const e=t.join("\n")+"\nTem certeza que deseja continuar?";window.confirm(`${e}\n\nTem certeza que deseja continuar?`)&&ge(!0)}else ge(!0)},style:[Oa.button,{backgroundColor:"#47AD4D"}],children:"Visualizar Preview"})]})]})}),(0,I.jsx)(D.default,{visible:se,onRequestClose:()=>ie(!1),animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Oa.modalOverlay,children:(0,I.jsxs)(n.default,{style:Oa.modalContainer,children:[(0,I.jsx)(W.default,{style:Oa.modalTitle,children:"Selecione uma Turma"}),0===oe.length?(0,I.jsx)(W.default,{style:Oa.infoText,children:"N\xe3o h\xe1 turmas dispon\xedveis para este professor."}):(0,I.jsx)(f.default,{children:oe.map(((e,t)=>(0,I.jsx)(b.default,{style:Oa.turmaRow,onPress:()=>{Be(e),ie(!1)},children:(0,I.jsxs)(W.default,{children:[e.ano," - ",e.turma]})},t)))}),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>ie(!1),style:Oa.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:E,animationType:"slide",transparent:!0,children:(0,I.jsx)(n.default,{style:Oa.colorModalOverlay,children:(0,I.jsxs)(n.default,{style:Oa.colorModalContainer,children:[(0,I.jsx)(W.default,{style:[Oa.modalTitle,{color:"#000"}],children:"Selecionar Cor"}),za.map((e=>(0,I.jsxs)(b.default,{style:Oa.colorOptionRow,onPress:()=>{R(e.value),O(!1)},children:[(0,I.jsx)(n.default,{style:[Oa.colorCircle,{backgroundColor:e.value}]}),(0,I.jsx)(W.default,{style:[Oa.colorName,{color:"#000"}],children:e.name})]},e.value))),(0,I.jsx)(T.default,{mode:"contained",onPress:()=>O(!1),style:Oa.modalCloseButton,children:"Fechar"})]})})}),(0,I.jsx)(D.default,{visible:Te,animationType:"fade",transparent:!0,children:(0,I.jsx)(n.default,{style:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center"},children:(0,I.jsxs)(n.default,{style:{width:"80%",backgroundColor:"dark"===Ce?"#333":"#fff",padding:20,borderRadius:8,alignItems:"center"},children:[(0,I.jsx)(l.default,{size:"large",color:"#47AD4D",style:{marginBottom:16}}),(0,I.jsx)(W.default,{style:{fontSize:16,textAlign:"center",marginBottom:24,color:Re},children:"N\xe3o \xe9 poss\xedvel criar nenhum evento porque n\xe3o foram encontradas turmas."}),(0,I.jsxs)(n.default,{style:{flexDirection:"row",justifyContent:"space-between",width:"100%"},children:[(0,I.jsx)(b.default,{onPress:()=>ie(!1),style:{flex:1,backgroundColor:"#47AD4D",paddingVertical:10,borderRadius:6,alignItems:"center",marginRight:8},children:(0,I.jsx)(W.default,{style:{color:"#fff",fontWeight:"bold"},children:"Tentar novamente"})}),(0,I.jsx)(b.default,{onPress:()=>t.goBack(),style:{padding:10,justifyContent:"center",alignItems:"center"},children:(0,I.jsx)(g.default,{source:a(7588),style:{width:24,height:24,tintColor:"#47AD4D"}})})]})]})})}),(0,I.jsx)(A,{visible:we,dynamicHeaderBackground:"white",dynamicTextColor:"black",onClose:()=>Se(!1),navigation:t,email:i})]})};d.setNotificationHandler({handleNotification:async()=>({shouldShowAlert:!0,shouldPlaySound:!1,shouldSetBadge:!1,shouldShowBanner:!0,shouldShowList:!0})});const _a=(0,i.createStackNavigator)();const Wa=function(){const[e,t]=(0,r.useState)(!0),[a,o]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[u,f]=(0,r.useState)(null),[m,g]=(0,r.useState)({theme:"light",background_url:""}),h=`${c.baseUrl}/backgroundFiles/getThemeAndBackground.php`;(0,r.useEffect)((()=>{(async()=>{try{let e,t,a;e=localStorage.getItem("userToken"),t=localStorage.getItem("userRole"),a=localStorage.getItem("email"),o(e),d(t),f(a),a?await(async e=>{try{const t=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}),a=await t.json();a.success?(g({theme:a.tema_user,background_url:a.background_user}),console.log("Tema e background obtidos com sucesso:",a)):console.error("Erro ao buscar tema/background:",a.message)}catch(t){console.error("Erro na requisi\xe7\xe3o:",t)}})(a):console.warn("Nenhum email encontrado. N\xe3o foi poss\xedvel buscar tema e background.")}catch(e){console.error("Erro ao recuperar dados do utilizador:",e)}finally{t(!1)}})()}),[]);const p=a?"aluno"===i?"Aluno":"professor"===i?"Professor":"admin"===i?"Administrador":"auxiliar"===i?"auxiliarScreen":"Login":"Login";return e?(0,I.jsx)(n.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,I.jsx)(l.default,{size:"large"})}):(0,I.jsx)(s.NavigationContainer,{children:(0,I.jsxs)(_a.Navigator,{initialRouteName:p,id:void 0,screenOptions:{headerShown:!1},children:[(0,I.jsx)(_a.Screen,{name:"Login",component:de}),(0,I.jsx)(_a.Screen,{name:"Aluno",component:ee,initialParams:{email:u,theme:m.theme,backgroundUrl:m.background_url}}),(0,I.jsx)(_a.Screen,{name:"Professor",component:le,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"Administrador",component:E,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"SignIn",component:me}),(0,I.jsx)(_a.Screen,{name:"VerifyCode",component:he}),(0,I.jsx)(_a.Screen,{name:"PutPassword",component:ue}),(0,I.jsx)(_a.Screen,{name:"TemaScreen",component:Se}),(0,I.jsx)(_a.Screen,{name:"suggestionsScreen",component:L}),(0,I.jsx)(_a.Screen,{name:"PersonalDataScreen",component:Be}),(0,I.jsx)(_a.Screen,{name:"sugestAnythingScreen",component:ze}),(0,I.jsx)(_a.Screen,{name:"PasswordSecurityScreen",component:_e}),(0,I.jsx)(_a.Screen,{name:"NotasScreen",component:Je}),(0,I.jsx)(_a.Screen,{name:"AlmocosScreen",component:Xe}),(0,I.jsx)(_a.Screen,{name:"HorariosScreen",component:at}),(0,I.jsx)(_a.Screen,{name:"entradasEsaidas",component:ht}),(0,I.jsx)(_a.Screen,{name:"addEventListener",component:jt}),(0,I.jsx)(_a.Screen,{name:"AddEventsScreenWeb",component:Va}),(0,I.jsx)(_a.Screen,{name:"AdicionarNotas",component:Dt}),(0,I.jsx)(_a.Screen,{name:"PersonalizarTarefa",component:Pt}),(0,I.jsx)(_a.Screen,{name:"QRCodeScannerScreen",component:Et}),(0,I.jsx)(_a.Screen,{name:"PersonalizarTarefaProf",component:Vt}),(0,I.jsx)(_a.Screen,{name:"InsertPasswordScreen",component:Wt}),(0,I.jsx)(_a.Screen,{name:"VerificationScreen",component:$t}),(0,I.jsx)(_a.Screen,{name:"PutNewPassForgetPassword",component:Nt}),(0,I.jsx)(_a.Screen,{name:"VerifyCodeForgetPassword",component:Ut}),(0,I.jsx)(_a.Screen,{name:"ForgetPasswordScreen",component:Gt}),(0,I.jsx)(_a.Screen,{name:"GenerateQRCodeScreen",component:Zt}),(0,I.jsx)(_a.Screen,{name:"PutCalendar",component:ea}),(0,I.jsx)(_a.Screen,{name:"auxiliarScreen",component:la,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"alunosDoProfScreen",component:ma,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"almocoProfScreen",component:ya,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"disciplinasAluno",component:va,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"NotasDisciplina",component:Sa,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"auxiliarEstatisticas",component:ka,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"confirmacoesScreen",component:Ba,initialParams:{email:u}}),(0,I.jsx)(_a.Screen,{name:"SelectTurma",component:Aa,initialParams:{email:u}})]})})};(0,o.default)(Wa)},2026:(e,t,a)=>{e.exports=a.p+"static/media/plus.2583e35eea365262ca73.png"},2074:(e,t,a)=>{e.exports=a.p+"static/media/info.04b2e0742c0a90b7ad16.png"},2256:(e,t,a)=>{e.exports=a.p+"static/media/account-circle.d83802e0c43abe53e1e0.png"},2702:(e,t,a)=>{e.exports=a.p+"static/media/bg5.7da1e58294e6084bae8a.jpg"},3885:(e,t,a)=>{e.exports=a.p+"static/media/account.bfa683cadfa2a1714e02.png"},5132:(e,t,a)=>{e.exports=a.p+"static/media/cross.a7c42097bcd95c5909ec.png"},5673:(e,t,a)=>{e.exports=a.p+"static/media/list-check.7be725e2d2a88c56ebf3.png"},6181:(e,t,a)=>{e.exports=a.p+"static/media/menu-burger.8cde76808547be526fa1.png"},6751:(e,t,a)=>{e.exports=a.p+"static/media/eye-off.a633caf6d882ccd61cd8.png"},7051:(e,t,a)=>{e.exports=a.p+"static/media/eye.1073c8e465f168c13743.png"},7588:(e,t,a)=>{e.exports=a.p+"static/media/angle-left.ed1b02425409158e9dec.png"},8320:(e,t,a)=>{e.exports=a.p+"static/media/check.76bf1d58f3992106eb98.png"},8821:(e,t,a)=>{e.exports=a.p+"static/media/bg2.e79316574a136952eb91.jpg"},8922:(e,t,a)=>{e.exports=a.p+"static/media/bg1.e5e76bc30e90e25aa60c.jpg"},9119:(e,t,a)=>{e.exports=a.p+"static/media/user.bfa683cadfa2a1714e02.png"}},t={};function a(o){var r=t[o];if(void 0!==r)return r.exports;var l=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,(()=>{var e=[];a.O=(t,o,r,l)=>{if(!o){var n=1/0;for(c=0;c<e.length;c++){for(var[o,r,l]=e[c],s=!0,i=0;i<o.length;i++)(!1&l||n>=l)&&Object.keys(a.O).every((e=>a.O[e](o[i])))?o.splice(i--,1):(s=!1,l<n&&(n=l));if(s){e.splice(c--,1);var d=r();void 0!==d&&(t=d)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[o,r,l]}})(),a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="/",(()=>{var e={792:0};a.O.j=t=>0===e[t];var t=(t,o)=>{var r,l,[n,s,i]=o,d=0;if(n.some((t=>0!==e[t]))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(i)var c=i(a)}for(t&&t(o);d<n.length;d++)l=n[d],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=a.O(void 0,[829],(()=>a(1363)));o=a.O(o)})();
//# sourceMappingURL=main.988a004f.js.map